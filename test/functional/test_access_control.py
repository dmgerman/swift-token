begin_unit
comment|'#!/usr/bin/python'
nl|'\n'
comment|'# coding: UTF-8'
nl|'\n'
nl|'\n'
comment|'# Copyright (c) 2015 OpenStack Foundation'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Licensed under the Apache License, Version 2.0 (the "License");'
nl|'\n'
comment|'# you may not use this file except in compliance with the License.'
nl|'\n'
comment|'# You may obtain a copy of the License at'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    http://www.apache.org/licenses/LICENSE-2.0'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Unless required by applicable law or agreed to in writing, software'
nl|'\n'
comment|'# distributed under the License is distributed on an "AS IS" BASIS,'
nl|'\n'
comment|'# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or'
nl|'\n'
comment|'# implied.'
nl|'\n'
comment|'# See the License for the specific language governing permissions and'
nl|'\n'
comment|'# limitations under the License.'
nl|'\n'
nl|'\n'
name|'import'
name|'unittest'
newline|'\n'
name|'import'
name|'uuid'
newline|'\n'
name|'from'
name|'random'
name|'import'
name|'shuffle'
newline|'\n'
nl|'\n'
name|'from'
name|'nose'
name|'import'
name|'SkipTest'
newline|'\n'
name|'from'
name|'swiftclient'
name|'import'
name|'get_auth'
op|','
name|'http_connection'
newline|'\n'
nl|'\n'
name|'import'
name|'test'
op|'.'
name|'functional'
name|'as'
name|'tf'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|setUpModule
name|'def'
name|'setUpModule'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'tf'
op|'.'
name|'setup_package'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|tearDownModule
dedent|''
name|'def'
name|'tearDownModule'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'tf'
op|'.'
name|'teardown_package'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|TEST_CASE_FORMAT
dedent|''
name|'TEST_CASE_FORMAT'
op|'='
op|'('
nl|'\n'
string|"'http_method'"
op|','
string|"'header'"
op|','
string|"'account_name'"
op|','
string|"'container_name'"
op|','
string|"'object_name'"
op|','
nl|'\n'
string|"'prep_container_header'"
op|','
string|"'reseller_prefix'"
op|','
string|"'target_user_name'"
op|','
nl|'\n'
string|"'auth_user_name'"
op|','
string|"'service_user_name'"
op|','
string|"'expected'"
op|')'
newline|'\n'
comment|'# http_method           : HTTP methods such as PUT, GET, POST, HEAD and so on'
nl|'\n'
comment|'# header                : headers for a request'
nl|'\n'
comment|'# account_name          : Account name. Usually the name will be automatically'
nl|'\n'
comment|'#                         created by keystone'
nl|'\n'
comment|"# container_name        : Container name. If 'UUID' is specified, a container"
nl|'\n'
comment|'#                         name will be created automatically'
nl|'\n'
comment|"# object_name           : Object name. If 'UUID' is specified, a container"
nl|'\n'
comment|'#                         name will be created automatically'
nl|'\n'
comment|'# prep_container_header : headers which will be set on the container'
nl|'\n'
comment|'# reseller_prefix       : Reseller prefix that will be used for request url.'
nl|'\n'
comment|'#                         Can be None or SERVICE to select the user account'
nl|'\n'
comment|'#                         prefix or the service prefix respectively'
nl|'\n'
comment|'# target_user_name      : a user name which is used for getting the project id'
nl|'\n'
comment|'#                         of the target'
nl|'\n'
comment|'# auth_user_name        : a user name which is used for getting a token for'
nl|'\n'
comment|'#                         X-Auth_Token'
nl|'\n'
comment|'# service_user_name     : a user name which is used for getting a token for'
nl|'\n'
comment|'#                         X-Service-Token'
nl|'\n'
comment|'# expected              : expected status code'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# a combination of account_name, container_name and object_name'
nl|'\n'
comment|'# represents a target.'
nl|'\n'
comment|'# +------------+--------------+-----------+---------+'
nl|'\n'
comment|'# |account_name|container_name|object_name| target  |'
nl|'\n'
comment|'# +------------+--------------+-----------+---------+'
nl|'\n'
comment|'# |    None    |     None     |   None    | account |'
nl|'\n'
comment|'# +------------+--------------+-----------+---------+'
nl|'\n'
comment|"# |    None    |    'UUID'    |   None    |container|"
nl|'\n'
comment|'# +------------+--------------+-----------+---------+'
nl|'\n'
comment|"# |    None    |    'UUID'    |  'UUID'   | object  |"
nl|'\n'
comment|'# +------------+--------------+-----------+---------+'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# The following users are required to run this functional test.'
nl|'\n'
comment|'# No.6, tester6, is added for this test.'
nl|'\n'
comment|'# +----+-----------+-------+---------+-------------+'
nl|'\n'
comment|'# |No. |  Domain   |Project|User name|    Role     |'
nl|'\n'
comment|'# +----+-----------+-------+---------+-------------+'
nl|'\n'
comment|'# | 1  |  default  | test  | tester  |    admin    |'
nl|'\n'
comment|'# +----+-----------+-------+---------+-------------+'
nl|'\n'
comment|'# | 2  |  default  | test2 | tester2 |    admin    |'
nl|'\n'
comment|'# +----+-----------+-------+---------+-------------+'
nl|'\n'
comment|'# | 3  |  default  | test  | tester3 |  _member_   |'
nl|'\n'
comment|'# +----+-----------+-------+---------+-------------+'
nl|'\n'
comment|'# | 4  |test-domain| test4 | tester4 |    admin    |'
nl|'\n'
comment|'# +----+-----------+-------+---------+-------------+'
nl|'\n'
comment|'# | 5  |  default  | test5 | tester5 |   service   |'
nl|'\n'
comment|'# +----+-----------+-------+---------+-------------+'
nl|'\n'
comment|'# | 6  |  default  | test  | tester6 |ResellerAdmin|'
nl|'\n'
comment|'# +----+-----------+-------+---------+-------------+'
nl|'\n'
nl|'\n'
comment|'# A scenario of put for account, container and object with'
nl|'\n'
comment|'# several roles.'
nl|'\n'
DECL|variable|RBAC_PUT
name|'RBAC_PUT'
op|'='
op|'['
nl|'\n'
comment|'# PUT container in own account: ok'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'201'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'201'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# PUT container in other users account: not allowed for role admin'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# PUT container in other users account: not allowed for role _member_'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# PUT container in other users account: allowed for role ResellerAdmin'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'201'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'201'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'201'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# PUT object in own account: ok'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'201'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'201'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# PUT object in other users account: not allowed for role admin'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# PUT object in other users account: not allowed for role _member_'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# PUT object in other users account: allowed for role ResellerAdmin'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'201'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'201'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'201'
op|')'
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|RBAC_PUT_WITH_SERVICE_PREFIX
name|'RBAC_PUT_WITH_SERVICE_PREFIX'
op|'='
op|'['
nl|'\n'
comment|'# PUT container in own account: ok'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'201'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# PUT container in other users account: not allowed for role service'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# PUT object in own account: ok'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'201'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# PUT object in other users account: not allowed for role service'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# All following actions are using SERVICE prefix'
nl|'\n'
nl|'\n'
comment|'# PUT container in own account: ok'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'201'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# PUT container fails if wrong user, or only one token sent'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# PUT object in own account: ok'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'201'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# PUT object fails if wrong user, or only one token sent'
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
comment|'# A scenario of delete for account, container and object with'
nl|'\n'
comment|'# several roles.'
nl|'\n'
DECL|variable|RBAC_DELETE
name|'RBAC_DELETE'
op|'='
op|'['
nl|'\n'
comment|'# DELETE container in own account: ok'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# DELETE container in other users account: not allowed for role admin'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# DELETE container in other users account: not allowed for role _member_'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# DELETE container in other users account: allowed for role ResellerAdmin'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# DELETE object in own account: ok'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# DELETE object in other users account: not allowed for role admin'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# DELETE object in other users account: not allowed for role _member_'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# DELETE object in other users account: allowed for role ResellerAdmin'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|RBAC_DELETE_WITH_SERVICE_PREFIX
name|'RBAC_DELETE_WITH_SERVICE_PREFIX'
op|'='
op|'['
nl|'\n'
comment|'# DELETE container in own account: ok'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# DELETE container in other users account: not allowed for role service'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# DELETE object in own account: ok'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# DELETE object in other users account: not allowed for role service'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# All following actions are using SERVICE prefix'
nl|'\n'
nl|'\n'
comment|'# DELETE container in own account: ok'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# DELETE container fails if wrong user, or only one token sent'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# DELETE object in own account: ok'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# DELETE object fails if wrong user, or only one token sent'
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
comment|'# A scenario of get for account, container and object with'
nl|'\n'
comment|'# several roles.'
nl|'\n'
DECL|variable|RBAC_GET
name|'RBAC_GET'
op|'='
op|'['
nl|'\n'
comment|'# GET own account: ok'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET other users account: not allowed for role admin'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET other users account: not allowed for role _member_'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET other users account: allowed for role ResellerAdmin'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET container in own account: ok'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET container in other users account: not allowed for role admin'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET container in other users account: not allowed for role _member_'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET container in other users account: allowed for role ResellerAdmin'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET object in own account: ok'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET object in other users account: not allowed for role admin'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET object in other users account: not allowed for role _member_'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET object in other users account: allowed for role ResellerAdmin'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|RBAC_GET_WITH_SERVICE_PREFIX
name|'RBAC_GET_WITH_SERVICE_PREFIX'
op|'='
op|'['
nl|'\n'
comment|'# GET own account: ok'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET other account: not allowed for role service'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET container in own account: ok'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET container in other users account: not allowed for role service'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET object in own account: ok'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET object fails if wrong user, or only one token sent'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# All following actions are using SERVICE prefix'
nl|'\n'
nl|'\n'
comment|'# GET own account: ok'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET other account: not allowed for role service'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET container in own account: ok'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET container fails if wrong user, or only one token sent'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET object in own account: ok'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# GET object fails if wrong user, or only one token sent'
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
comment|'# A scenario of head for account, container and object with'
nl|'\n'
comment|'# several roles.'
nl|'\n'
DECL|variable|RBAC_HEAD
name|'RBAC_HEAD'
op|'='
op|'['
nl|'\n'
comment|'# HEAD own account: ok'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD other users account: not allowed for role admin'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD other users account: not allowed for role _member_'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD other users account: allowed for role ResellerAdmin'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD container in own account: ok'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD container in other users account: not allowed for role admin'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD container in other users account: not allowed for role _member_'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD container in other users account: allowed for role ResellerAdmin'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
nl|'\n'
comment|'# HEAD object in own account: ok'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD object in other users account: not allowed for role admin'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD object in other users account: not allowed for role _member_'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD object in other users account: allowed for role ResellerAdmin'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|RBAC_HEAD_WITH_SERVICE_PREFIX
name|'RBAC_HEAD_WITH_SERVICE_PREFIX'
op|'='
op|'['
nl|'\n'
comment|'# HEAD own account: ok'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD other account: not allowed for role service'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD container in own account: ok'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD container in other users account: not allowed for role service'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD object in own account: ok'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD object fails if wrong user, or only one token sent'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# All following actions are using SERVICE prefix'
nl|'\n'
nl|'\n'
comment|'# HEAD own account: ok'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD other account: not allowed for role service'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD container in own account: ok'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD container in other users account: not allowed for role service'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD object in own account: ok'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# HEAD object fails if wrong user, or only one token sent'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
comment|'# A scenario of post for account, container and object with'
nl|'\n'
comment|'# several roles.'
nl|'\n'
DECL|variable|RBAC_POST
name|'RBAC_POST'
op|'='
op|'['
nl|'\n'
comment|'# POST own account: ok'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST other users account: not allowed for role admin'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST other users account: not allowed for role _member_'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST other users account: allowed for role ResellerAdmin'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST container in own account: ok'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST container in other users account: not allowed for role admin'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST container in other users account: not allowed for role _member_'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST container in other users account: allowed for role ResellerAdmin'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST object in own account: ok'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'202'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'202'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST object in other users account: not allowed for role admin'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST object in other users account: not allowed for role _member_'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST object in other users account: allowed for role ResellerAdmin'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'202'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'202'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'202'
op|')'
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|RBAC_POST_WITH_SERVICE_PREFIX
name|'RBAC_POST_WITH_SERVICE_PREFIX'
op|'='
op|'['
nl|'\n'
comment|'# POST own account: ok'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST own account: ok'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST container in own account: ok'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST container in other users account: not allowed for role service'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST object in own account: ok'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'202'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST object fails if wrong user, or only one token sent'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# All following actions are using SERVICE prefix'
nl|'\n'
nl|'\n'
comment|'# POST own account: ok'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST other account: not allowed for role service'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST container in own account: ok'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'204'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST container in other users account: not allowed for role service'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST object in own account: ok'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'202'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# POST object fails if wrong user, or only one token sent'
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'403'
op|')'
op|','
nl|'\n'
op|'('
string|"'POST'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'401'
op|')'
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
comment|'# A scenario of options for account, container and object with'
nl|'\n'
comment|'# several roles.'
nl|'\n'
DECL|variable|RBAC_OPTIONS
name|'RBAC_OPTIONS'
op|'='
op|'['
nl|'\n'
comment|'# OPTIONS request is always ok'
nl|'\n'
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester3'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester3'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester6'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester6'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
op|'{'
string|'"X-Container-Meta-Access-Control-Allow-Origin"'
op|':'
string|'"*"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
op|'{'
string|'"X-Container-Meta-Access-Control-Allow-Origin"'
op|':'
string|'"http://invalid.com"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
op|'{'
string|'"X-Container-Meta-Access-Control-Allow-Origin"'
op|':'
string|'"*"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
op|'{'
string|'"X-Container-Meta-Access-Control-Allow-Origin"'
op|':'
string|'"http://invalid.com"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
nl|'\n'
op|'{'
string|'"X-Container-Meta-Access-Control-Allow-Origin"'
op|':'
string|'"*"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
nl|'\n'
op|'{'
string|'"X-Container-Meta-Access-Control-Allow-Origin"'
op|':'
string|'"http://invalid.com"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
nl|'\n'
op|'{'
string|'"Origin"'
op|':'
string|'"http://localhost"'
op|','
string|'"Access-Control-Request-Method"'
op|':'
string|'"GET"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
nl|'\n'
op|'{'
string|'"Origin"'
op|':'
string|'"http://localhost"'
op|','
string|'"Access-Control-Request-Method"'
op|':'
string|'"GET"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
op|'{'
string|'"X-Container-Meta-Access-Control-Allow-Origin"'
op|':'
string|'"*"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
nl|'\n'
op|'{'
string|'"Origin"'
op|':'
string|'"http://localhost"'
op|','
string|'"Access-Control-Request-Method"'
op|':'
string|'"GET"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
op|'{'
string|'"X-Container-Meta-Access-Control-Allow-Origin"'
op|':'
string|'"http://invalid.com"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
nl|'\n'
op|'{'
string|'"Origin"'
op|':'
string|'"http://localhost"'
op|','
string|'"Access-Control-Request-Method"'
op|':'
string|'"GET"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
nl|'\n'
op|'{'
string|'"Origin"'
op|':'
string|'"http://localhost"'
op|','
string|'"Access-Control-Request-Method"'
op|':'
string|'"GET"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
op|'{'
string|'"X-Container-Meta-Access-Control-Allow-Origin"'
op|':'
string|'"*"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# Not OK for container: wrong origin'
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
nl|'\n'
op|'{'
string|'"Origin"'
op|':'
string|'"http://localhost"'
op|','
string|'"Access-Control-Request-Method"'
op|':'
string|'"GET"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
op|'{'
string|'"X-Container-Meta-Access-Control-Allow-Origin"'
op|':'
string|'"http://invalid.com"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'401'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# Not OK for object: missing X-Container-Meta-Access-Control-Allow-Origin'
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
nl|'\n'
op|'{'
string|'"Origin"'
op|':'
string|'"http://localhost"'
op|','
string|'"Access-Control-Request-Method"'
op|':'
string|'"GET"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'401'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
nl|'\n'
op|'{'
string|'"Origin"'
op|':'
string|'"http://localhost"'
op|','
string|'"Access-Control-Request-Method"'
op|':'
string|'"GET"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
nl|'\n'
op|'{'
string|'"X-Container-Meta-Access-Control-Allow-Origin"'
op|':'
string|'"*"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'# Not OK for object: wrong origin'
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
nl|'\n'
op|'{'
string|'"Origin"'
op|':'
string|'"http://localhost"'
op|','
string|'"Access-Control-Request-Method"'
op|':'
string|'"GET"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
nl|'\n'
op|'{'
string|'"X-Container-Meta-Access-Control-Allow-Origin"'
op|':'
string|'"http://invalid.com"'
op|'}'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'401'
op|')'
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|RBAC_OPTIONS_WITH_SERVICE_PREFIX
name|'RBAC_OPTIONS_WITH_SERVICE_PREFIX'
op|'='
op|'['
nl|'\n'
comment|'# OPTIONS request is always ok'
nl|'\n'
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester5'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester2'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|','
string|"'tester4'"
op|','
string|"'tester5'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
name|'None'
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester3'"
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
string|"'tester'"
op|','
number|'200'
op|')'
op|','
nl|'\n'
op|'('
string|"'OPTIONS'"
op|','
name|'None'
op|','
name|'None'
op|','
string|"'UUID'"
op|','
string|"'UUID'"
op|','
name|'None'
op|','
nl|'\n'
string|"'SERVICE'"
op|','
string|"'tester'"
op|','
name|'None'
op|','
string|"'tester5'"
op|','
number|'200'
op|')'
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|SwiftClient
name|'class'
name|'SwiftClient'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|variable|_tokens
indent|'    '
name|'_tokens'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_set_users'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'auth_url'
op|'='
name|'tf'
op|'.'
name|'swift_test_auth'
newline|'\n'
name|'self'
op|'.'
name|'insecure'
op|'='
name|'tf'
op|'.'
name|'insecure'
newline|'\n'
name|'self'
op|'.'
name|'auth_version'
op|'='
name|'tf'
op|'.'
name|'swift_test_auth_version'
newline|'\n'
nl|'\n'
DECL|member|_set_users
dedent|''
name|'def'
name|'_set_users'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'users'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'for'
name|'index'
name|'in'
name|'range'
op|'('
number|'6'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'users'
op|'['
name|'tf'
op|'.'
name|'swift_test_user'
op|'['
name|'index'
op|']'
op|']'
op|'='
op|'{'
nl|'\n'
string|"'account'"
op|':'
name|'tf'
op|'.'
name|'swift_test_tenant'
op|'['
name|'index'
op|']'
op|','
nl|'\n'
string|"'password'"
op|':'
name|'tf'
op|'.'
name|'swift_test_key'
op|'['
name|'index'
op|']'
op|','
nl|'\n'
string|"'domain'"
op|':'
name|'tf'
op|'.'
name|'swift_test_domain'
op|'['
name|'index'
op|']'
op|'}'
newline|'\n'
nl|'\n'
DECL|member|_get_auth
dedent|''
dedent|''
name|'def'
name|'_get_auth'
op|'('
name|'self'
op|','
name|'user_name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'info'
op|'='
name|'self'
op|'.'
name|'users'
op|'.'
name|'get'
op|'('
name|'user_name'
op|')'
newline|'\n'
name|'if'
name|'info'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'None'
op|','
name|'None'
newline|'\n'
nl|'\n'
dedent|''
name|'os_options'
op|'='
op|'{'
string|"'user_domain_name'"
op|':'
name|'info'
op|'['
string|"'domain'"
op|']'
op|','
nl|'\n'
string|"'project_domain_name'"
op|':'
name|'info'
op|'['
string|"'domain'"
op|']'
op|'}'
newline|'\n'
name|'authargs'
op|'='
name|'dict'
op|'('
name|'snet'
op|'='
name|'False'
op|','
name|'tenant_name'
op|'='
name|'info'
op|'['
string|"'account'"
op|']'
op|','
nl|'\n'
name|'auth_version'
op|'='
name|'self'
op|'.'
name|'auth_version'
op|','
name|'os_options'
op|'='
name|'os_options'
op|','
nl|'\n'
name|'insecure'
op|'='
name|'self'
op|'.'
name|'insecure'
op|')'
newline|'\n'
name|'storage_url'
op|','
name|'token'
op|'='
name|'get_auth'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'auth_url'
op|','
name|'user_name'
op|','
name|'info'
op|'['
string|"'password'"
op|']'
op|','
op|'**'
name|'authargs'
op|')'
newline|'\n'
nl|'\n'
name|'return'
name|'storage_url'
op|','
name|'token'
newline|'\n'
nl|'\n'
DECL|member|auth
dedent|''
name|'def'
name|'auth'
op|'('
name|'self'
op|','
name|'user_name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'storage_url'
op|','
name|'token'
op|'='
name|'SwiftClient'
op|'.'
name|'_tokens'
op|'.'
name|'get'
op|'('
name|'user_name'
op|','
op|'('
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'if'
name|'not'
name|'token'
op|':'
newline|'\n'
indent|'            '
name|'SwiftClient'
op|'.'
name|'_tokens'
op|'['
name|'user_name'
op|']'
op|'='
name|'self'
op|'.'
name|'_get_auth'
op|'('
name|'user_name'
op|')'
newline|'\n'
name|'storage_url'
op|','
name|'token'
op|'='
name|'SwiftClient'
op|'.'
name|'_tokens'
op|'.'
name|'get'
op|'('
name|'user_name'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'storage_url'
op|','
name|'token'
newline|'\n'
nl|'\n'
DECL|member|send_request
dedent|''
name|'def'
name|'send_request'
op|'('
name|'self'
op|','
name|'method'
op|','
name|'url'
op|','
name|'token'
op|'='
name|'None'
op|','
name|'headers'
op|'='
name|'None'
op|','
nl|'\n'
name|'service_token'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'headers'
op|'='
op|'{'
op|'}'
name|'if'
name|'headers'
name|'is'
name|'None'
name|'else'
name|'headers'
op|'.'
name|'copy'
op|'('
op|')'
newline|'\n'
name|'headers'
op|'.'
name|'update'
op|'('
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'Accept'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'if'
name|'token'
op|':'
newline|'\n'
indent|'            '
name|'headers'
op|'['
string|"'X-Auth-Token'"
op|']'
op|'='
name|'token'
newline|'\n'
dedent|''
name|'if'
name|'service_token'
op|':'
newline|'\n'
indent|'            '
name|'headers'
op|'['
string|"'X-Service-Token'"
op|']'
op|'='
name|'service_token'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'insecure'
op|':'
newline|'\n'
indent|'            '
name|'parsed'
op|','
name|'conn'
op|'='
name|'http_connection'
op|'('
name|'url'
op|','
name|'insecure'
op|'='
name|'self'
op|'.'
name|'insecure'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'parsed'
op|','
name|'conn'
op|'='
name|'http_connection'
op|'('
name|'url'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'conn'
op|'.'
name|'request'
op|'('
name|'method'
op|','
name|'parsed'
op|'.'
name|'path'
op|','
name|'headers'
op|'='
name|'headers'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'conn'
op|'.'
name|'getresponse'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'return'
name|'resp'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|BaseTestAC
dedent|''
dedent|''
name|'class'
name|'BaseTestAC'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'reseller_admin'
op|'='
name|'tf'
op|'.'
name|'swift_test_user'
op|'['
number|'5'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'client'
op|'='
name|'SwiftClient'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|_create_resource_url
dedent|''
name|'def'
name|'_create_resource_url'
op|'('
name|'self'
op|','
name|'storage_url'
op|','
name|'account'
op|'='
name|'None'
op|','
nl|'\n'
name|'container'
op|'='
name|'None'
op|','
name|'obj'
op|'='
name|'None'
op|','
name|'reseller_prefix'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
comment|'# e.g.'
nl|'\n'
comment|"#   storage_url = 'http://localhost/v1/AUTH_xxx'"
nl|'\n'
comment|"#   storage_url_list[:-1] is ['http:', '', 'localhost', 'v1']"
nl|'\n'
comment|"#   storage_url_list[-1] is 'AUTH_xxx'"
nl|'\n'
indent|'        '
name|'storage_url_list'
op|'='
name|'storage_url'
op|'.'
name|'rstrip'
op|'('
string|"'/'"
op|')'
op|'.'
name|'split'
op|'('
string|"'/'"
op|')'
newline|'\n'
name|'base_url'
op|'='
string|"'/'"
op|'.'
name|'join'
op|'('
name|'storage_url_list'
op|'['
op|':'
op|'-'
number|'1'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'account'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'account'
op|'='
name|'storage_url_list'
op|'['
op|'-'
number|'1'
op|']'
newline|'\n'
name|'if'
name|'reseller_prefix'
op|'=='
string|"'SERVICE'"
op|':'
newline|'\n'
comment|'# replace endpoint reseller prefix with service reseller prefix'
nl|'\n'
indent|'                '
name|'i'
op|'='
op|'('
name|'account'
op|'.'
name|'index'
op|'('
string|"'_'"
op|')'
op|'+'
number|'1'
op|')'
name|'if'
string|"'_'"
name|'in'
name|'account'
name|'else'
number|'0'
newline|'\n'
name|'account'
op|'='
name|'tf'
op|'.'
name|'swift_test_service_prefix'
op|'+'
name|'account'
op|'['
name|'i'
op|':'
op|']'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'return'
string|"'/'"
op|'.'
name|'join'
op|'('
op|'['
name|'part'
name|'for'
name|'part'
name|'in'
op|'('
name|'base_url'
op|','
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|')'
nl|'\n'
name|'if'
name|'part'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_put_container
dedent|''
name|'def'
name|'_put_container'
op|'('
name|'self'
op|','
name|'storage_url'
op|','
name|'token'
op|','
name|'test_case'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'resource_url'
op|'='
name|'self'
op|'.'
name|'_create_resource_url'
op|'('
nl|'\n'
name|'storage_url'
op|','
nl|'\n'
name|'test_case'
op|'['
string|"'account_name'"
op|']'
op|','
nl|'\n'
name|'test_case'
op|'['
string|"'container_name'"
op|']'
op|','
nl|'\n'
name|'reseller_prefix'
op|'='
name|'test_case'
op|'['
string|"'reseller_prefix'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'created_resources'
op|'.'
name|'append'
op|'('
name|'resource_url'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'client'
op|'.'
name|'send_request'
op|'('
string|"'PUT'"
op|','
name|'resource_url'
op|','
name|'token'
op|','
nl|'\n'
name|'headers'
op|'='
name|'test_case'
op|'['
string|"'prep_container_header'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_put_object
dedent|''
name|'def'
name|'_put_object'
op|'('
name|'self'
op|','
name|'storage_url'
op|','
name|'token'
op|','
name|'test_case'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'resource_url'
op|'='
name|'self'
op|'.'
name|'_create_resource_url'
op|'('
nl|'\n'
name|'storage_url'
op|','
nl|'\n'
name|'test_case'
op|'['
string|"'account_name'"
op|']'
op|','
nl|'\n'
name|'test_case'
op|'['
string|"'container_name'"
op|']'
op|','
nl|'\n'
name|'test_case'
op|'['
string|"'object_name'"
op|']'
op|','
nl|'\n'
name|'reseller_prefix'
op|'='
name|'test_case'
op|'['
string|"'reseller_prefix'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'created_resources'
op|'.'
name|'append'
op|'('
name|'resource_url'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'client'
op|'.'
name|'send_request'
op|'('
string|"'PUT'"
op|','
name|'resource_url'
op|','
name|'token'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_get_storage_url_and_token
dedent|''
name|'def'
name|'_get_storage_url_and_token'
op|'('
name|'self'
op|','
name|'storage_url_user'
op|','
name|'token_user'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'storage_url'
op|','
name|'_junk'
op|'='
name|'self'
op|'.'
name|'client'
op|'.'
name|'auth'
op|'('
name|'storage_url_user'
op|')'
newline|'\n'
name|'_junk'
op|','
name|'token'
op|'='
name|'self'
op|'.'
name|'client'
op|'.'
name|'auth'
op|'('
name|'token_user'
op|')'
newline|'\n'
nl|'\n'
name|'return'
name|'storage_url'
op|','
name|'token'
newline|'\n'
nl|'\n'
DECL|member|_prepare
dedent|''
name|'def'
name|'_prepare'
op|'('
name|'self'
op|','
name|'test_case'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'storage_url'
op|','
name|'reseller_token'
op|'='
name|'self'
op|'.'
name|'_get_storage_url_and_token'
op|'('
nl|'\n'
name|'test_case'
op|'['
string|"'target_user_name'"
op|']'
op|','
name|'self'
op|'.'
name|'reseller_admin'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'test_case'
op|'['
string|"'http_method'"
op|']'
name|'in'
op|'('
string|"'GET'"
op|','
string|"'POST'"
op|','
string|"'DELETE'"
op|','
string|"'HEAD'"
op|','
nl|'\n'
string|"'OPTIONS'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'temp_test_case'
op|'='
name|'test_case'
op|'.'
name|'copy'
op|'('
op|')'
newline|'\n'
name|'if'
name|'test_case'
op|'['
string|"'container_name'"
op|']'
name|'is'
name|'None'
op|':'
newline|'\n'
comment|'# When the target is for account, dummy container will be'
nl|'\n'
comment|'# created to create an account. This account is created by'
nl|'\n'
comment|'# account_autocreate.'
nl|'\n'
indent|'                '
name|'temp_test_case'
op|'['
string|"'container_name'"
op|']'
op|'='
name|'uuid'
op|'.'
name|'uuid4'
op|'('
op|')'
op|'.'
name|'hex'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'_put_container'
op|'('
name|'storage_url'
op|','
name|'reseller_token'
op|','
name|'temp_test_case'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'test_case'
op|'['
string|"'object_name'"
op|']'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'_put_object'
op|'('
name|'storage_url'
op|','
name|'reseller_token'
op|','
name|'test_case'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'elif'
name|'test_case'
op|'['
string|"'http_method'"
op|']'
name|'in'
op|'('
string|"'PUT'"
op|','
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'test_case'
op|'['
string|"'object_name'"
op|']'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'_put_container'
op|'('
name|'storage_url'
op|','
name|'reseller_token'
op|','
name|'test_case'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_execute
dedent|''
dedent|''
dedent|''
name|'def'
name|'_execute'
op|'('
name|'self'
op|','
name|'test_case'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'storage_url'
op|','
name|'token'
op|'='
name|'self'
op|'.'
name|'_get_storage_url_and_token'
op|'('
nl|'\n'
name|'test_case'
op|'['
string|"'target_user_name'"
op|']'
op|','
name|'test_case'
op|'['
string|"'auth_user_name'"
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'service_user'
op|'='
name|'test_case'
op|'['
string|"'service_user_name'"
op|']'
newline|'\n'
name|'service_token'
op|'='
op|'('
name|'None'
name|'if'
name|'service_user'
name|'is'
name|'None'
nl|'\n'
name|'else'
name|'self'
op|'.'
name|'client'
op|'.'
name|'auth'
op|'('
name|'service_user'
op|')'
op|'['
number|'1'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'resource_url'
op|'='
name|'self'
op|'.'
name|'_create_resource_url'
op|'('
nl|'\n'
name|'storage_url'
op|','
nl|'\n'
name|'test_case'
op|'['
string|"'account_name'"
op|']'
op|','
nl|'\n'
name|'test_case'
op|'['
string|"'container_name'"
op|']'
op|','
nl|'\n'
name|'test_case'
op|'['
string|"'object_name'"
op|']'
op|','
nl|'\n'
name|'test_case'
op|'['
string|"'reseller_prefix'"
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'test_case'
op|'['
string|"'http_method'"
op|']'
name|'in'
op|'('
string|"'PUT'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'created_resources'
op|'.'
name|'append'
op|'('
name|'resource_url'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'resp'
op|'='
name|'self'
op|'.'
name|'client'
op|'.'
name|'send_request'
op|'('
name|'test_case'
op|'['
string|"'http_method'"
op|']'
op|','
nl|'\n'
name|'resource_url'
op|','
nl|'\n'
name|'token'
op|','
nl|'\n'
name|'headers'
op|'='
name|'test_case'
op|'['
string|"'header'"
op|']'
op|','
nl|'\n'
name|'service_token'
op|'='
name|'service_token'
op|')'
newline|'\n'
nl|'\n'
name|'return'
name|'resp'
op|'.'
name|'status'
newline|'\n'
nl|'\n'
DECL|member|_cleanup
dedent|''
name|'def'
name|'_cleanup'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'_junk'
op|','
name|'reseller_token'
op|'='
name|'self'
op|'.'
name|'client'
op|'.'
name|'auth'
op|'('
name|'self'
op|'.'
name|'reseller_admin'
op|')'
newline|'\n'
name|'for'
name|'resource_url'
name|'in'
name|'reversed'
op|'('
name|'self'
op|'.'
name|'created_resources'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'resp'
op|'='
name|'self'
op|'.'
name|'client'
op|'.'
name|'send_request'
op|'('
string|"'DELETE'"
op|','
name|'resource_url'
op|','
nl|'\n'
name|'reseller_token'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIn'
op|'('
name|'resp'
op|'.'
name|'status'
op|','
op|'('
number|'204'
op|','
number|'404'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_convert_data
dedent|''
dedent|''
name|'def'
name|'_convert_data'
op|'('
name|'self'
op|','
name|'data'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'test_case'
op|'='
name|'dict'
op|'('
name|'zip'
op|'('
name|'TEST_CASE_FORMAT'
op|','
name|'data'
op|')'
op|')'
newline|'\n'
name|'if'
name|'test_case'
op|'['
string|"'container_name'"
op|']'
op|'=='
string|"'UUID'"
op|':'
newline|'\n'
indent|'            '
name|'test_case'
op|'['
string|"'container_name'"
op|']'
op|'='
name|'uuid'
op|'.'
name|'uuid4'
op|'('
op|')'
op|'.'
name|'hex'
newline|'\n'
dedent|''
name|'if'
name|'test_case'
op|'['
string|"'object_name'"
op|']'
op|'=='
string|"'UUID'"
op|':'
newline|'\n'
indent|'            '
name|'test_case'
op|'['
string|"'object_name'"
op|']'
op|'='
name|'uuid'
op|'.'
name|'uuid4'
op|'('
op|')'
op|'.'
name|'hex'
newline|'\n'
dedent|''
name|'return'
name|'test_case'
newline|'\n'
nl|'\n'
DECL|member|_run_scenario
dedent|''
name|'def'
name|'_run_scenario'
op|'('
name|'self'
op|','
name|'scenario'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'data'
name|'in'
name|'scenario'
op|':'
newline|'\n'
indent|'            '
name|'test_case'
op|'='
name|'self'
op|'.'
name|'_convert_data'
op|'('
name|'data'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'created_resources'
op|'='
op|'['
op|']'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'_prepare'
op|'('
name|'test_case'
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'_execute'
op|'('
name|'test_case'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'test_case'
op|'['
string|"'expected'"
op|']'
op|','
nl|'\n'
name|'result'
op|','
nl|'\n'
string|"'Expected %s but got %s for test case %s'"
op|'%'
nl|'\n'
op|'('
name|'test_case'
op|'['
string|"'expected'"
op|']'
op|','
name|'result'
op|','
name|'test_case'
op|')'
op|')'
newline|'\n'
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'_cleanup'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestRBAC
dedent|''
dedent|''
dedent|''
dedent|''
name|'class'
name|'TestRBAC'
op|'('
name|'BaseTestAC'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|test_rbac
indent|'    '
name|'def'
name|'test_rbac'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'any'
op|'('
op|'('
name|'tf'
op|'.'
name|'skip'
op|','
name|'tf'
op|'.'
name|'skip2'
op|','
name|'tf'
op|'.'
name|'skip3'
op|','
name|'tf'
op|'.'
name|'skip_if_not_v3'
op|','
nl|'\n'
name|'tf'
op|'.'
name|'skip_if_no_reseller_admin'
op|')'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'SkipTest'
newline|'\n'
dedent|''
name|'scenario_rbac'
op|'='
name|'RBAC_PUT'
op|'+'
name|'RBAC_DELETE'
op|'+'
name|'RBAC_GET'
op|'+'
name|'RBAC_HEAD'
op|'+'
name|'RBAC_POST'
op|'+'
name|'RBAC_OPTIONS'
newline|'\n'
name|'shuffle'
op|'('
name|'scenario_rbac'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_run_scenario'
op|'('
name|'scenario_rbac'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_rbac_with_service_prefix
dedent|''
name|'def'
name|'test_rbac_with_service_prefix'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'any'
op|'('
op|'('
name|'tf'
op|'.'
name|'skip'
op|','
name|'tf'
op|'.'
name|'skip2'
op|','
name|'tf'
op|'.'
name|'skip3'
op|','
name|'tf'
op|'.'
name|'skip_if_not_v3'
op|','
nl|'\n'
name|'tf'
op|'.'
name|'skip_service_tokens'
op|','
name|'tf'
op|'.'
name|'skip_if_no_reseller_admin'
op|')'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'SkipTest'
newline|'\n'
dedent|''
name|'scenario_rbac'
op|'='
name|'RBAC_PUT_WITH_SERVICE_PREFIX'
op|'+'
name|'RBAC_DELETE_WITH_SERVICE_PREFIX'
op|'+'
name|'RBAC_GET_WITH_SERVICE_PREFIX'
op|'+'
name|'RBAC_HEAD_WITH_SERVICE_PREFIX'
op|'+'
name|'RBAC_POST_WITH_SERVICE_PREFIX'
op|'+'
name|'RBAC_OPTIONS_WITH_SERVICE_PREFIX'
newline|'\n'
name|'shuffle'
op|'('
name|'scenario_rbac'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_run_scenario'
op|'('
name|'scenario_rbac'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
name|'__name__'
op|'=='
string|"'__main__'"
op|':'
newline|'\n'
indent|'    '
name|'unittest'
op|'.'
name|'main'
op|'('
op|')'
newline|'\n'
dedent|''
endmarker|''
end_unit
