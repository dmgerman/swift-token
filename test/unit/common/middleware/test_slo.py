begin_unit
comment|'# -*- coding: utf-8 -*-'
nl|'\n'
comment|'# Copyright (c) 2013 OpenStack Foundation'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Licensed under the Apache License, Version 2.0 (the "License");'
nl|'\n'
comment|'# you may not use this file except in compliance with the License.'
nl|'\n'
comment|'# You may obtain a copy of the License at'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    http://www.apache.org/licenses/LICENSE-2.0'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Unless required by applicable law or agreed to in writing, software'
nl|'\n'
comment|'# distributed under the License is distributed on an "AS IS" BASIS,'
nl|'\n'
comment|'# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or'
nl|'\n'
comment|'# implied.'
nl|'\n'
comment|'# See the License for the specific language governing permissions and'
nl|'\n'
comment|'# limitations under the License.'
nl|'\n'
nl|'\n'
name|'from'
name|'six'
op|'.'
name|'moves'
name|'import'
name|'range'
newline|'\n'
nl|'\n'
name|'import'
name|'hashlib'
newline|'\n'
name|'import'
name|'json'
newline|'\n'
name|'import'
name|'time'
newline|'\n'
name|'import'
name|'unittest'
newline|'\n'
name|'from'
name|'mock'
name|'import'
name|'patch'
newline|'\n'
name|'from'
name|'hashlib'
name|'import'
name|'md5'
newline|'\n'
name|'from'
name|'swift'
op|'.'
name|'common'
name|'import'
name|'swob'
op|','
name|'utils'
newline|'\n'
name|'from'
name|'swift'
op|'.'
name|'common'
op|'.'
name|'exceptions'
name|'import'
name|'ListingIterError'
op|','
name|'SegmentError'
newline|'\n'
name|'from'
name|'swift'
op|'.'
name|'common'
op|'.'
name|'header_key_dict'
name|'import'
name|'HeaderKeyDict'
newline|'\n'
name|'from'
name|'swift'
op|'.'
name|'common'
op|'.'
name|'middleware'
name|'import'
name|'slo'
newline|'\n'
name|'from'
name|'swift'
op|'.'
name|'common'
op|'.'
name|'swob'
name|'import'
name|'Request'
op|','
name|'HTTPException'
newline|'\n'
name|'from'
name|'swift'
op|'.'
name|'common'
op|'.'
name|'utils'
name|'import'
name|'quote'
op|','
name|'closing_if_possible'
op|','
name|'close_if_possible'
newline|'\n'
name|'from'
name|'test'
op|'.'
name|'unit'
op|'.'
name|'common'
op|'.'
name|'middleware'
op|'.'
name|'helpers'
name|'import'
name|'FakeSwift'
newline|'\n'
nl|'\n'
nl|'\n'
name|'test_xml_data'
op|'='
string|'\'\'\'<?xml version="1.0" encoding="UTF-8"?>\n<static_large_object>\n  <object_segment>\n    <path>/cont/object</path>\n    <etag>etagoftheobjectsegment</etag>\n    <size_bytes>100</size_bytes>\n  </object_segment>\n</static_large_object>\n\'\'\''
newline|'\n'
DECL|variable|test_json_data
name|'test_json_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
nl|'\n'
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_start_response
name|'def'
name|'fake_start_response'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|md5hex
dedent|''
name|'def'
name|'md5hex'
op|'('
name|'s'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
name|'hashlib'
op|'.'
name|'md5'
op|'('
name|'s'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|SloTestCase
dedent|''
name|'class'
name|'SloTestCase'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'app'
op|'='
name|'FakeSwift'
op|'('
op|')'
newline|'\n'
name|'slo_conf'
op|'='
op|'{'
string|"'rate_limit_under_size'"
op|':'
string|"'0'"
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'slo'
op|'='
name|'slo'
op|'.'
name|'filter_factory'
op|'('
name|'slo_conf'
op|')'
op|'('
name|'self'
op|'.'
name|'app'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'slo'
op|'.'
name|'logger'
op|'='
name|'self'
op|'.'
name|'app'
op|'.'
name|'logger'
newline|'\n'
nl|'\n'
DECL|member|call_app
dedent|''
name|'def'
name|'call_app'
op|'('
name|'self'
op|','
name|'req'
op|','
name|'app'
op|'='
name|'None'
op|','
name|'expect_exception'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'app'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'app'
op|'='
name|'self'
op|'.'
name|'app'
newline|'\n'
nl|'\n'
dedent|''
name|'req'
op|'.'
name|'headers'
op|'.'
name|'setdefault'
op|'('
string|'"User-Agent"'
op|','
string|'"Mozzarella Foxfire"'
op|')'
newline|'\n'
nl|'\n'
name|'status'
op|'='
op|'['
name|'None'
op|']'
newline|'\n'
name|'headers'
op|'='
op|'['
name|'None'
op|']'
newline|'\n'
nl|'\n'
DECL|function|start_response
name|'def'
name|'start_response'
op|'('
name|'s'
op|','
name|'h'
op|','
name|'ei'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'status'
op|'['
number|'0'
op|']'
op|'='
name|'s'
newline|'\n'
name|'headers'
op|'['
number|'0'
op|']'
op|'='
name|'h'
newline|'\n'
nl|'\n'
dedent|''
name|'body_iter'
op|'='
name|'app'
op|'('
name|'req'
op|'.'
name|'environ'
op|','
name|'start_response'
op|')'
newline|'\n'
name|'body'
op|'='
string|"''"
newline|'\n'
name|'caught_exc'
op|'='
name|'None'
newline|'\n'
name|'try'
op|':'
newline|'\n'
comment|'# appease the close-checker'
nl|'\n'
indent|'            '
name|'with'
name|'closing_if_possible'
op|'('
name|'body_iter'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'chunk'
name|'in'
name|'body_iter'
op|':'
newline|'\n'
indent|'                    '
name|'body'
op|'+='
name|'chunk'
newline|'\n'
dedent|''
dedent|''
dedent|''
name|'except'
name|'Exception'
name|'as'
name|'exc'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'expect_exception'
op|':'
newline|'\n'
indent|'                '
name|'caught_exc'
op|'='
name|'exc'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'raise'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
name|'expect_exception'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'status'
op|'['
number|'0'
op|']'
op|','
name|'headers'
op|'['
number|'0'
op|']'
op|','
name|'body'
op|','
name|'caught_exc'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'status'
op|'['
number|'0'
op|']'
op|','
name|'headers'
op|'['
number|'0'
op|']'
op|','
name|'body'
newline|'\n'
nl|'\n'
DECL|member|call_slo
dedent|''
dedent|''
name|'def'
name|'call_slo'
op|'('
name|'self'
op|','
name|'req'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'call_app'
op|'('
name|'req'
op|','
name|'app'
op|'='
name|'self'
op|'.'
name|'slo'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestSloMiddleware
dedent|''
dedent|''
name|'class'
name|'TestSloMiddleware'
op|'('
name|'SloTestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'TestSloMiddleware'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/'"
op|','
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
op|'}'
op|','
string|"'passed'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'PUT'"
op|','
string|"'/'"
op|','
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
op|'}'
op|','
string|"'passed'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_no_obj
dedent|''
name|'def'
name|'test_handle_multipart_no_obj'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/'"
op|')'
newline|'\n'
name|'resp_iter'
op|'='
name|'self'
op|'.'
name|'slo'
op|'('
name|'req'
op|'.'
name|'environ'
op|','
name|'fake_start_response'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
op|'['
op|'('
string|"'GET'"
op|','
string|"'/'"
op|')'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"''"
op|'.'
name|'join'
op|'('
name|'resp_iter'
op|')'
op|','
string|"'passed'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_slo_header_assigned
dedent|''
name|'def'
name|'test_slo_header_assigned'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/a/c/o'"
op|','
name|'headers'
op|'='
op|'{'
string|"'x-static-large-object'"
op|':'
string|'"true"'
op|'}'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
string|"''"
op|'.'
name|'join'
op|'('
name|'self'
op|'.'
name|'slo'
op|'('
name|'req'
op|'.'
name|'environ'
op|','
name|'fake_start_response'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
nl|'\n'
name|'resp'
op|'.'
name|'startswith'
op|'('
string|"'X-Static-Large-Object is a reserved header'"
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_put_bogus_slo
dedent|''
name|'def'
name|'_put_bogus_slo'
op|'('
name|'self'
op|','
name|'manifest_text'
op|','
nl|'\n'
name|'manifest_path'
op|'='
string|"'/v1/a/c/the-manifest'"
op|')'
op|':'
newline|'\n'
indent|'        '
name|'with'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'HTTPException'
op|')'
name|'as'
name|'catcher'
op|':'
newline|'\n'
indent|'            '
name|'slo'
op|'.'
name|'parse_and_validate_input'
op|'('
name|'manifest_text'
op|','
name|'manifest_path'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'400'
op|','
name|'catcher'
op|'.'
name|'exception'
op|'.'
name|'status_int'
op|')'
newline|'\n'
name|'return'
name|'catcher'
op|'.'
name|'exception'
op|'.'
name|'body'
newline|'\n'
nl|'\n'
DECL|member|_put_slo
dedent|''
name|'def'
name|'_put_slo'
op|'('
name|'self'
op|','
name|'manifest_text'
op|','
name|'manifest_path'
op|'='
string|"'/v1/a/c/the-manifest'"
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'slo'
op|'.'
name|'parse_and_validate_input'
op|'('
name|'manifest_text'
op|','
name|'manifest_path'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_bogus_input
dedent|''
name|'def'
name|'test_bogus_input'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'Manifest must be valid JSON.\\n'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
string|"'some non json'"
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'Manifest must be a list.\\n'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
string|"'{}'"
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'Index 0: not a JSON object\\n'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
string|'\'["zombocom"]\''
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_bogus_input_bad_keys
dedent|''
name|'def'
name|'test_bogus_input_bad_keys'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
string|'"Index 0: extraneous keys \\"baz\\", \\"foo\\"\\n"'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|','
nl|'\n'
string|"'foo'"
op|':'
string|"'bar'"
op|','
string|"'baz'"
op|':'
string|"'quux'"
op|'}'
op|']'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_bogus_input_ranges
dedent|''
name|'def'
name|'test_bogus_input_ranges'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
string|'"Index 0: invalid range\\n"'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
string|"'blah'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|','
string|"'range'"
op|':'
string|"'non-range value'"
op|'}'
op|']'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
string|'"Index 0: multiple ranges (only one allowed)\\n"'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
string|"'blah'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|','
string|"'range'"
op|':'
string|"'1-20,30-40'"
op|'}'
op|']'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_bogus_input_unsatisfiable_range
dedent|''
name|'def'
name|'test_bogus_input_unsatisfiable_range'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
string|'"Index 0: unsatisfiable range\\n"'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
string|"'blah'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|','
string|"'range'"
op|':'
string|"'8888-9999'"
op|'}'
op|']'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
comment|'# since size is optional, we have to be able to defer this check'
nl|'\n'
name|'segs'
op|'='
name|'self'
op|'.'
name|'_put_slo'
op|'('
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
string|"'blah'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
name|'None'
op|','
string|"'range'"
op|':'
string|"'8888-9999'"
op|'}'
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'1'
op|','
name|'len'
op|'('
name|'segs'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_bogus_input_path
dedent|''
name|'def'
name|'test_bogus_input_path'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
string|'"Index 0: path does not refer to an object. Path must be of the "'
nl|'\n'
string|'"form /container/object.\\n"'
nl|'\n'
string|'"Index 1: path does not refer to an object. Path must be of the "'
nl|'\n'
string|'"form /container/object.\\n"'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont'"
op|','
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/c-trailing-slash/'"
op|','
string|"'etag'"
op|':'
string|"'e'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/con/obj'"
op|','
string|"'etag'"
op|':'
string|"'e'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/con/obj-trailing-slash/'"
op|','
string|"'etag'"
op|':'
string|"'e'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/con/obj/with/slashes'"
op|','
string|"'etag'"
op|':'
string|"'e'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_bogus_input_multiple
dedent|''
name|'def'
name|'test_bogus_input_multiple'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
string|'"Index 0: invalid range\\nIndex 1: not a JSON object\\n"'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|','
string|"'range'"
op|':'
string|"'non-range value'"
op|'}'
op|','
nl|'\n'
name|'None'
op|']'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_bogus_input_size_bytes
dedent|''
name|'def'
name|'test_bogus_input_size_bytes'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
string|'"Index 0: invalid size_bytes\\n"'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
string|"'blah'"
op|','
string|"'size_bytes'"
op|':'
string|'"fht"'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
string|"'blah'"
op|','
string|"'size_bytes'"
op|':'
name|'None'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
string|"'blah'"
op|','
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|','
nl|'\n'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
string|'"Index 0: invalid size_bytes\\n"'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
string|"'blah'"
op|','
string|"'size_bytes'"
op|':'
op|'['
op|']'
op|'}'
op|']'
op|','
nl|'\n'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_bogus_input_self_referential
dedent|''
name|'def'
name|'test_bogus_input_self_referential'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
string|'"Index 0: manifest must not include itself as a segment\\n"'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/c/the-manifest'"
op|','
string|"'etag'"
op|':'
string|"'gate'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|','
string|"'range'"
op|':'
string|"'non-range value'"
op|'}'
op|']'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_bogus_input_self_referential_non_ascii
dedent|''
name|'def'
name|'test_bogus_input_self_referential_non_ascii'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
string|'"Index 0: manifest must not include itself as a segment\\n"'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
string|"u'/c/\xe3\x81\x82_1'"
op|','
nl|'\n'
string|"'etag'"
op|':'
string|"'a'"
op|','
string|"'size_bytes'"
op|':'
number|'1'
op|'}'
op|']'
op|')'
op|','
nl|'\n'
name|'manifest_path'
op|'='
name|'quote'
op|'('
string|"u'/v1/a/c/\xe3\x81\x82_1'"
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_bogus_input_self_referential_last_segment
dedent|''
name|'def'
name|'test_bogus_input_self_referential_last_segment'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'test_json_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/c/seg_1'"
op|','
string|"'etag'"
op|':'
string|"'a'"
op|','
string|"'size_bytes'"
op|':'
number|'1'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/c/seg_2'"
op|','
string|"'etag'"
op|':'
string|"'a'"
op|','
string|"'size_bytes'"
op|':'
number|'1'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/c/seg_3'"
op|','
string|"'etag'"
op|':'
string|"'a'"
op|','
string|"'size_bytes'"
op|':'
number|'1'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/c/the-manifest'"
op|','
string|"'etag'"
op|':'
string|"'a'"
op|','
string|"'size_bytes'"
op|':'
number|'1'
op|'}'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
string|'"Index 3: manifest must not include itself as a segment\\n"'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
nl|'\n'
name|'test_json_data'
op|','
nl|'\n'
name|'manifest_path'
op|'='
name|'quote'
op|'('
string|"'/v1/a/c/the-manifest'"
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_bogus_input_undersize_segment
dedent|''
name|'def'
name|'test_bogus_input_undersize_segment'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
string|'"Index 1: too small; each segment "'
nl|'\n'
string|'"must be at least 1 byte.\\n"'
nl|'\n'
string|'"Index 2: too small; each segment "'
nl|'\n'
string|'"must be at least 1 byte.\\n"'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_put_bogus_slo'
op|'('
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"u'/c/s1'"
op|','
string|"'etag'"
op|':'
string|"'a'"
op|','
string|"'size_bytes'"
op|':'
number|'1'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"u'/c/s2'"
op|','
string|"'etag'"
op|':'
string|"'b'"
op|','
string|"'size_bytes'"
op|':'
number|'0'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"u'/c/s3'"
op|','
string|"'etag'"
op|':'
string|"'c'"
op|','
string|"'size_bytes'"
op|':'
number|'0'
op|'}'
op|','
nl|'\n'
comment|'# No error for this one since size_bytes is unspecified'
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"u'/c/s4'"
op|','
string|"'etag'"
op|':'
string|"'d'"
op|','
string|"'size_bytes'"
op|':'
name|'None'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"u'/c/s5'"
op|','
string|"'etag'"
op|':'
string|"'e'"
op|','
string|"'size_bytes'"
op|':'
number|'1000'
op|'}'
op|']'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_valid_input
dedent|''
name|'def'
name|'test_valid_input'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
string|"'/cont/object'"
op|','
nl|'\n'
name|'slo'
op|'.'
name|'parse_and_validate_input'
op|'('
name|'data'
op|','
string|"'/v1/a/cont/man'"
op|')'
op|'['
number|'0'
op|']'
op|'['
string|"'path'"
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|','
string|"'range'"
op|':'
string|"'0-40'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'parsed'
op|'='
name|'slo'
op|'.'
name|'parse_and_validate_input'
op|'('
name|'data'
op|','
string|"'/v1/a/cont/man'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'/cont/object'"
op|','
name|'parsed'
op|'['
number|'0'
op|']'
op|'['
string|"'path'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
op|'['
op|'('
number|'0'
op|','
number|'40'
op|')'
op|']'
op|','
name|'parsed'
op|'['
number|'0'
op|']'
op|'['
string|"'range'"
op|']'
op|'.'
name|'ranges'
op|')'
newline|'\n'
nl|'\n'
name|'data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
name|'None'
op|','
string|"'range'"
op|':'
string|"'0-40'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'parsed'
op|'='
name|'slo'
op|'.'
name|'parse_and_validate_input'
op|'('
name|'data'
op|','
string|"'/v1/a/cont/man'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'/cont/object'"
op|','
name|'parsed'
op|'['
number|'0'
op|']'
op|'['
string|"'path'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'parsed'
op|'['
number|'0'
op|']'
op|'['
string|"'size_bytes'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
op|'['
op|'('
number|'0'
op|','
number|'40'
op|')'
op|']'
op|','
name|'parsed'
op|'['
number|'0'
op|']'
op|'['
string|"'range'"
op|']'
op|'.'
name|'ranges'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestSloPutManifest
dedent|''
dedent|''
name|'class'
name|'TestSloPutManifest'
op|'('
name|'SloTestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'TestSloPutManifest'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/'"
op|','
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
op|'}'
op|','
string|"'passed'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'PUT'"
op|','
string|"'/'"
op|','
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
op|'}'
op|','
string|"'passed'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/cont/object'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
nl|'\n'
op|'{'
string|"'Content-Length'"
op|':'
string|"'100'"
op|','
string|"'Etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|'}'
op|','
nl|'\n'
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/cont/object2'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
nl|'\n'
op|'{'
string|"'Content-Length'"
op|':'
string|"'100'"
op|','
string|"'Etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|'}'
op|','
nl|'\n'
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/cont/object\\xe2\\x99\\xa1'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
nl|'\n'
op|'{'
string|"'Content-Length'"
op|':'
string|"'100'"
op|','
string|"'Etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|'}'
op|','
nl|'\n'
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/cont/small_object'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
nl|'\n'
op|'{'
string|"'Content-Length'"
op|':'
string|"'10'"
op|','
string|"'Etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|'}'
op|','
nl|'\n'
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/cont/empty_object'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
nl|'\n'
op|'{'
string|"'Content-Length'"
op|':'
string|"'0'"
op|','
string|"'Etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|'}'
op|','
nl|'\n'
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'HEAD'"
op|','
string|"u'/v1/AUTH_test/cont/\xe3\x81\x82_1'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
nl|'\n'
op|'{'
string|"'Content-Length'"
op|':'
string|"'1'"
op|','
string|"'Etag'"
op|':'
string|"'a'"
op|'}'
op|','
nl|'\n'
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'PUT'"
op|','
string|"'/v1/AUTH_test/c/man'"
op|','
name|'swob'
op|'.'
name|'HTTPCreated'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/c/man'"
op|','
name|'swob'
op|'.'
name|'HTTPNoContent'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/checktest/a_1'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
nl|'\n'
op|'{'
string|"'Content-Length'"
op|':'
string|"'1'"
op|','
string|"'Etag'"
op|':'
string|"'a'"
op|'}'
op|','
nl|'\n'
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/checktest/badreq'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPBadRequest'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/checktest/b_2'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
nl|'\n'
op|'{'
string|"'Content-Length'"
op|':'
string|"'2'"
op|','
string|"'Etag'"
op|':'
string|"'b'"
op|','
nl|'\n'
string|"'Last-Modified'"
op|':'
string|"'Fri, 01 Feb 2012 20:38:36 GMT'"
op|'}'
op|','
nl|'\n'
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'_manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/checktest/a_5'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"a"'
op|'*'
number|'5'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'5'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/checktest/slob'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
nl|'\n'
op|'{'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
string|"'Etag'"
op|':'
string|"'slob-etag'"
op|','
nl|'\n'
string|"'Content-Type'"
op|':'
string|"'cat/picture;swift_bytes=12345'"
op|','
nl|'\n'
string|"'Content-Length'"
op|':'
name|'len'
op|'('
name|'_manifest_json'
op|')'
op|'}'
op|','
nl|'\n'
name|'_manifest_json'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'PUT'"
op|','
string|"'/v1/AUTH_test/checktest/man_3'"
op|','
name|'swob'
op|'.'
name|'HTTPCreated'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_put_manifest_too_quick_fail
dedent|''
name|'def'
name|'test_put_manifest_too_quick_fail'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1/a/c/o'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'content_length'
op|'='
name|'self'
op|'.'
name|'slo'
op|'.'
name|'max_manifest_size'
op|'+'
number|'1'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'slo'
op|'.'
name|'handle_multipart_put'
op|'('
name|'req'
op|','
name|'fake_start_response'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'HTTPException'
name|'as'
name|'e'
op|':'
newline|'\n'
indent|'            '
name|'pass'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'e'
op|'.'
name|'status_int'
op|','
number|'413'
op|')'
newline|'\n'
nl|'\n'
name|'with'
name|'patch'
op|'.'
name|'object'
op|'('
name|'self'
op|'.'
name|'slo'
op|','
string|"'max_manifest_segments'"
op|','
number|'0'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1/a/c/o'"
op|','
name|'body'
op|'='
name|'test_json_data'
op|')'
newline|'\n'
name|'e'
op|'='
name|'None'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'slo'
op|'.'
name|'handle_multipart_put'
op|'('
name|'req'
op|','
name|'fake_start_response'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'HTTPException'
name|'as'
name|'e'
op|':'
newline|'\n'
indent|'                '
name|'pass'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'e'
op|'.'
name|'status_int'
op|','
number|'413'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1/a/c/o'"
op|','
name|'headers'
op|'='
op|'{'
string|"'X-Copy-From'"
op|':'
string|"'lala'"
op|'}'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'slo'
op|'.'
name|'handle_multipart_put'
op|'('
name|'req'
op|','
name|'fake_start_response'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'HTTPException'
name|'as'
name|'e'
op|':'
newline|'\n'
indent|'            '
name|'pass'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'e'
op|'.'
name|'status_int'
op|','
number|'405'
op|')'
newline|'\n'
nl|'\n'
comment|'# ignores requests to /'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|'}'
op|','
name|'body'
op|'='
name|'test_json_data'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'list'
op|'('
name|'self'
op|'.'
name|'slo'
op|'.'
name|'handle_multipart_put'
op|'('
name|'req'
op|','
name|'fake_start_response'
op|')'
op|')'
op|','
nl|'\n'
op|'['
string|"'passed'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_put_success
dedent|''
name|'def'
name|'test_handle_multipart_put_success'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/c/man?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|'}'
op|','
name|'headers'
op|'='
op|'{'
string|"'Accept'"
op|':'
string|"'test'"
op|'}'
op|','
nl|'\n'
name|'body'
op|'='
name|'test_json_data'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'X-Static-Large-Object'"
name|'not'
name|'in'
name|'req'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|function|my_fake_start_response
name|'def'
name|'my_fake_start_response'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'gen_etag'
op|'='
string|'\'"\''
op|'+'
name|'md5'
op|'('
string|"'etagoftheobjectsegment'"
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
op|'+'
string|'\'"\''
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
op|'('
string|"'Etag'"
op|','
name|'gen_etag'
op|')'
name|'in'
name|'args'
op|'['
number|'1'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'slo'
op|'('
name|'req'
op|'.'
name|'environ'
op|','
name|'my_fake_start_response'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'X-Static-Large-Object'"
name|'in'
name|'req'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_put_disallow_empty_first_segment
dedent|''
name|'def'
name|'test_handle_multipart_put_disallow_empty_first_segment'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'test_json_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
nl|'\n'
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'0'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/cont/small_object'"
op|','
nl|'\n'
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1/a/c/o'"
op|','
name|'body'
op|'='
name|'test_json_data'
op|')'
newline|'\n'
name|'with'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'HTTPException'
op|')'
name|'as'
name|'catcher'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'slo'
op|'.'
name|'handle_multipart_put'
op|'('
name|'req'
op|','
name|'fake_start_response'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'catcher'
op|'.'
name|'exception'
op|'.'
name|'status_int'
op|','
number|'400'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_put_disallow_empty_last_segment
dedent|''
name|'def'
name|'test_handle_multipart_put_disallow_empty_last_segment'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'test_json_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
nl|'\n'
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/cont/small_object'"
op|','
nl|'\n'
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'0'
op|'}'
op|']'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1/a/c/o'"
op|','
name|'body'
op|'='
name|'test_json_data'
op|')'
newline|'\n'
name|'with'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'HTTPException'
op|')'
name|'as'
name|'catcher'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'slo'
op|'.'
name|'handle_multipart_put'
op|'('
name|'req'
op|','
name|'fake_start_response'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'catcher'
op|'.'
name|'exception'
op|'.'
name|'status_int'
op|','
number|'400'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_put_success_unicode
dedent|''
name|'def'
name|'test_handle_multipart_put_success_unicode'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'test_json_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
string|"u'/cont/object\\u2661'"
op|','
nl|'\n'
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/c/man?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|'}'
op|','
name|'headers'
op|'='
op|'{'
string|"'Accept'"
op|':'
string|"'test'"
op|'}'
op|','
nl|'\n'
name|'body'
op|'='
name|'test_json_data'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'X-Static-Large-Object'"
name|'not'
name|'in'
name|'req'
op|'.'
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'slo'
op|'('
name|'req'
op|'.'
name|'environ'
op|','
name|'fake_start_response'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'X-Static-Large-Object'"
name|'in'
name|'req'
op|'.'
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'PATH_INFO'"
op|']'
op|','
string|"'/cont/object\\xe2\\x99\\xa1'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_put_no_xml
dedent|''
name|'def'
name|'test_handle_multipart_put_no_xml'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/test_good/AUTH_test/c/man?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|'}'
op|','
name|'headers'
op|'='
op|'{'
string|"'Accept'"
op|':'
string|"'test'"
op|'}'
op|','
nl|'\n'
name|'body'
op|'='
name|'test_xml_data'
op|')'
newline|'\n'
name|'no_xml'
op|'='
name|'self'
op|'.'
name|'slo'
op|'('
name|'req'
op|'.'
name|'environ'
op|','
name|'fake_start_response'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'no_xml'
op|','
op|'['
string|"'Manifest must be valid JSON.\\n'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_put_bad_data
dedent|''
name|'def'
name|'test_handle_multipart_put_bad_data'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'bad_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
nl|'\n'
string|"'etag'"
op|':'
string|"'etagoftheobj'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
string|"'lala'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/test_good/AUTH_test/c/man?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|'}'
op|','
name|'body'
op|'='
name|'bad_data'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'HTTPException'
op|','
name|'self'
op|'.'
name|'slo'
op|'.'
name|'handle_multipart_put'
op|','
name|'req'
op|','
nl|'\n'
name|'fake_start_response'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'bad_data'
name|'in'
op|'['
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont'"
op|','
string|"'etag'"
op|':'
string|"'etagoftheobj'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
string|"'asdf'"
op|')'
op|','
name|'json'
op|'.'
name|'dumps'
op|'('
name|'None'
op|')'
op|','
name|'json'
op|'.'
name|'dumps'
op|'('
number|'5'
op|')'
op|','
nl|'\n'
string|"'not json'"
op|','
string|"'1234'"
op|','
name|'None'
op|','
string|"''"
op|','
name|'json'
op|'.'
name|'dumps'
op|'('
op|'{'
string|"'path'"
op|':'
name|'None'
op|'}'
op|')'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
name|'None'
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'12'
op|'}'
op|']'
op|')'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
string|"'asdf'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
string|"'sd'"
op|'}'
op|']'
op|')'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
number|'12'
op|','
string|"'etag'"
op|':'
string|"'etagoftheobj'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
string|"u'/cont/object\\u2661'"
op|','
nl|'\n'
string|"'etag'"
op|':'
string|"'etagoftheobj'"
op|','
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
number|'12'
op|','
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
number|'12'
op|','
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/c/o'"
op|','
string|"'etag'"
op|':'
number|'123'
op|','
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
name|'None'
op|','
string|"'etag'"
op|':'
string|"'etagoftheobj'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
op|']'
op|':'
newline|'\n'
indent|'            '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/c/man?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|'}'
op|','
name|'body'
op|'='
name|'bad_data'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'HTTPException'
op|','
name|'self'
op|'.'
name|'slo'
op|'.'
name|'handle_multipart_put'
op|','
nl|'\n'
name|'req'
op|','
name|'fake_start_response'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_put_check_data
dedent|''
dedent|''
name|'def'
name|'test_handle_multipart_put_check_data'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'good_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/checktest/a_1'"
op|','
string|"'etag'"
op|':'
string|"'a'"
op|','
string|"'size_bytes'"
op|':'
string|"'1'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/checktest/b_2'"
op|','
string|"'etag'"
op|':'
string|"'b'"
op|','
string|"'size_bytes'"
op|':'
string|"'2'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/checktest/man_3?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|'}'
op|','
name|'body'
op|'='
name|'good_data'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'call_count'
op|','
number|'3'
op|')'
newline|'\n'
nl|'\n'
comment|"# go behind SLO's back and see what actually got stored"
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
comment|"# this string looks weird, but it's just an artifact"
nl|'\n'
comment|'# of FakeSwift'
nl|'\n'
string|"'/v1/AUTH_test/checktest/man_3?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_app'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'dict'
op|'('
name|'headers'
op|')'
newline|'\n'
name|'manifest_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'headers'
op|'['
string|"'Content-Type'"
op|']'
op|'.'
name|'endswith'
op|'('
string|"';swift_bytes=3'"
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'manifest_data'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'manifest_data'
op|'['
number|'0'
op|']'
op|'['
string|"'hash'"
op|']'
op|','
string|"'a'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'manifest_data'
op|'['
number|'0'
op|']'
op|'['
string|"'bytes'"
op|']'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
nl|'\n'
name|'not'
name|'manifest_data'
op|'['
number|'0'
op|']'
op|'['
string|"'last_modified'"
op|']'
op|'.'
name|'startswith'
op|'('
string|"'2012'"
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'manifest_data'
op|'['
number|'1'
op|']'
op|'['
string|"'last_modified'"
op|']'
op|'.'
name|'startswith'
op|'('
string|"'2012'"
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_put_check_data_bad
dedent|''
name|'def'
name|'test_handle_multipart_put_check_data_bad'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'bad_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/checktest/a_1'"
op|','
string|"'etag'"
op|':'
string|"'a'"
op|','
string|"'size_bytes'"
op|':'
string|"'2'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/checktest/badreq'"
op|','
string|"'etag'"
op|':'
string|"'a'"
op|','
string|"'size_bytes'"
op|':'
string|"'1'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/checktest/b_2'"
op|','
string|"'etag'"
op|':'
string|"'not-b'"
op|','
string|"'size_bytes'"
op|':'
string|"'2'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/checktest/slob'"
op|','
string|"'etag'"
op|':'
string|"'not-slob'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
string|"'12345'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/checktest/man?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Accept'"
op|':'
string|"'application/json'"
op|'}'
op|','
nl|'\n'
name|'body'
op|'='
name|'bad_data'
op|')'
newline|'\n'
nl|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'call_count'
op|','
number|'5'
op|')'
newline|'\n'
name|'errors'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
op|'['
string|"'Errors'"
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'errors'
op|')'
op|','
number|'5'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'errors'
op|'['
number|'0'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'/checktest/a_1'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'errors'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'Size Mismatch'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'errors'
op|'['
number|'1'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'/checktest/badreq'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'errors'
op|'['
number|'1'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'400 Bad Request'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'errors'
op|'['
number|'2'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'/checktest/b_2'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'errors'
op|'['
number|'2'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'Etag Mismatch'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'errors'
op|'['
number|'3'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'/checktest/slob'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'errors'
op|'['
number|'3'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'Size Mismatch'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'errors'
op|'['
number|'4'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'/checktest/slob'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'errors'
op|'['
number|'4'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'Etag Mismatch'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_put_skip_size_check
dedent|''
name|'def'
name|'test_handle_multipart_put_skip_size_check'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'good_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/checktest/a_1'"
op|','
string|"'etag'"
op|':'
string|"'a'"
op|','
string|"'size_bytes'"
op|':'
name|'None'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/checktest/b_2'"
op|','
string|"'etag'"
op|':'
string|"'b'"
op|','
string|"'size_bytes'"
op|':'
name|'None'
op|'}'
op|']'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/checktest/man_3?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|'}'
op|','
name|'body'
op|'='
name|'good_data'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'call_count'
op|','
number|'3'
op|')'
newline|'\n'
nl|'\n'
comment|'# Check that we still populated the manifest properly from our HEADs'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
comment|"# this string looks weird, but it's just an artifact"
nl|'\n'
comment|'# of FakeSwift'
nl|'\n'
string|"'/v1/AUTH_test/checktest/man_3?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_app'
op|'('
name|'req'
op|')'
newline|'\n'
name|'manifest_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'1'
op|','
name|'manifest_data'
op|'['
number|'0'
op|']'
op|'['
string|"'bytes'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'2'
op|','
name|'manifest_data'
op|'['
number|'1'
op|']'
op|'['
string|"'bytes'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_put_skip_size_check_still_uses_min_size
dedent|''
name|'def'
name|'test_handle_multipart_put_skip_size_check_still_uses_min_size'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'test_json_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/empty_object'"
op|','
nl|'\n'
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
name|'None'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/cont/small_object'"
op|','
nl|'\n'
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1/AUTH_test/c/o'"
op|','
name|'body'
op|'='
name|'test_json_data'
op|')'
newline|'\n'
name|'with'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'HTTPException'
op|')'
name|'as'
name|'cm'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'slo'
op|'.'
name|'handle_multipart_put'
op|'('
name|'req'
op|','
name|'fake_start_response'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'cm'
op|'.'
name|'exception'
op|'.'
name|'status_int'
op|','
number|'400'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_put_skip_size_check_no_early_bailout
dedent|''
name|'def'
name|'test_handle_multipart_put_skip_size_check_no_early_bailout'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|"# The first is too small (it's 0 bytes), and"
nl|'\n'
comment|'# the second has a bad etag. Make sure both errors show up in'
nl|'\n'
comment|'# the response.'
nl|'\n'
indent|'        '
name|'test_json_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/cont/empty_object'"
op|','
nl|'\n'
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
name|'None'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/cont/object2'"
op|','
nl|'\n'
string|"'etag'"
op|':'
string|"'wrong wrong wrong'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1/AUTH_test/c/o'"
op|','
name|'body'
op|'='
name|'test_json_data'
op|')'
newline|'\n'
name|'with'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'HTTPException'
op|')'
name|'as'
name|'cm'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'slo'
op|'.'
name|'handle_multipart_put'
op|'('
name|'req'
op|','
name|'fake_start_response'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'cm'
op|'.'
name|'exception'
op|'.'
name|'status_int'
op|','
number|'400'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIn'
op|'('
string|"'at least 1 byte'"
op|','
name|'cm'
op|'.'
name|'exception'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIn'
op|'('
string|"'Etag Mismatch'"
op|','
name|'cm'
op|'.'
name|'exception'
op|'.'
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_put_skip_etag_check
dedent|''
name|'def'
name|'test_handle_multipart_put_skip_etag_check'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'good_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/checktest/a_1'"
op|','
string|"'etag'"
op|':'
name|'None'
op|','
string|"'size_bytes'"
op|':'
number|'1'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/checktest/b_2'"
op|','
string|"'etag'"
op|':'
name|'None'
op|','
string|"'size_bytes'"
op|':'
number|'2'
op|'}'
op|']'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/checktest/man_3?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|'}'
op|','
name|'body'
op|'='
name|'good_data'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'call_count'
op|','
number|'3'
op|')'
newline|'\n'
nl|'\n'
comment|'# Check that we still populated the manifest properly from our HEADs'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
comment|"# this string looks weird, but it's just an artifact"
nl|'\n'
comment|'# of FakeSwift'
nl|'\n'
string|"'/v1/AUTH_test/checktest/man_3?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_app'
op|'('
name|'req'
op|')'
newline|'\n'
name|'manifest_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'a'"
op|','
name|'manifest_data'
op|'['
number|'0'
op|']'
op|'['
string|"'hash'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'b'"
op|','
name|'manifest_data'
op|'['
number|'1'
op|']'
op|'['
string|"'hash'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_unsatisfiable_ranges
dedent|''
name|'def'
name|'test_handle_unsatisfiable_ranges'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'bad_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/checktest/a_1'"
op|','
string|"'etag'"
op|':'
name|'None'
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
name|'None'
op|','
string|"'range'"
op|':'
string|"'1-'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/checktest/man_3?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|'}'
op|','
name|'body'
op|'='
name|'bad_data'
op|')'
newline|'\n'
name|'with'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'HTTPException'
op|')'
name|'as'
name|'catcher'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'slo'
op|'.'
name|'handle_multipart_put'
op|'('
name|'req'
op|','
name|'fake_start_response'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'400'
op|','
name|'catcher'
op|'.'
name|'exception'
op|'.'
name|'status_int'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIn'
op|'('
string|'"Unsatisfiable Range"'
op|','
name|'catcher'
op|'.'
name|'exception'
op|'.'
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_put_success_conditional
dedent|''
name|'def'
name|'test_handle_multipart_put_success_conditional'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'test_json_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'path'"
op|':'
string|"u'/cont/object'"
op|','
nl|'\n'
string|"'etag'"
op|':'
string|"'etagoftheobjectsegment'"
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'100'
op|'}'
op|']'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/c/man?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|'}'
op|','
name|'headers'
op|'='
op|'{'
string|"'If-None-Match'"
op|':'
string|"'*'"
op|'}'
op|','
nl|'\n'
name|'body'
op|'='
name|'test_json_data'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
op|'('
string|"'201 Created'"
op|','
string|"''"
op|')'
op|','
op|'('
name|'status'
op|','
name|'body'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
op|'['
nl|'\n'
op|'('
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/cont/object'"
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
string|"'/v1/AUTH_test/c/man?multipart-manifest=put'"
op|')'
op|','
nl|'\n'
op|']'
op|','
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|')'
newline|'\n'
comment|"# HEAD shouldn't be conditional"
nl|'\n'
name|'self'
op|'.'
name|'assertNotIn'
op|'('
string|"'If-None-Match'"
op|','
name|'self'
op|'.'
name|'app'
op|'.'
name|'headers'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
comment|'# But the PUT should be'
nl|'\n'
name|'self'
op|'.'
name|'assertIn'
op|'('
string|"'If-None-Match'"
op|','
name|'self'
op|'.'
name|'app'
op|'.'
name|'headers'
op|'['
number|'1'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'*'"
op|','
name|'self'
op|'.'
name|'app'
op|'.'
name|'headers'
op|'['
number|'1'
op|']'
op|'['
string|"'If-None-Match'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_single_ranges
dedent|''
name|'def'
name|'test_handle_single_ranges'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'good_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'path'"
op|':'
string|"'/checktest/a_1'"
op|','
string|"'etag'"
op|':'
name|'None'
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
name|'None'
op|','
string|"'range'"
op|':'
string|"'0-0'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/checktest/b_2'"
op|','
string|"'etag'"
op|':'
name|'None'
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'2'
op|','
string|"'range'"
op|':'
string|"'-1'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/checktest/b_2'"
op|','
string|"'etag'"
op|':'
name|'None'
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
number|'2'
op|','
string|"'range'"
op|':'
string|"'0-0'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'path'"
op|':'
string|"'/cont/object'"
op|','
string|"'etag'"
op|':'
name|'None'
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
name|'None'
op|','
string|"'range'"
op|':'
string|"'10-40'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/checktest/man_3?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|'}'
op|','
name|'body'
op|'='
name|'good_data'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'expected_etag'
op|'='
string|'\'"%s"\''
op|'%'
name|'md5'
op|'('
string|"'ab:1-1;b:0-0;etagoftheobjectsegment:'"
nl|'\n'
string|"'10-40;'"
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'expected_etag'
op|','
name|'dict'
op|'('
name|'headers'
op|')'
op|'['
string|"'Etag'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
op|'['
nl|'\n'
op|'('
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/checktest/a_1'"
op|')'
op|','
nl|'\n'
op|'('
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/checktest/b_2'"
op|')'
op|','
comment|'# Only once!'
nl|'\n'
op|'('
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/cont/object'"
op|')'
op|','
nl|'\n'
op|'('
string|"'PUT'"
op|','
string|"'/v1/AUTH_test/checktest/man_3?multipart-manifest=put'"
op|')'
op|','
nl|'\n'
op|']'
op|','
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|')'
newline|'\n'
nl|'\n'
comment|'# Check that we still populated the manifest properly from our HEADs'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
comment|"# this string looks weird, but it's just an artifact"
nl|'\n'
comment|'# of FakeSwift'
nl|'\n'
string|"'/v1/AUTH_test/checktest/man_3?multipart-manifest=put'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_app'
op|'('
name|'req'
op|')'
newline|'\n'
name|'manifest_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'a'"
op|','
name|'manifest_data'
op|'['
number|'0'
op|']'
op|'['
string|"'hash'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertNotIn'
op|'('
string|"'range'"
op|','
name|'manifest_data'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertNotIn'
op|'('
string|"'segment_bytes'"
op|','
name|'manifest_data'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'b'"
op|','
name|'manifest_data'
op|'['
number|'1'
op|']'
op|'['
string|"'hash'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'1-1'"
op|','
name|'manifest_data'
op|'['
number|'1'
op|']'
op|'['
string|"'range'"
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'b'"
op|','
name|'manifest_data'
op|'['
number|'2'
op|']'
op|'['
string|"'hash'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'0-0'"
op|','
name|'manifest_data'
op|'['
number|'2'
op|']'
op|'['
string|"'range'"
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'etagoftheobjectsegment'"
op|','
name|'manifest_data'
op|'['
number|'3'
op|']'
op|'['
string|"'hash'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'10-40'"
op|','
name|'manifest_data'
op|'['
number|'3'
op|']'
op|'['
string|"'range'"
op|']'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestSloDeleteManifest
dedent|''
dedent|''
name|'class'
name|'TestSloDeleteManifest'
op|'('
name|'SloTestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'TestSloDeleteManifest'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'_submanifest_data'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/deltest/b_2'"
op|','
string|"'hash'"
op|':'
string|"'a'"
op|','
string|"'bytes'"
op|':'
string|"'1'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/deltest/c_3'"
op|','
string|"'hash'"
op|':'
string|"'b'"
op|','
string|"'bytes'"
op|':'
string|"'2'"
op|'}'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/man_404'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPNotFound'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/man'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|'}'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/deltest/gone'"
op|','
string|"'hash'"
op|':'
string|"'a'"
op|','
string|"'bytes'"
op|':'
string|"'1'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/deltest/b_2'"
op|','
string|"'hash'"
op|':'
string|"'b'"
op|','
string|"'bytes'"
op|':'
string|"'2'"
op|'}'
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/man'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPNoContent'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/man-all-there'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|'}'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/deltest/b_2'"
op|','
string|"'hash'"
op|':'
string|"'a'"
op|','
string|"'bytes'"
op|':'
string|"'1'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/deltest/c_3'"
op|','
string|"'hash'"
op|':'
string|"'b'"
op|','
string|"'bytes'"
op|':'
string|"'2'"
op|'}'
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/man-all-there'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPNoContent'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/gone'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPNotFound'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/a_1'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'1'"
op|'}'
op|','
string|"'a'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/a_1'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPNoContent'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/b_2'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPNoContent'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/c_3'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPNoContent'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/d_3'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPNoContent'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/manifest-with-submanifest'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|'}'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/deltest/a_1'"
op|','
nl|'\n'
string|"'hash'"
op|':'
string|"'a'"
op|','
string|"'bytes'"
op|':'
string|"'1'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/deltest/submanifest'"
op|','
string|"'sub_slo'"
op|':'
name|'True'
op|','
nl|'\n'
string|"'hash'"
op|':'
string|"'submanifest-etag'"
op|','
nl|'\n'
string|"'bytes'"
op|':'
name|'len'
op|'('
name|'_submanifest_data'
op|')'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/deltest/d_3'"
op|','
nl|'\n'
string|"'hash'"
op|':'
string|"'d'"
op|','
string|"'bytes'"
op|':'
string|"'3'"
op|'}'
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/manifest-with-submanifest'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPNoContent'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/submanifest'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|'}'
op|','
nl|'\n'
name|'_submanifest_data'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/submanifest'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPNoContent'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/manifest-missing-submanifest'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|'}'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/deltest/a_1'"
op|','
string|"'hash'"
op|':'
string|"'a'"
op|','
string|"'bytes'"
op|':'
string|"'1'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/deltest/missing-submanifest'"
op|','
nl|'\n'
string|"'hash'"
op|':'
string|"'a'"
op|','
string|"'bytes'"
op|':'
string|"'2'"
op|','
string|"'sub_slo'"
op|':'
name|'True'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/deltest/d_3'"
op|','
string|"'hash'"
op|':'
string|"'d'"
op|','
string|"'bytes'"
op|':'
string|"'3'"
op|'}'
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/manifest-missing-submanifest'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPNoContent'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/missing-submanifest'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPNotFound'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/manifest-badjson'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|'}'
op|','
nl|'\n'
string|'"[not {json (at ++++all"'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/manifest-with-unauth-segment'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|'}'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/deltest/a_1'"
op|','
string|"'hash'"
op|':'
string|"'a'"
op|','
string|"'bytes'"
op|':'
string|"'1'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/deltest-unauth/q_17'"
op|','
nl|'\n'
string|"'hash'"
op|':'
string|"'11'"
op|','
string|"'bytes'"
op|':'
string|"'17'"
op|'}'
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/manifest-with-unauth-segment'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPNoContent'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest-unauth/q_17'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPUnauthorized'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_delete_man
dedent|''
name|'def'
name|'test_handle_multipart_delete_man'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/deltest/man'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'slo'
op|'('
name|'req'
op|'.'
name|'environ'
op|','
name|'fake_start_response'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'call_count'
op|','
number|'1'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_delete_bad_utf8
dedent|''
name|'def'
name|'test_handle_multipart_delete_bad_utf8'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/deltest/man\\xff\\xfe?multipart-manifest=delete'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|','
nl|'\n'
string|"'HTTP_ACCEPT'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'resp_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Status'"
op|']'
op|','
nl|'\n'
string|"'412 Precondition Failed'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_delete_whole_404
dedent|''
name|'def'
name|'test_handle_multipart_delete_whole_404'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/deltest/man_404?multipart-manifest=delete'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|','
nl|'\n'
string|"'HTTP_ACCEPT'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'resp_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
nl|'\n'
string|"'/v1/AUTH_test/deltest/man_404?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Status'"
op|']'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Body'"
op|']'
op|','
string|"''"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Number Deleted'"
op|']'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Number Not Found'"
op|']'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Errors'"
op|']'
op|','
op|'['
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_delete_segment_404
dedent|''
name|'def'
name|'test_handle_multipart_delete_segment_404'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/deltest/man?multipart-manifest=delete'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|','
nl|'\n'
string|"'HTTP_ACCEPT'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'resp_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
nl|'\n'
string|"'/v1/AUTH_test/deltest/man?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
nl|'\n'
string|"'/v1/AUTH_test/deltest/gone?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
nl|'\n'
string|"'/v1/AUTH_test/deltest/b_2?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
nl|'\n'
string|"'/v1/AUTH_test/deltest/man?multipart-manifest=delete'"
op|')'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Status'"
op|']'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Number Deleted'"
op|']'
op|','
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Number Not Found'"
op|']'
op|','
number|'1'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_delete_whole
dedent|''
name|'def'
name|'test_handle_multipart_delete_whole'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/deltest/man-all-there?multipart-manifest=delete'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
nl|'\n'
string|"'/v1/AUTH_test/deltest/man-all-there?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/b_2?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/c_3?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
op|'('
string|"'/v1/AUTH_test/deltest/'"
op|'+'
nl|'\n'
string|"'man-all-there?multipart-manifest=delete'"
op|')'
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_delete_nested
dedent|''
name|'def'
name|'test_handle_multipart_delete_nested'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/deltest/manifest-with-submanifest?'"
op|'+'
nl|'\n'
string|"'multipart-manifest=delete'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'set'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/'"
op|'+'
nl|'\n'
string|"'manifest-with-submanifest?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/'"
op|'+'
nl|'\n'
string|"'submanifest?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
nl|'\n'
string|"'/v1/AUTH_test/deltest/a_1?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
nl|'\n'
string|"'/v1/AUTH_test/deltest/b_2?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
nl|'\n'
string|"'/v1/AUTH_test/deltest/c_3?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
nl|'\n'
string|"'/v1/AUTH_test/deltest/'"
op|'+'
nl|'\n'
string|"'submanifest?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
nl|'\n'
string|"'/v1/AUTH_test/deltest/d_3?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
nl|'\n'
string|"'/v1/AUTH_test/deltest/'"
op|'+'
nl|'\n'
string|"'manifest-with-submanifest?multipart-manifest=delete'"
op|')'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_delete_nested_too_many_segments
dedent|''
name|'def'
name|'test_handle_multipart_delete_nested_too_many_segments'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/deltest/manifest-with-submanifest?'"
op|'+'
nl|'\n'
string|"'multipart-manifest=delete'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|','
nl|'\n'
string|"'HTTP_ACCEPT'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'with'
name|'patch'
op|'.'
name|'object'
op|'('
name|'slo'
op|','
string|"'MAX_BUFFERED_SLO_SEGMENTS'"
op|','
number|'1'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'resp_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Status'"
op|']'
op|','
string|"'400 Bad Request'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Body'"
op|']'
op|','
nl|'\n'
string|"'Too many buffered slo segments to delete.'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_delete_nested_404
dedent|''
name|'def'
name|'test_handle_multipart_delete_nested_404'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/deltest/manifest-missing-submanifest'"
op|'+'
nl|'\n'
string|"'?multipart-manifest=delete'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|','
nl|'\n'
string|"'HTTP_ACCEPT'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'resp_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/'"
op|'+'
nl|'\n'
string|"'manifest-missing-submanifest?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/a_1?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/'"
op|'+'
nl|'\n'
string|"'missing-submanifest?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/d_3?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/'"
op|'+'
nl|'\n'
string|"'manifest-missing-submanifest?multipart-manifest=delete'"
op|')'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Status'"
op|']'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Body'"
op|']'
op|','
string|"''"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Number Deleted'"
op|']'
op|','
number|'3'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Number Not Found'"
op|']'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Errors'"
op|']'
op|','
op|'['
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_delete_nested_401
dedent|''
name|'def'
name|'test_handle_multipart_delete_nested_401'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/submanifest'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPUnauthorized'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
op|'('
string|"'/v1/AUTH_test/deltest/manifest-with-submanifest'"
op|'+'
nl|'\n'
string|"'?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|','
nl|'\n'
string|"'HTTP_ACCEPT'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'resp_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Status'"
op|']'
op|','
string|"'400 Bad Request'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Errors'"
op|']'
op|','
nl|'\n'
op|'['
op|'['
string|"'/deltest/submanifest'"
op|','
string|"'401 Unauthorized'"
op|']'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_delete_nested_500
dedent|''
name|'def'
name|'test_handle_multipart_delete_nested_500'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/submanifest'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPServerError'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
op|'('
string|"'/v1/AUTH_test/deltest/manifest-with-submanifest'"
op|'+'
nl|'\n'
string|"'?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|','
nl|'\n'
string|"'HTTP_ACCEPT'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'resp_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Status'"
op|']'
op|','
string|"'400 Bad Request'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Errors'"
op|']'
op|','
nl|'\n'
op|'['
op|'['
string|"'/deltest/submanifest'"
op|','
nl|'\n'
string|"'Unable to load SLO manifest or segment.'"
op|']'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_delete_not_a_manifest
dedent|''
name|'def'
name|'test_handle_multipart_delete_not_a_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/deltest/a_1?multipart-manifest=delete'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|','
nl|'\n'
string|"'HTTP_ACCEPT'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'resp_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/a_1?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Status'"
op|']'
op|','
string|"'400 Bad Request'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Body'"
op|']'
op|','
string|"''"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Number Deleted'"
op|']'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Number Not Found'"
op|']'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Errors'"
op|']'
op|','
nl|'\n'
op|'['
op|'['
string|"'/deltest/a_1'"
op|','
string|"'Not an SLO manifest'"
op|']'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_delete_bad_json
dedent|''
name|'def'
name|'test_handle_multipart_delete_bad_json'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/deltest/manifest-badjson?multipart-manifest=delete'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|','
nl|'\n'
string|"'HTTP_ACCEPT'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'resp_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/'"
op|'+'
nl|'\n'
string|"'manifest-badjson?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Status'"
op|']'
op|','
string|"'400 Bad Request'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Body'"
op|']'
op|','
string|"''"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Number Deleted'"
op|']'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Number Not Found'"
op|']'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Errors'"
op|']'
op|','
nl|'\n'
op|'['
op|'['
string|"'/deltest/manifest-badjson'"
op|','
nl|'\n'
string|"'Unable to load SLO manifest'"
op|']'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_delete_401
dedent|''
name|'def'
name|'test_handle_multipart_delete_401'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/deltest/manifest-with-unauth-segment'"
op|'+'
nl|'\n'
string|"'?multipart-manifest=delete'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|','
nl|'\n'
string|"'HTTP_ACCEPT'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'resp_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/deltest/'"
op|'+'
nl|'\n'
string|"'manifest-with-unauth-segment?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/a_1?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest-unauth/'"
op|'+'
nl|'\n'
string|"'q_17?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/'"
op|'+'
nl|'\n'
string|"'manifest-with-unauth-segment?multipart-manifest=delete'"
op|')'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Status'"
op|']'
op|','
string|"'400 Bad Request'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Response Body'"
op|']'
op|','
string|"''"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Number Deleted'"
op|']'
op|','
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Number Not Found'"
op|']'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|"'Errors'"
op|']'
op|','
nl|'\n'
op|'['
op|'['
string|"'/deltest-unauth/q_17'"
op|','
string|"'401 Unauthorized'"
op|']'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_handle_multipart_delete_client_content_type
dedent|''
name|'def'
name|'test_handle_multipart_delete_client_content_type'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/deltest/man-all-there?multipart-manifest=delete'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|','
string|"'CONTENT_TYPE'"
op|':'
string|"'foo/bar'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Accept'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'resp_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp_data'
op|'['
string|'"Number Deleted"'
op|']'
op|','
number|'3'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
nl|'\n'
string|"'/v1/AUTH_test/deltest/man-all-there?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/b_2?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
string|"'/v1/AUTH_test/deltest/c_3?multipart-manifest=delete'"
op|')'
op|','
nl|'\n'
op|'('
string|"'DELETE'"
op|','
op|'('
string|"'/v1/AUTH_test/deltest/'"
op|'+'
nl|'\n'
string|"'man-all-there?multipart-manifest=delete'"
op|')'
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestSloHeadManifest
dedent|''
dedent|''
name|'class'
name|'TestSloHeadManifest'
op|'('
name|'SloTestCase'
op|')'
op|':'
newline|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'TestSloHeadManifest'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'_manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/seg01'"
op|','
nl|'\n'
string|"'bytes'"
op|':'
string|"'100'"
op|','
nl|'\n'
string|"'hash'"
op|':'
string|"'seg01-hash'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
nl|'\n'
string|"'last_modified'"
op|':'
string|"'2013-11-19T11:33:45.137446'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/seg02'"
op|','
nl|'\n'
string|"'bytes'"
op|':'
string|"'200'"
op|','
nl|'\n'
string|"'hash'"
op|':'
string|"'seg02-hash'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
nl|'\n'
string|"'last_modified'"
op|':'
string|"'2013-11-19T11:33:45.137447'"
op|'}'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/headtest/man'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
name|'str'
op|'('
name|'len'
op|'('
name|'self'
op|'.'
name|'_manifest_json'
op|')'
op|')'
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5'
op|'('
name|'self'
op|'.'
name|'_manifest_json'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
op|'}'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_manifest_json'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_etag_is_hash_of_segment_etags
dedent|''
name|'def'
name|'test_etag_is_hash_of_segment_etags'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/headtest/man'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'HEAD'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'.'
name|'get'
op|'('
string|"'Etag'"
op|','
string|"''"
op|')'
op|'.'
name|'strip'
op|'('
string|'"\'\\""'
op|')'
op|','
nl|'\n'
name|'md5'
op|'('
string|'"seg01-hashseg02-hash"'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"''"
op|')'
comment|"# it's a HEAD request, after all"
newline|'\n'
nl|'\n'
DECL|member|test_etag_matching
dedent|''
name|'def'
name|'test_etag_matching'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'etag'
op|'='
name|'md5'
op|'('
string|'"seg01-hashseg02-hash"'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/headtest/man'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'HEAD'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'If-None-Match'"
op|':'
name|'etag'
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'304 Not Modified'"
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestSloGetRawManifest
dedent|''
dedent|''
name|'class'
name|'TestSloGetRawManifest'
op|'('
name|'SloTestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'TestSloGetRawManifest'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'_bc_manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/b_10'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'b'"
op|'*'
number|'10'
op|')'
op|','
string|"'bytes'"
op|':'
string|"'10'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
nl|'\n'
string|"'last_modified'"
op|':'
string|"'1970-01-01T00:00:00.000000'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/c_15'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'c'"
op|'*'
number|'15'
op|')'
op|','
string|"'bytes'"
op|':'
string|"'15'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
nl|'\n'
string|"'last_modified'"
op|':'
string|"'1970-01-01T00:00:00.000000'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/d_10'"
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
name|'md5hex'
op|'('
string|'"e"'
op|'*'
number|'5'
op|')'
op|'+'
name|'md5hex'
op|'('
string|'"f"'
op|'*'
number|'5'
op|')'
op|')'
op|','
string|"'bytes'"
op|':'
string|"'10'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'application/json;swift_bytes=10'"
op|','
nl|'\n'
string|"'sub_slo'"
op|':'
name|'True'
op|','
nl|'\n'
string|"'last_modified'"
op|':'
string|"'1970-01-01T00:00:00.000000'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'bc_etag'
op|'='
name|'md5hex'
op|'('
name|'_bc_manifest_json'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json;swift_bytes=35'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'X-Object-Meta-Plant'"
op|':'
string|"'Ficus'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
name|'_bc_manifest_json'
op|')'
op|'}'
op|','
nl|'\n'
name|'_bc_manifest_json'
op|')'
newline|'\n'
nl|'\n'
name|'_bc_manifest_json_ranges'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/b_10'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'b'"
op|'*'
number|'10'
op|')'
op|','
string|"'bytes'"
op|':'
string|"'10'"
op|','
nl|'\n'
string|"'last_modified'"
op|':'
string|"'1970-01-01T00:00:00.000000'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'range'"
op|':'
string|"'1-99'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/c_15'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'c'"
op|'*'
number|'15'
op|')'
op|','
string|"'bytes'"
op|':'
string|"'15'"
op|','
nl|'\n'
string|"'last_modified'"
op|':'
string|"'1970-01-01T00:00:00.000000'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'range'"
op|':'
string|"'100-200'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc-r'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json;swift_bytes=25'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'X-Object-Meta-Plant'"
op|':'
string|"'Ficus'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
name|'_bc_manifest_json_ranges'
op|')'
op|'}'
op|','
nl|'\n'
name|'_bc_manifest_json_ranges'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_raw_manifest
dedent|''
name|'def'
name|'test_get_raw_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-bc'"
nl|'\n'
string|"'?multipart-manifest=get&format=raw'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|','
nl|'\n'
string|"'HTTP_ACCEPT'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
op|'('
string|"'Etag'"
op|','
name|'self'
op|'.'
name|'bc_etag'
op|')'
name|'in'
name|'headers'
op|','
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
op|'('
string|"'X-Static-Large-Object'"
op|','
string|"'true'"
op|')'
name|'in'
name|'headers'
op|','
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
nl|'\n'
op|'('
string|"'Content-Type'"
op|','
string|"'application/json; charset=utf-8'"
op|')'
name|'in'
name|'headers'
op|','
nl|'\n'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'resp_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'ValueError'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'fail'
op|'('
string|'"Invalid JSON in manifest GET: %r"'
op|'%'
name|'body'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'resp_data'
op|','
nl|'\n'
op|'['
op|'{'
string|"'etag'"
op|':'
name|'md5hex'
op|'('
string|"'b'"
op|'*'
number|'10'
op|')'
op|','
string|"'size_bytes'"
op|':'
string|"'10'"
op|','
nl|'\n'
string|"'path'"
op|':'
string|"'/gettest/b_10'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'etag'"
op|':'
name|'md5hex'
op|'('
string|"'c'"
op|'*'
number|'15'
op|')'
op|','
string|"'size_bytes'"
op|':'
string|"'15'"
op|','
nl|'\n'
string|"'path'"
op|':'
string|"'/gettest/c_15'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'etag'"
op|':'
name|'md5hex'
op|'('
name|'md5hex'
op|'('
string|'"e"'
op|'*'
number|'5'
op|')'
op|'+'
name|'md5hex'
op|'('
string|'"f"'
op|'*'
number|'5'
op|')'
op|')'
op|','
nl|'\n'
string|"'size_bytes'"
op|':'
string|"'10'"
op|','
nl|'\n'
string|"'path'"
op|':'
string|"'/gettest/d_10'"
op|'}'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_raw_manifest_passthrough_with_ranges
dedent|''
name|'def'
name|'test_get_raw_manifest_passthrough_with_ranges'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-bc-r'"
nl|'\n'
string|"'?multipart-manifest=get&format=raw'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|','
nl|'\n'
string|"'HTTP_ACCEPT'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
nl|'\n'
op|'('
string|"'Content-Type'"
op|','
string|"'application/json; charset=utf-8'"
op|')'
name|'in'
name|'headers'
op|','
nl|'\n'
name|'headers'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'resp_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'ValueError'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'fail'
op|'('
string|'"Invalid JSON in manifest GET: %r"'
op|'%'
name|'body'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'resp_data'
op|','
nl|'\n'
op|'['
op|'{'
string|"'etag'"
op|':'
name|'md5hex'
op|'('
string|"'b'"
op|'*'
number|'10'
op|')'
op|','
string|"'size_bytes'"
op|':'
string|"'10'"
op|','
nl|'\n'
string|"'path'"
op|':'
string|"'/gettest/b_10'"
op|','
string|"'range'"
op|':'
string|"'1-99'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'etag'"
op|':'
name|'md5hex'
op|'('
string|"'c'"
op|'*'
number|'15'
op|')'
op|','
string|"'size_bytes'"
op|':'
string|"'15'"
op|','
nl|'\n'
string|"'path'"
op|':'
string|"'/gettest/c_15'"
op|','
string|"'range'"
op|':'
string|"'100-200'"
op|'}'
op|']'
op|','
nl|'\n'
name|'body'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestSloGetManifest
dedent|''
dedent|''
name|'class'
name|'TestSloGetManifest'
op|'('
name|'SloTestCase'
op|')'
op|':'
newline|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'TestSloGetManifest'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
nl|'\n'
comment|'# some plain old objects'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'5'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'a'"
op|'*'
number|'5'
op|')'
op|'}'
op|','
nl|'\n'
string|"'a'"
op|'*'
number|'5'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'10'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'b'"
op|'*'
number|'10'
op|')'
op|'}'
op|','
nl|'\n'
string|"'b'"
op|'*'
number|'10'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'15'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'c'"
op|'*'
number|'15'
op|')'
op|'}'
op|','
nl|'\n'
string|"'c'"
op|'*'
number|'15'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/d_20'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'20'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'d'"
op|'*'
number|'20'
op|')'
op|'}'
op|','
nl|'\n'
string|"'d'"
op|'*'
number|'20'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/e_25'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'25'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'e'"
op|'*'
number|'25'
op|')'
op|'}'
op|','
nl|'\n'
string|"'e'"
op|'*'
number|'25'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/f_30'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'30'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'f'"
op|'*'
number|'30'
op|')'
op|'}'
op|','
nl|'\n'
string|"'f'"
op|'*'
number|'30'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/g_35'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'35'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'g'"
op|'*'
number|'35'
op|')'
op|'}'
op|','
nl|'\n'
string|"'g'"
op|'*'
number|'35'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/h_40'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'40'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'h'"
op|'*'
number|'40'
op|')'
op|'}'
op|','
nl|'\n'
string|"'h'"
op|'*'
number|'40'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/i_45'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'45'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'i'"
op|'*'
number|'45'
op|')'
op|'}'
op|','
nl|'\n'
string|"'i'"
op|'*'
number|'45'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/j_50'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'50'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'j'"
op|'*'
number|'50'
op|')'
op|'}'
op|','
nl|'\n'
string|"'j'"
op|'*'
number|'50'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/k_55'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'55'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'k'"
op|'*'
number|'55'
op|')'
op|'}'
op|','
nl|'\n'
string|"'k'"
op|'*'
number|'55'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/l_60'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'60'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'l'"
op|'*'
number|'60'
op|')'
op|'}'
op|','
nl|'\n'
string|"'l'"
op|'*'
number|'60'
op|')'
newline|'\n'
nl|'\n'
name|'_bc_manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/b_10'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'b'"
op|'*'
number|'10'
op|')'
op|','
string|"'bytes'"
op|':'
string|"'10'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/c_15'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'c'"
op|'*'
number|'15'
op|')'
op|','
string|"'bytes'"
op|':'
string|"'15'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json;swift_bytes=25'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'X-Object-Meta-Plant'"
op|':'
string|"'Ficus'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
name|'_bc_manifest_json'
op|')'
op|'}'
op|','
nl|'\n'
name|'_bc_manifest_json'
op|')'
newline|'\n'
nl|'\n'
name|'_abcd_manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/a_5'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"a"'
op|'*'
number|'5'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'5'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/manifest-bc'"
op|','
string|"'sub_slo'"
op|':'
name|'True'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'application/json;swift_bytes=25'"
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
name|'md5hex'
op|'('
string|'"b"'
op|'*'
number|'10'
op|')'
op|'+'
name|'md5hex'
op|'('
string|'"c"'
op|'*'
number|'15'
op|')'
op|')'
op|','
nl|'\n'
string|"'bytes'"
op|':'
name|'len'
op|'('
name|'_bc_manifest_json'
op|')'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/d_20'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"d"'
op|'*'
number|'20'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'20'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5'
op|'('
name|'_abcd_manifest_json'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
op|'}'
op|','
nl|'\n'
name|'_abcd_manifest_json'
op|')'
newline|'\n'
nl|'\n'
name|'_abcdefghijkl_manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/a_5'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"a"'
op|'*'
number|'5'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'5'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/b_10'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"b"'
op|'*'
number|'10'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'10'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/c_15'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"c"'
op|'*'
number|'15'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'15'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/d_20'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"d"'
op|'*'
number|'20'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'20'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/e_25'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"e"'
op|'*'
number|'25'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'25'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/f_30'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"f"'
op|'*'
number|'30'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'30'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/g_35'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"g"'
op|'*'
number|'35'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'35'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/h_40'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"h"'
op|'*'
number|'40'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'40'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/i_45'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"i"'
op|'*'
number|'45'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'45'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/j_50'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"j"'
op|'*'
number|'50'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'50'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/k_55'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"k"'
op|'*'
number|'55'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'55'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/l_60'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"l"'
op|'*'
number|'60'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'60'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcdefghijkl'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
nl|'\n'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5'
op|'('
name|'_abcdefghijkl_manifest_json'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
op|'}'
op|','
nl|'\n'
name|'_abcdefghijkl_manifest_json'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'manifest_abcd_etag'
op|'='
name|'md5hex'
op|'('
nl|'\n'
name|'md5hex'
op|'('
string|'"a"'
op|'*'
number|'5'
op|')'
op|'+'
name|'md5hex'
op|'('
name|'md5hex'
op|'('
string|'"b"'
op|'*'
number|'10'
op|')'
op|'+'
name|'md5hex'
op|'('
string|'"c"'
op|'*'
number|'15'
op|')'
op|')'
op|'+'
nl|'\n'
name|'md5hex'
op|'('
string|'"d"'
op|'*'
number|'20'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'_bc_ranges_manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/b_10'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'b'"
op|'*'
number|'10'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'10'"
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'4-7'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/b_10'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'b'"
op|'*'
number|'10'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'10'"
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'2-5'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/c_15'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'c'"
op|'*'
number|'15'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'15'"
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'0-3'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/c_15'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'c'"
op|'*'
number|'15'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'15'"
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'11-14'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'bc_ranges_etag'
op|'='
name|'md5hex'
op|'('
name|'_bc_ranges_manifest_json'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc-ranges'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json;swift_bytes=16'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'X-Object-Meta-Plant'"
op|':'
string|"'Ficus'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'self'
op|'.'
name|'bc_ranges_etag'
op|'}'
op|','
nl|'\n'
name|'_bc_ranges_manifest_json'
op|')'
newline|'\n'
nl|'\n'
name|'_abcd_ranges_manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/a_5'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"a"'
op|'*'
number|'5'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'5'"
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'0-3'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/a_5'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"a"'
op|'*'
number|'5'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'5'"
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'1-4'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/manifest-bc-ranges'"
op|','
string|"'sub_slo'"
op|':'
name|'True'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'application/json;swift_bytes=16'"
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'self'
op|'.'
name|'bc_ranges_etag'
op|','
nl|'\n'
string|"'bytes'"
op|':'
name|'len'
op|'('
name|'_bc_ranges_manifest_json'
op|')'
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'8-15'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/manifest-bc-ranges'"
op|','
string|"'sub_slo'"
op|':'
name|'True'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'application/json;swift_bytes=16'"
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'self'
op|'.'
name|'bc_ranges_etag'
op|','
nl|'\n'
string|"'bytes'"
op|':'
name|'len'
op|'('
name|'_bc_ranges_manifest_json'
op|')'
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'0-7'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/d_20'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"d"'
op|'*'
number|'20'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'20'"
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'0-3'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/d_20'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"d"'
op|'*'
number|'20'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'20'"
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'8-11'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd-ranges'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
name|'_abcd_ranges_manifest_json'
op|')'
op|'}'
op|','
nl|'\n'
name|'_abcd_ranges_manifest_json'
op|')'
newline|'\n'
nl|'\n'
name|'_abcd_subranges_manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/manifest-abcd-ranges'"
op|','
string|"'sub_slo'"
op|':'
name|'True'
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"a"'
op|'*'
number|'8'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'32'"
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'6-10'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/manifest-abcd-ranges'"
op|','
string|"'sub_slo'"
op|':'
name|'True'
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"a"'
op|'*'
number|'8'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'32'"
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'31-31'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/manifest-abcd-ranges'"
op|','
string|"'sub_slo'"
op|':'
name|'True'
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"a"'
op|'*'
number|'8'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'32'"
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'14-18'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/manifest-abcd-ranges'"
op|','
string|"'sub_slo'"
op|':'
name|'True'
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"a"'
op|'*'
number|'8'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'32'"
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'0-0'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/manifest-abcd-ranges'"
op|','
string|"'sub_slo'"
op|':'
name|'True'
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"a"'
op|'*'
number|'8'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'32'"
op|','
nl|'\n'
string|"'range'"
op|':'
string|"'22-26'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd-subranges'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
name|'_abcd_subranges_manifest_json'
op|')'
op|'}'
op|','
nl|'\n'
name|'_abcd_subranges_manifest_json'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-badjson'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'X-Object-Meta-Fish'"
op|':'
string|"'Bass'"
op|'}'
op|','
nl|'\n'
string|'"[not {json (at ++++all"'
op|')'
newline|'\n'
nl|'\n'
DECL|member|tearDown
dedent|''
name|'def'
name|'tearDown'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'unclosed_requests'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_manifest_passthrough
dedent|''
name|'def'
name|'test_get_manifest_passthrough'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-bc?multipart-manifest=get'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|','
nl|'\n'
string|"'HTTP_ACCEPT'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
nl|'\n'
op|'('
string|"'Content-Type'"
op|','
string|"'application/json; charset=utf-8'"
op|')'
name|'in'
name|'headers'
op|','
nl|'\n'
name|'headers'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'resp_data'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'body'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'ValueError'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'fail'
op|'('
string|'"Invalid JSON in manifest GET: %r"'
op|'%'
name|'body'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'resp_data'
op|','
nl|'\n'
op|'['
op|'{'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'b'"
op|'*'
number|'10'
op|')'
op|','
string|"'bytes'"
op|':'
string|"'10'"
op|','
string|"'name'"
op|':'
string|"'/gettest/b_10'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'c'"
op|'*'
number|'15'
op|')'
op|','
string|"'bytes'"
op|':'
string|"'15'"
op|','
string|"'name'"
op|':'
string|"'/gettest/c_15'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|'}'
op|']'
op|','
nl|'\n'
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_nonmanifest_passthrough
dedent|''
name|'def'
name|'test_get_nonmanifest_passthrough'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/a_5'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'aaaaa'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_manifest
dedent|''
name|'def'
name|'test_get_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-bc'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'manifest_etag'
op|'='
name|'md5hex'
op|'('
name|'md5hex'
op|'('
string|'"b"'
op|'*'
number|'10'
op|')'
op|'+'
name|'md5hex'
op|'('
string|'"c"'
op|'*'
number|'15'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'25'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Etag'"
op|']'
op|','
string|'\'"%s"\''
op|'%'
name|'manifest_etag'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'X-Object-Meta-Plant'"
op|']'
op|','
string|"'Ficus'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'bbbbbbbbbbccccccccccccccc'"
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'_'
op|','
name|'_'
op|','
name|'hdrs'
name|'in'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls_with_headers'
op|'['
number|'1'
op|':'
op|']'
op|':'
newline|'\n'
indent|'            '
name|'ua'
op|'='
name|'hdrs'
op|'.'
name|'get'
op|'('
string|'"User-Agent"'
op|','
string|'""'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|'"SLO MultipartGET"'
name|'in'
name|'ua'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertFalse'
op|'('
string|'"SLO MultipartGET SLO MultipartGET"'
name|'in'
name|'ua'
op|')'
newline|'\n'
comment|'# the first request goes through unaltered'
nl|'\n'
dedent|''
name|'first_ua'
op|'='
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls_with_headers'
op|'['
number|'0'
op|']'
op|'['
number|'2'
op|']'
op|'.'
name|'get'
op|'('
string|'"User-Agent"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertFalse'
op|'('
nl|'\n'
string|'"SLO MultipartGET"'
name|'in'
name|'first_ua'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_manifest_repeated_segments
dedent|''
name|'def'
name|'test_get_manifest_repeated_segments'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'_aabbccdd_manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/a_5'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"a"'
op|'*'
number|'5'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'5'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/a_5'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"a"'
op|'*'
number|'5'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'5'"
op|'}'
op|','
nl|'\n'
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/b_10'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"b"'
op|'*'
number|'10'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'10'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/b_10'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"b"'
op|'*'
number|'10'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'10'"
op|'}'
op|','
nl|'\n'
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/c_15'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"c"'
op|'*'
number|'15'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'15'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/c_15'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"c"'
op|'*'
number|'15'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'15'"
op|'}'
op|','
nl|'\n'
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/d_20'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"d"'
op|'*'
number|'20'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'20'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/d_20'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|'"d"'
op|'*'
number|'20'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'20'"
op|'}'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-aabbccdd'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5'
op|'('
name|'_aabbccdd_manifest_json'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
op|'}'
op|','
nl|'\n'
name|'_aabbccdd_manifest_json'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-aabbccdd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
op|'('
nl|'\n'
string|"'aaaaaaaaaabbbbbbbbbbbbbbbbbbbbcccccccccccccccccccccccccccccc'"
nl|'\n'
string|"'dddddddddddddddddddddddddddddddddddddddd'"
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-aabbccdd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/d_20?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'ranges'
op|'='
op|'['
name|'c'
op|'['
number|'2'
op|']'
op|'.'
name|'get'
op|'('
string|"'Range'"
op|')'
name|'for'
name|'c'
name|'in'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls_with_headers'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'ranges'
op|','
op|'['
nl|'\n'
name|'None'
op|','
nl|'\n'
string|"'bytes=0-4,0-4'"
op|','
nl|'\n'
string|"'bytes=0-9,0-9'"
op|','
nl|'\n'
string|"'bytes=0-14,0-14'"
op|','
nl|'\n'
string|"'bytes=0-19,0-19'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_manifest_ratelimiting
dedent|''
name|'def'
name|'test_get_manifest_ratelimiting'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcdefghijkl'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
nl|'\n'
name|'the_time'
op|'='
op|'['
name|'time'
op|'.'
name|'time'
op|'('
op|')'
op|']'
newline|'\n'
name|'sleeps'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
DECL|function|mock_time
name|'def'
name|'mock_time'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'the_time'
op|'['
number|'0'
op|']'
newline|'\n'
nl|'\n'
DECL|function|mock_sleep
dedent|''
name|'def'
name|'mock_sleep'
op|'('
name|'duration'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'sleeps'
op|'.'
name|'append'
op|'('
name|'duration'
op|')'
newline|'\n'
name|'the_time'
op|'['
number|'0'
op|']'
op|'+='
name|'duration'
newline|'\n'
nl|'\n'
dedent|''
name|'with'
name|'patch'
op|'('
string|"'time.time'"
op|','
name|'mock_time'
op|')'
op|','
name|'patch'
op|'('
string|"'eventlet.sleep'"
op|','
name|'mock_sleep'
op|')'
op|','
name|'patch'
op|'.'
name|'object'
op|'('
name|'self'
op|'.'
name|'slo'
op|','
string|"'rate_limit_under_size'"
op|','
number|'999999999'
op|')'
op|','
name|'patch'
op|'.'
name|'object'
op|'('
name|'self'
op|'.'
name|'slo'
op|','
string|"'rate_limit_after_segment'"
op|','
number|'0'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
comment|'# sanity check'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'sleeps'
op|','
op|'['
number|'2.0'
op|','
number|'2.0'
op|','
number|'2.0'
op|','
number|'2.0'
op|','
number|'2.0'
op|']'
op|')'
newline|'\n'
nl|'\n'
comment|"# give the client the first 4 segments without ratelimiting; we'll"
nl|'\n'
comment|'# sleep less'
nl|'\n'
name|'del'
name|'sleeps'
op|'['
op|':'
op|']'
newline|'\n'
name|'with'
name|'patch'
op|'('
string|"'time.time'"
op|','
name|'mock_time'
op|')'
op|','
name|'patch'
op|'('
string|"'eventlet.sleep'"
op|','
name|'mock_sleep'
op|')'
op|','
name|'patch'
op|'.'
name|'object'
op|'('
name|'self'
op|'.'
name|'slo'
op|','
string|"'rate_limit_under_size'"
op|','
number|'999999999'
op|')'
op|','
name|'patch'
op|'.'
name|'object'
op|'('
name|'self'
op|'.'
name|'slo'
op|','
string|"'rate_limit_after_segment'"
op|','
number|'4'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
comment|'# sanity check'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'sleeps'
op|','
op|'['
number|'2.0'
op|','
number|'2.0'
op|','
number|'2.0'
op|']'
op|')'
newline|'\n'
nl|'\n'
comment|'# ratelimit segments under 35 bytes; this affects a-f'
nl|'\n'
name|'del'
name|'sleeps'
op|'['
op|':'
op|']'
newline|'\n'
name|'with'
name|'patch'
op|'('
string|"'time.time'"
op|','
name|'mock_time'
op|')'
op|','
name|'patch'
op|'('
string|"'eventlet.sleep'"
op|','
name|'mock_sleep'
op|')'
op|','
name|'patch'
op|'.'
name|'object'
op|'('
name|'self'
op|'.'
name|'slo'
op|','
string|"'rate_limit_under_size'"
op|','
number|'35'
op|')'
op|','
name|'patch'
op|'.'
name|'object'
op|'('
name|'self'
op|'.'
name|'slo'
op|','
string|"'rate_limit_after_segment'"
op|','
number|'0'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
comment|'# sanity check'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'sleeps'
op|','
op|'['
number|'2.0'
op|','
number|'2.0'
op|']'
op|')'
newline|'\n'
nl|'\n'
comment|'# ratelimit segments under 36 bytes; this now affects a-g, netting'
nl|'\n'
comment|'# us one more sleep than before'
nl|'\n'
name|'del'
name|'sleeps'
op|'['
op|':'
op|']'
newline|'\n'
name|'with'
name|'patch'
op|'('
string|"'time.time'"
op|','
name|'mock_time'
op|')'
op|','
name|'patch'
op|'('
string|"'eventlet.sleep'"
op|','
name|'mock_sleep'
op|')'
op|','
name|'patch'
op|'.'
name|'object'
op|'('
name|'self'
op|'.'
name|'slo'
op|','
string|"'rate_limit_under_size'"
op|','
number|'36'
op|')'
op|','
name|'patch'
op|'.'
name|'object'
op|'('
name|'self'
op|'.'
name|'slo'
op|','
string|"'rate_limit_after_segment'"
op|','
number|'0'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
comment|'# sanity check'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'sleeps'
op|','
op|'['
number|'2.0'
op|','
number|'2.0'
op|','
number|'2.0'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_if_none_match_matches
dedent|''
name|'def'
name|'test_if_none_match_matches'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'If-None-Match'"
op|':'
name|'self'
op|'.'
name|'manifest_abcd_etag'
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'304 Not Modified'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'0'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"''"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_if_none_match_does_not_match
dedent|''
name|'def'
name|'test_if_none_match_does_not_match'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'If-None-Match'"
op|':'
string|'"not-%s"'
op|'%'
name|'self'
op|'.'
name|'manifest_abcd_etag'
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'body'
op|','
string|"'aaaaabbbbbbbbbbcccccccccccccccdddddddddddddddddddd'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_if_match_matches
dedent|''
name|'def'
name|'test_if_match_matches'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'If-Match'"
op|':'
name|'self'
op|'.'
name|'manifest_abcd_etag'
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'body'
op|','
string|"'aaaaabbbbbbbbbbcccccccccccccccdddddddddddddddddddd'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_if_match_does_not_match
dedent|''
name|'def'
name|'test_if_match_does_not_match'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'If-Match'"
op|':'
string|'"not-%s"'
op|'%'
name|'self'
op|'.'
name|'manifest_abcd_etag'
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'412 Precondition Failed'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'0'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"''"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_if_match_matches_and_range
dedent|''
name|'def'
name|'test_if_match_matches_and_range'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'If-Match'"
op|':'
name|'self'
op|'.'
name|'manifest_abcd_etag'
op|','
nl|'\n'
string|"'Range'"
op|':'
string|"'bytes=3-6'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'206 Partial Content'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'4'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'aabb'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_manifest_with_submanifest
dedent|''
name|'def'
name|'test_get_manifest_with_submanifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'50'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Etag'"
op|']'
op|','
string|'\'"%s"\''
op|'%'
name|'self'
op|'.'
name|'manifest_abcd_etag'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'body'
op|','
string|"'aaaaabbbbbbbbbbcccccccccccccccdddddddddddddddddddd'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_range_get_manifest
dedent|''
name|'def'
name|'test_range_get_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Range'"
op|':'
string|"'bytes=3-17'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'206 Partial Content'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'15'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Etag'"
name|'not'
name|'in'
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'aabbbbbbbbbbccc'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'ranges'
op|'='
op|'['
name|'c'
op|'['
number|'2'
op|']'
op|'.'
name|'get'
op|'('
string|"'Range'"
op|')'
name|'for'
name|'c'
name|'in'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls_with_headers'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'ranges'
op|','
op|'['
nl|'\n'
string|"'bytes=3-17'"
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
string|"'bytes=3-'"
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
string|"'bytes=0-2'"
op|']'
op|')'
newline|'\n'
comment|'# we set swift.source for everything but the first request'
nl|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|'['
number|'1'
op|':'
op|']'
op|','
nl|'\n'
op|'['
string|"'SLO'"
op|']'
op|'*'
op|'('
name|'len'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|')'
op|'-'
number|'1'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_range_get_includes_whole_manifest
dedent|''
name|'def'
name|'test_range_get_includes_whole_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# If the first range GET results in retrieval of the entire manifest'
nl|'\n'
comment|'# body (which we can detect by looking at Content-Range), then we'
nl|'\n'
comment|'# should not go make a second, non-ranged request just to retrieve the'
nl|'\n'
comment|'# same bytes again.'
nl|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Range'"
op|':'
string|"'bytes=0-999999999'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'206 Partial Content'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'body'
op|','
string|"'aaaaabbbbbbbbbbcccccccccccccccdddddddddddddddddddd'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/d_20?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_range_get_beyond_manifest
dedent|''
name|'def'
name|'test_range_get_beyond_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'big'
op|'='
string|"'e'"
op|'*'
number|'1024'
op|'*'
number|'1024'
newline|'\n'
name|'big_etag'
op|'='
name|'md5hex'
op|'('
name|'big'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/big_seg'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/foo'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'big_etag'
op|'}'
op|','
name|'big'
op|')'
newline|'\n'
name|'big_manifest'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
nl|'\n'
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/big_seg'"
op|','
string|"'hash'"
op|':'
name|'big_etag'
op|','
nl|'\n'
string|"'bytes'"
op|':'
number|'1024'
op|'*'
number|'1024'
op|','
string|"'content_type'"
op|':'
string|"'application/foo'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/big_manifest'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/octet-stream'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5'
op|'('
name|'big_manifest'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
op|'}'
op|','
nl|'\n'
name|'big_manifest'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/big_manifest'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Range'"
op|':'
string|"'bytes=100000-199999'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'206 Partial Content'"
op|')'
newline|'\n'
name|'count_e'
op|'='
name|'sum'
op|'('
number|'1'
name|'if'
name|'x'
op|'=='
string|"'e'"
name|'else'
number|'0'
name|'for'
name|'x'
name|'in'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'count_e'
op|','
number|'100000'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'body'
op|')'
op|'-'
name|'count_e'
op|','
number|'0'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
comment|'# has Range header, gets 416'
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/big_manifest'"
op|')'
op|','
nl|'\n'
comment|'# retry the first one'
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/big_manifest'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
nl|'\n'
string|"'/v1/AUTH_test/gettest/big_seg?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_range_get_bogus_content_range
dedent|''
name|'def'
name|'test_range_get_bogus_content_range'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# Just a little paranoia; Swift currently sends back valid'
nl|'\n'
comment|'# Content-Range headers, but if somehow someone sneaks an invalid one'
nl|'\n'
comment|"# in there, we'll ignore it."
nl|'\n'
nl|'\n'
DECL|function|content_range_breaker_factory
indent|'        '
name|'def'
name|'content_range_breaker_factory'
op|'('
name|'app'
op|')'
op|':'
newline|'\n'
DECL|function|content_range_breaker
indent|'            '
name|'def'
name|'content_range_breaker'
op|'('
name|'env'
op|','
name|'start_response'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'req'
op|'='
name|'swob'
op|'.'
name|'Request'
op|'('
name|'env'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'app'
op|')'
newline|'\n'
name|'resp'
op|'.'
name|'headers'
op|'['
string|"'Content-Range'"
op|']'
op|'='
string|"'triscuits'"
newline|'\n'
name|'return'
name|'resp'
op|'('
name|'env'
op|','
name|'start_response'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'content_range_breaker'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'slo'
op|'='
name|'slo'
op|'.'
name|'filter_factory'
op|'('
op|'{'
op|'}'
op|')'
op|'('
nl|'\n'
name|'content_range_breaker_factory'
op|'('
name|'self'
op|'.'
name|'app'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Range'"
op|':'
string|"'bytes=0-999999999'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'206 Partial Content'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'body'
op|','
string|"'aaaaabbbbbbbbbbcccccccccccccccdddddddddddddddddddd'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/d_20?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_range_get_manifest_on_segment_boundaries
dedent|''
name|'def'
name|'test_range_get_manifest_on_segment_boundaries'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Range'"
op|':'
string|"'bytes=5-29'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'206 Partial Content'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'25'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Etag'"
name|'not'
name|'in'
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'bbbbbbbbbbccccccccccccccc'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'headers'
op|'='
op|'['
name|'c'
op|'['
number|'2'
op|']'
name|'for'
name|'c'
name|'in'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls_with_headers'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
number|'0'
op|']'
op|'.'
name|'get'
op|'('
string|"'Range'"
op|')'
op|','
string|"'bytes=5-29'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
number|'1'
op|']'
op|'.'
name|'get'
op|'('
string|"'Range'"
op|')'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
number|'2'
op|']'
op|'.'
name|'get'
op|'('
string|"'Range'"
op|')'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
number|'3'
op|']'
op|'.'
name|'get'
op|'('
string|"'Range'"
op|')'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
number|'4'
op|']'
op|'.'
name|'get'
op|'('
string|"'Range'"
op|')'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_range_get_manifest_first_byte
dedent|''
name|'def'
name|'test_range_get_manifest_first_byte'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Range'"
op|':'
string|"'bytes=0-0'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'206 Partial Content'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'1'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'a'"
op|')'
newline|'\n'
nl|'\n'
comment|"# Make sure we don't get any objects we don't need, including"
nl|'\n'
comment|'# submanifests.'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_range_get_manifest_sub_slo
dedent|''
name|'def'
name|'test_range_get_manifest_sub_slo'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Range'"
op|':'
string|"'bytes=25-30'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'206 Partial Content'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'6'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'cccccd'"
op|')'
newline|'\n'
nl|'\n'
comment|"# Make sure we don't get any objects we don't need, including"
nl|'\n'
comment|'# submanifests.'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/d_20?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_range_get_manifest_overlapping_end
dedent|''
name|'def'
name|'test_range_get_manifest_overlapping_end'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Range'"
op|':'
string|"'bytes=45-55'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'206 Partial Content'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'5'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'ddddd'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_range_get_manifest_unsatisfiable
dedent|''
name|'def'
name|'test_range_get_manifest_unsatisfiable'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Range'"
op|':'
string|"'bytes=100-200'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'416 Requested Range Not Satisfiable'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_multi_range_get_manifest
dedent|''
name|'def'
name|'test_multi_range_get_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|"# SLO doesn't support multi-range GETs. The way that you express"
nl|'\n'
comment|'# "unsupported" in HTTP is to return a 200 and the whole entity.'
nl|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Range'"
op|':'
string|"'bytes=0-0,2-2'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'50'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'body'
op|','
string|"'aaaaabbbbbbbbbbcccccccccccccccdddddddddddddddddddd'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_segment_with_non_ascii_path
dedent|''
name|'def'
name|'test_get_segment_with_non_ascii_path'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'segment_body'
op|'='
string|'u"a m\xc3\xb8\xc3\xb8se once bit my sister"'
op|'.'
name|'encode'
op|'('
string|'"utf-8"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"u'/v1/AUTH_test/\xc3\xbcnicode/\xc3\xb6bject-segment'"
op|'.'
name|'encode'
op|'('
string|"'utf-8'"
op|')'
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
name|'str'
op|'('
name|'len'
op|'('
name|'segment_body'
op|')'
op|')'
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
name|'segment_body'
op|')'
op|'}'
op|','
nl|'\n'
name|'segment_body'
op|')'
newline|'\n'
nl|'\n'
name|'manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"u'/\xc3\xbcnicode/\xc3\xb6bject-segment'"
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
name|'segment_body'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
nl|'\n'
string|"'bytes'"
op|':'
name|'len'
op|'('
name|'segment_body'
op|')'
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"u'/v1/AUTH_test/\xc3\xbcnicode/manifest'"
op|'.'
name|'encode'
op|'('
string|"'utf-8'"
op|')'
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'Content-Length'"
op|':'
name|'str'
op|'('
name|'len'
op|'('
name|'manifest_json'
op|')'
op|')'
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|'}'
op|','
nl|'\n'
name|'manifest_json'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/\xc3\xbcnicode/manifest'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
name|'segment_body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_range_manifest
dedent|''
name|'def'
name|'test_get_range_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd-ranges'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'32'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Type'"
op|']'
op|','
string|"'application/json'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'aaaaaaaaccccccccbbbbbbbbdddddddd'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/d_20?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'ranges'
op|'='
op|'['
name|'c'
op|'['
number|'2'
op|']'
op|'.'
name|'get'
op|'('
string|"'Range'"
op|')'
name|'for'
name|'c'
name|'in'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls_with_headers'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'ranges'
op|','
op|'['
nl|'\n'
name|'None'
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
string|"'bytes=0-3,1-'"
op|','
nl|'\n'
string|"'bytes=0-3,11-'"
op|','
nl|'\n'
string|"'bytes=4-7,2-5'"
op|','
nl|'\n'
string|"'bytes=0-3,8-11'"
op|']'
op|')'
newline|'\n'
comment|'# we set swift.source for everything but the first request'
nl|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|'['
number|'1'
op|':'
op|']'
op|','
nl|'\n'
op|'['
string|"'SLO'"
op|']'
op|'*'
op|'('
name|'len'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|')'
op|'-'
number|'1'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'md5hex'
op|'('
string|"''"
op|'.'
name|'join'
op|'('
op|'['
nl|'\n'
name|'md5hex'
op|'('
string|"'a'"
op|'*'
number|'5'
op|')'
op|','
string|"':0-3;'"
op|','
nl|'\n'
name|'md5hex'
op|'('
string|"'a'"
op|'*'
number|'5'
op|')'
op|','
string|"':1-4;'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'bc_ranges_etag'
op|','
string|"':8-15;'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'bc_ranges_etag'
op|','
string|"':0-7;'"
op|','
nl|'\n'
name|'md5hex'
op|'('
string|"'d'"
op|'*'
number|'20'
op|')'
op|','
string|"':0-3;'"
op|','
nl|'\n'
name|'md5hex'
op|'('
string|"'d'"
op|'*'
number|'20'
op|')'
op|','
string|"':8-11;'"
op|','
nl|'\n'
op|']'
op|')'
op|')'
op|','
name|'headers'
op|'['
string|"'Etag'"
op|']'
op|'.'
name|'strip'
op|'('
string|'\'"\''
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_subrange_manifest
dedent|''
name|'def'
name|'test_get_subrange_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd-subranges'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'17'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Type'"
op|']'
op|','
string|"'application/json'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'aacccdccbbbabbddd'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd-subranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/d_20?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/d_20?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'ranges'
op|'='
op|'['
name|'c'
op|'['
number|'2'
op|']'
op|'.'
name|'get'
op|'('
string|"'Range'"
op|')'
name|'for'
name|'c'
name|'in'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls_with_headers'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'ranges'
op|','
op|'['
nl|'\n'
name|'None'
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
string|"'bytes=3-'"
op|','
nl|'\n'
string|"'bytes=0-2'"
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
string|"'bytes=11-11'"
op|','
nl|'\n'
string|"'bytes=13-'"
op|','
nl|'\n'
string|"'bytes=4-6'"
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
string|"'bytes=0-0'"
op|','
nl|'\n'
string|"'bytes=4-5'"
op|','
nl|'\n'
string|"'bytes=0-2'"
op|']'
op|')'
newline|'\n'
comment|'# we set swift.source for everything but the first request'
nl|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|'['
number|'1'
op|':'
op|']'
op|','
nl|'\n'
op|'['
string|"'SLO'"
op|']'
op|'*'
op|'('
name|'len'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|')'
op|'-'
number|'1'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_range_get_range_manifest
dedent|''
name|'def'
name|'test_range_get_range_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd-ranges'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Range'"
op|':'
string|"'bytes=7-26'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'206 Partial Content'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'20'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Type'"
op|']'
op|','
string|"'application/json'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertNotIn'
op|'('
string|"'Etag'"
op|','
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'accccccccbbbbbbbbddd'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/d_20?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'ranges'
op|'='
op|'['
name|'c'
op|'['
number|'2'
op|']'
op|'.'
name|'get'
op|'('
string|"'Range'"
op|')'
name|'for'
name|'c'
name|'in'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls_with_headers'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'ranges'
op|','
op|'['
nl|'\n'
string|"'bytes=7-26'"
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
string|"'bytes=4-'"
op|','
nl|'\n'
string|"'bytes=0-3,11-'"
op|','
nl|'\n'
string|"'bytes=4-7,2-5'"
op|','
nl|'\n'
string|"'bytes=0-2'"
op|']'
op|')'
newline|'\n'
comment|'# we set swift.source for everything but the first request'
nl|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|'['
number|'1'
op|':'
op|']'
op|','
nl|'\n'
op|'['
string|"'SLO'"
op|']'
op|'*'
op|'('
name|'len'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|')'
op|'-'
number|'1'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_range_get_subrange_manifest
dedent|''
name|'def'
name|'test_range_get_subrange_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd-subranges'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Range'"
op|':'
string|"'bytes=4-12'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'206 Partial Content'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'9'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Type'"
op|']'
op|','
string|"'application/json'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'cdccbbbab'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd-subranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd-subranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/d_20?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'ranges'
op|'='
op|'['
name|'c'
op|'['
number|'2'
op|']'
op|'.'
name|'get'
op|'('
string|"'Range'"
op|')'
name|'for'
name|'c'
name|'in'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls_with_headers'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'ranges'
op|','
op|'['
nl|'\n'
string|"'bytes=4-12'"
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
string|"'bytes=2-2'"
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
string|"'bytes=11-11'"
op|','
nl|'\n'
string|"'bytes=13-'"
op|','
nl|'\n'
string|"'bytes=4-6'"
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
string|"'bytes=0-0'"
op|','
nl|'\n'
string|"'bytes=4-4'"
op|']'
op|')'
newline|'\n'
comment|'# we set swift.source for everything but the first request'
nl|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|'['
number|'1'
op|':'
op|']'
op|','
nl|'\n'
op|'['
string|"'SLO'"
op|']'
op|'*'
op|'('
name|'len'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|')'
op|'-'
number|'1'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_range_get_includes_whole_range_manifest
dedent|''
name|'def'
name|'test_range_get_includes_whole_range_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# If the first range GET results in retrieval of the entire manifest'
nl|'\n'
comment|'# body (which we can detect by looking at Content-Range), then we'
nl|'\n'
comment|'# should not go make a second, non-ranged request just to retrieve the'
nl|'\n'
comment|'# same bytes again.'
nl|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd-ranges'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Range'"
op|':'
string|"'bytes=0-999999999'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'206 Partial Content'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'32'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Type'"
op|']'
op|','
string|"'application/json'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'aaaaaaaaccccccccbbbbbbbbdddddddd'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
nl|'\n'
op|'['
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc-ranges'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/d_20?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'ranges'
op|'='
op|'['
name|'c'
op|'['
number|'2'
op|']'
op|'.'
name|'get'
op|'('
string|"'Range'"
op|')'
name|'for'
name|'c'
name|'in'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls_with_headers'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'ranges'
op|','
op|'['
nl|'\n'
string|"'bytes=0-999999999'"
op|','
nl|'\n'
name|'None'
op|','
nl|'\n'
string|"'bytes=0-3,1-'"
op|','
nl|'\n'
string|"'bytes=0-3,11-'"
op|','
nl|'\n'
string|"'bytes=4-7,2-5'"
op|','
nl|'\n'
string|"'bytes=0-3,8-11'"
op|']'
op|')'
newline|'\n'
comment|'# we set swift.source for everything but the first request'
nl|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|'['
number|'1'
op|':'
op|']'
op|','
nl|'\n'
op|'['
string|"'SLO'"
op|']'
op|'*'
op|'('
name|'len'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'swift_sources'
op|')'
op|'-'
number|'1'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_multi_range_get_range_manifest
dedent|''
name|'def'
name|'test_multi_range_get_range_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|"# SLO doesn't support multi-range GETs. The way that you express"
nl|'\n'
comment|'# "unsupported" in HTTP is to return a 200 and the whole entity.'
nl|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd-ranges'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'Range'"
op|':'
string|"'bytes=0-0,2-2'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Type'"
op|']'
op|','
string|"'application/json'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'aaaaaaaaccccccccbbbbbbbbdddddddd'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertNotIn'
op|'('
string|"'Transfer-Encoding'"
op|','
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertNotIn'
op|'('
string|"'Content-Range'"
op|','
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'32'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_bogus_manifest
dedent|''
name|'def'
name|'test_get_bogus_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-badjson'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'0'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'X-Object-Meta-Fish'"
op|']'
op|','
string|"'Bass'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"''"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_generator_closure
dedent|''
name|'def'
name|'test_generator_closure'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# Test that the SLO WSGI iterable closes its internal .app_iter when'
nl|'\n'
comment|'# it receives a close() message.'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# This is sufficient to fix a memory leak. The memory leak arises'
nl|'\n'
comment|'# due to cyclic references involving a running generator; a running'
nl|'\n'
comment|'# generator sometimes preventes the GC from collecting it in the'
nl|'\n'
comment|'# same way that an object with a defined __del__ does.'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# There are other ways to break the cycle and fix the memory leak as'
nl|'\n'
comment|'# well; calling .close() on the generator is sufficient, but not'
nl|'\n'
comment|'# necessary. However, having this test is better than nothing for'
nl|'\n'
comment|'# preventing regressions.'
nl|'\n'
indent|'        '
name|'leaks'
op|'='
op|'['
number|'0'
op|']'
newline|'\n'
nl|'\n'
DECL|class|LeakTracker
name|'class'
name|'LeakTracker'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'inner_iter'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'leaks'
op|'['
number|'0'
op|']'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'inner_iter'
op|'='
name|'iter'
op|'('
name|'inner_iter'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__iter__
dedent|''
name|'def'
name|'__iter__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'self'
newline|'\n'
nl|'\n'
DECL|member|next
dedent|''
name|'def'
name|'next'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'next'
op|'('
name|'self'
op|'.'
name|'inner_iter'
op|')'
newline|'\n'
nl|'\n'
DECL|member|close
dedent|''
name|'def'
name|'close'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'leaks'
op|'['
number|'0'
op|']'
op|'-='
number|'1'
newline|'\n'
name|'close_if_possible'
op|'('
name|'self'
op|'.'
name|'inner_iter'
op|')'
newline|'\n'
nl|'\n'
DECL|class|LeakTrackingSegmentedIterable
dedent|''
dedent|''
name|'class'
name|'LeakTrackingSegmentedIterable'
op|'('
name|'slo'
op|'.'
name|'SegmentedIterable'
op|')'
op|':'
newline|'\n'
DECL|member|_internal_iter
indent|'            '
name|'def'
name|'_internal_iter'
op|'('
name|'self'
op|','
op|'*'
name|'a'
op|','
op|'**'
name|'kw'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'it'
op|'='
name|'super'
op|'('
nl|'\n'
name|'LeakTrackingSegmentedIterable'
op|','
name|'self'
op|')'
op|'.'
name|'_internal_iter'
op|'('
nl|'\n'
op|'*'
name|'a'
op|','
op|'**'
name|'kw'
op|')'
newline|'\n'
name|'return'
name|'LeakTracker'
op|'('
name|'it'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'status'
op|'='
op|'['
name|'None'
op|']'
newline|'\n'
name|'headers'
op|'='
op|'['
name|'None'
op|']'
newline|'\n'
nl|'\n'
DECL|function|start_response
name|'def'
name|'start_response'
op|'('
name|'s'
op|','
name|'h'
op|','
name|'ei'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'status'
op|'['
number|'0'
op|']'
op|'='
name|'s'
newline|'\n'
name|'headers'
op|'['
number|'0'
op|']'
op|'='
name|'h'
newline|'\n'
nl|'\n'
dedent|''
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|','
nl|'\n'
string|"'HTTP_ACCEPT'"
op|':'
string|"'application/json'"
op|'}'
op|')'
newline|'\n'
nl|'\n'
comment|"# can't self.call_slo() here since we don't want to consume the"
nl|'\n'
comment|'# whole body'
nl|'\n'
name|'with'
name|'patch'
op|'.'
name|'object'
op|'('
name|'slo'
op|','
string|"'SegmentedIterable'"
op|','
nl|'\n'
name|'LeakTrackingSegmentedIterable'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'app_resp'
op|'='
name|'self'
op|'.'
name|'slo'
op|'('
name|'req'
op|'.'
name|'environ'
op|','
name|'start_response'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|'['
number|'0'
op|']'
op|','
string|"'200 OK'"
op|')'
comment|'# sanity check'
newline|'\n'
name|'body_iter'
op|'='
name|'iter'
op|'('
name|'app_resp'
op|')'
newline|'\n'
name|'chunk'
op|'='
name|'next'
op|'('
name|'body_iter'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'chunk'
op|','
string|"'aaaaa'"
op|')'
comment|'# sanity check'
newline|'\n'
nl|'\n'
name|'app_resp'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'0'
op|','
name|'leaks'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_head_manifest_is_efficient
dedent|''
name|'def'
name|'test_head_manifest_is_efficient'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'HEAD'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|','
string|"'50'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'headers'
op|'['
string|"'Etag'"
op|']'
op|','
string|'\'"%s"\''
op|'%'
name|'self'
op|'.'
name|'manifest_abcd_etag'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"''"
op|')'
newline|'\n'
comment|'# Note the lack of recursive descent into manifest-bc. We know the'
nl|'\n'
comment|"# content-length from the outer manifest, so there's no need for any"
nl|'\n'
comment|'# submanifest fetching here, but a na\xc3\xafve implementation might do it'
nl|'\n'
comment|'# anyway.'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
op|'('
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_recursion_limit
dedent|''
name|'def'
name|'test_recursion_limit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# man1 points to obj1 and man2, man2 points to obj2 and man3...'
nl|'\n'
indent|'        '
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
number|'20'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/obj%d'"
op|'%'
name|'i'
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'text/plain'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'body%02d'"
op|'%'
name|'i'
op|')'
op|'}'
op|','
nl|'\n'
string|"'body%02d'"
op|'%'
name|'i'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/obj20'"
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'body20'"
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
nl|'\n'
string|"'bytes'"
op|':'
string|"'6'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/man%d'"
op|'%'
name|'i'
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
string|"'man%d'"
op|'%'
name|'i'
op|'}'
op|','
nl|'\n'
name|'manifest_json'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
number|'19'
op|','
number|'0'
op|','
op|'-'
number|'1'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'manifest_data'
op|'='
op|'['
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/obj%d'"
op|'%'
name|'i'
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'body%02d'"
op|'%'
name|'i'
op|')'
op|','
nl|'\n'
string|"'bytes'"
op|':'
string|"'6'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/man%d'"
op|'%'
op|'('
name|'i'
op|'+'
number|'1'
op|')'
op|','
nl|'\n'
string|"'hash'"
op|':'
string|"'man%d'"
op|'%'
op|'('
name|'i'
op|'+'
number|'1'
op|')'
op|','
nl|'\n'
string|"'sub_slo'"
op|':'
name|'True'
op|','
nl|'\n'
string|"'bytes'"
op|':'
name|'len'
op|'('
name|'manifest_json'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
nl|'\n'
string|"'application/json;swift_bytes=%d'"
op|'%'
op|'('
op|'('
number|'21'
op|'-'
name|'i'
op|')'
op|'*'
number|'6'
op|')'
op|'}'
op|']'
newline|'\n'
nl|'\n'
name|'manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
name|'manifest_data'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/man%d'"
op|'%'
name|'i'
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
string|"'man%d'"
op|'%'
name|'i'
op|'}'
op|','
nl|'\n'
name|'manifest_json'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/man1'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|','
name|'exc'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|','
name|'expect_exception'
op|'='
name|'True'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'exc'
op|','
name|'ListingIterError'
op|')'
newline|'\n'
comment|"# we don't know at header-sending time that things are going to go"
nl|'\n'
comment|'# wrong, so we end up with a 200 and a truncated body'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
op|'('
string|"'body01body02body03body04body05'"
op|'+'
nl|'\n'
string|"'body06body07body08body09body10'"
op|')'
op|')'
newline|'\n'
comment|"# make sure we didn't keep asking for segments"
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'call_count'
op|','
number|'20'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_sub_slo_recursion
dedent|''
name|'def'
name|'test_sub_slo_recursion'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# man1 points to man2 and obj1, man2 points to man3 and obj2...'
nl|'\n'
indent|'        '
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
number|'11'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/obj%d'"
op|'%'
name|'i'
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'text/plain'"
op|','
nl|'\n'
string|"'Content-Length'"
op|':'
string|"'6'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'body%02d'"
op|'%'
name|'i'
op|')'
op|'}'
op|','
nl|'\n'
string|"'body%02d'"
op|'%'
name|'i'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/obj%d'"
op|'%'
name|'i'
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'body%2d'"
op|'%'
name|'i'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
nl|'\n'
string|"'bytes'"
op|':'
string|"'6'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/man%d'"
op|'%'
name|'i'
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
string|"'man%d'"
op|'%'
name|'i'
op|'}'
op|','
nl|'\n'
name|'manifest_json'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/gettest/obj%d'"
op|'%'
name|'i'
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'6'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'body%2d'"
op|'%'
name|'i'
op|')'
op|'}'
op|','
nl|'\n'
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
number|'9'
op|','
number|'0'
op|','
op|'-'
number|'1'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'manifest_data'
op|'='
op|'['
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/man%d'"
op|'%'
op|'('
name|'i'
op|'+'
number|'1'
op|')'
op|','
nl|'\n'
string|"'hash'"
op|':'
string|"'man%d'"
op|'%'
op|'('
name|'i'
op|'+'
number|'1'
op|')'
op|','
nl|'\n'
string|"'sub_slo'"
op|':'
name|'True'
op|','
nl|'\n'
string|"'bytes'"
op|':'
name|'len'
op|'('
name|'manifest_json'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
nl|'\n'
string|"'application/json;swift_bytes=%d'"
op|'%'
op|'('
op|'('
number|'10'
op|'-'
name|'i'
op|')'
op|'*'
number|'6'
op|')'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/obj%d'"
op|'%'
name|'i'
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'body%02d'"
op|'%'
name|'i'
op|')'
op|','
nl|'\n'
string|"'bytes'"
op|':'
string|"'6'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|'}'
op|']'
newline|'\n'
nl|'\n'
name|'manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
name|'manifest_data'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/man%d'"
op|'%'
name|'i'
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
string|"'man%d'"
op|'%'
name|'i'
op|'}'
op|','
nl|'\n'
name|'manifest_json'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/man1'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
op|'('
string|"'body10body09body08body07body06'"
op|'+'
nl|'\n'
string|"'body05body04body03body02body01'"
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'call_count'
op|','
number|'20'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_sub_slo_recursion_limit
dedent|''
name|'def'
name|'test_sub_slo_recursion_limit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# man1 points to man2 and obj1, man2 points to man3 and obj2...'
nl|'\n'
indent|'        '
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
number|'12'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/obj%d'"
op|'%'
name|'i'
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
nl|'\n'
op|'{'
string|"'Content-Type'"
op|':'
string|"'text/plain'"
op|','
nl|'\n'
string|"'Content-Length'"
op|':'
string|"'6'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'body%02d'"
op|'%'
name|'i'
op|')'
op|'}'
op|','
string|"'body%02d'"
op|'%'
name|'i'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/obj%d'"
op|'%'
name|'i'
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'body%2d'"
op|'%'
name|'i'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
nl|'\n'
string|"'bytes'"
op|':'
string|"'6'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/man%d'"
op|'%'
name|'i'
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
string|"'man%d'"
op|'%'
name|'i'
op|'}'
op|','
nl|'\n'
name|'manifest_json'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'HEAD'"
op|','
string|"'/v1/AUTH_test/gettest/obj%d'"
op|'%'
name|'i'
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Length'"
op|':'
string|"'6'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
name|'md5hex'
op|'('
string|"'body%2d'"
op|'%'
name|'i'
op|')'
op|'}'
op|','
nl|'\n'
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
number|'11'
op|','
number|'0'
op|','
op|'-'
number|'1'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'manifest_data'
op|'='
op|'['
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/man%d'"
op|'%'
op|'('
name|'i'
op|'+'
number|'1'
op|')'
op|','
nl|'\n'
string|"'hash'"
op|':'
string|"'man%d'"
op|'%'
op|'('
name|'i'
op|'+'
number|'1'
op|')'
op|','
nl|'\n'
string|"'sub_slo'"
op|':'
name|'True'
op|','
nl|'\n'
string|"'bytes'"
op|':'
name|'len'
op|'('
name|'manifest_json'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
nl|'\n'
string|"'application/json;swift_bytes=%d'"
op|'%'
op|'('
op|'('
number|'12'
op|'-'
name|'i'
op|')'
op|'*'
number|'6'
op|')'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/obj%d'"
op|'%'
name|'i'
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'body%02d'"
op|'%'
name|'i'
op|')'
op|','
nl|'\n'
string|"'bytes'"
op|':'
string|"'6'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|'}'
op|']'
newline|'\n'
name|'manifest_json'
op|'='
name|'json'
op|'.'
name|'dumps'
op|'('
name|'manifest_data'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/man%d'"
op|'%'
name|'i'
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
nl|'\n'
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'Etag'"
op|':'
string|"'man%d'"
op|'%'
name|'i'
op|'}'
op|','
nl|'\n'
name|'manifest_json'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/man1'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'409 Conflict'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'call_count'
op|','
number|'10'
op|')'
newline|'\n'
name|'error_lines'
op|'='
name|'self'
op|'.'
name|'slo'
op|'.'
name|'logger'
op|'.'
name|'get_lines_for_level'
op|'('
string|"'error'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'error_lines'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'error_lines'
op|'['
number|'0'
op|']'
op|'.'
name|'startswith'
op|'('
nl|'\n'
string|"'ERROR: An error occurred while retrieving segments'"
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_with_if_modified_since
dedent|''
name|'def'
name|'test_get_with_if_modified_since'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|"# It's important not to pass the If-[Un]Modified-Since header to the"
nl|'\n'
comment|'# proxy for segment or submanifest GET requests, as it may result in'
nl|'\n'
comment|"# 304 Not Modified responses, and those don't contain any useful data."
nl|'\n'
indent|'        '
name|'req'
op|'='
name|'swob'
op|'.'
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'If-Modified-Since'"
op|':'
string|"'Wed, 12 Feb 2014 22:24:52 GMT'"
op|','
nl|'\n'
string|"'If-Unmodified-Since'"
op|':'
string|"'Thu, 13 Feb 2014 23:25:53 GMT'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|','
name|'exc'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|','
name|'expect_exception'
op|'='
name|'True'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'_'
op|','
name|'_'
op|','
name|'hdrs'
name|'in'
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls_with_headers'
op|'['
number|'1'
op|':'
op|']'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertFalse'
op|'('
string|"'If-Modified-Since'"
name|'in'
name|'hdrs'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertFalse'
op|'('
string|"'If-Unmodified-Since'"
name|'in'
name|'hdrs'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_error_fetching_segment
dedent|''
dedent|''
name|'def'
name|'test_error_fetching_segment'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPUnauthorized'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|','
name|'exc'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|','
name|'expect_exception'
op|'='
name|'True'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'HeaderKeyDict'
op|'('
name|'headers'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'exc'
op|','
name|'SegmentError'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
comment|'# This one has the error, and so is the last one we fetch.'
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_error_fetching_submanifest
dedent|''
name|'def'
name|'test_error_fetching_submanifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPUnauthorized'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|','
name|'exc'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|','
name|'expect_exception'
op|'='
name|'True'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'exc'
op|','
name|'ListingIterError'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|'"200 OK"'
op|','
name|'status'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|'"aaaaa"'
op|','
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
comment|'# This one has the error, and so is the last one we fetch.'
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc'"
op|')'
op|','
nl|'\n'
comment|'# But we were looking ahead to see if we could combine ranges,'
nl|'\n'
comment|'# so we still get the first segment out'
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_error_fetching_first_segment_submanifest
dedent|''
name|'def'
name|'test_error_fetching_first_segment_submanifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# This differs from the normal submanifest error because this one'
nl|'\n'
comment|"# happens before we've actually sent any response body."
nl|'\n'
indent|'        '
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-a'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPForbidden'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-manifest-a'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|'}'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/manifest-a'"
op|','
string|"'sub_slo'"
op|':'
name|'True'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'application/json;swift_bytes=5'"
op|','
nl|'\n'
string|"'hash'"
op|':'
string|"'manifest-a'"
op|','
nl|'\n'
string|"'bytes'"
op|':'
string|"'12345'"
op|'}'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-manifest-a'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'409 Conflict'"
op|','
name|'status'
op|')'
newline|'\n'
name|'error_lines'
op|'='
name|'self'
op|'.'
name|'slo'
op|'.'
name|'logger'
op|'.'
name|'get_lines_for_level'
op|'('
string|"'error'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'error_lines'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'error_lines'
op|'['
number|'0'
op|']'
op|'.'
name|'startswith'
op|'('
nl|'\n'
string|"'ERROR: An error occurred while retrieving segments'"
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_invalid_json_submanifest
dedent|''
name|'def'
name|'test_invalid_json_submanifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json;swift_bytes=25'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|','
nl|'\n'
string|"'X-Object-Meta-Plant'"
op|':'
string|"'Ficus'"
op|'}'
op|','
nl|'\n'
string|'"[this {isn\'t (JSON"'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|','
name|'exc'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|','
name|'expect_exception'
op|'='
name|'True'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'exc'
op|','
name|'ListingIterError'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'200 OK'"
op|','
name|'status'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'aaaaa'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_mismatched_etag
dedent|''
name|'def'
name|'test_mismatched_etag'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-a-b-badetag-c'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|'}'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/a_5'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'a'"
op|'*'
number|'5'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'5'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/b_10'"
op|','
string|"'hash'"
op|':'
string|"'wrong!'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'10'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/c_15'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'c'"
op|'*'
number|'15'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'15'"
op|'}'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-a-b-badetag-c'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|','
name|'exc'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|','
name|'expect_exception'
op|'='
name|'True'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'exc'
op|','
name|'SegmentError'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'200 OK'"
op|','
name|'status'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'aaaaa'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_mismatched_size
dedent|''
name|'def'
name|'test_mismatched_size'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
nl|'\n'
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-a-b-badsize-c'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|'}'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/a_5'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'a'"
op|'*'
number|'5'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'5'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/b_10'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'b'"
op|'*'
number|'10'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'999999'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'/gettest/c_15'"
op|','
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'c'"
op|'*'
number|'15'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
string|"'bytes'"
op|':'
string|"'15'"
op|'}'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-a-b-badsize-c'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|','
name|'exc'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|','
name|'expect_exception'
op|'='
name|'True'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'exc'
op|','
name|'SegmentError'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'200 OK'"
op|','
name|'status'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'body'
op|','
string|"'aaaaa'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_first_segment_mismatched_etag
dedent|''
name|'def'
name|'test_first_segment_mismatched_etag'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-badetag'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|'}'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/a_5'"
op|','
nl|'\n'
string|"'hash'"
op|':'
string|"'wrong!'"
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
nl|'\n'
string|"'bytes'"
op|':'
string|"'5'"
op|'}'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1/AUTH_test/gettest/manifest-badetag'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'409 Conflict'"
op|','
name|'status'
op|')'
newline|'\n'
name|'error_lines'
op|'='
name|'self'
op|'.'
name|'slo'
op|'.'
name|'logger'
op|'.'
name|'get_lines_for_level'
op|'('
string|"'error'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'error_lines'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'error_lines'
op|'['
number|'0'
op|']'
op|'.'
name|'startswith'
op|'('
nl|'\n'
string|"'ERROR: An error occurred while retrieving segments'"
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_first_segment_mismatched_size
dedent|''
name|'def'
name|'test_first_segment_mismatched_size'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-badsize'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|'}'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/a_5'"
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'a'"
op|'*'
number|'5'
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
nl|'\n'
string|"'bytes'"
op|':'
string|"'999999'"
op|'}'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1/AUTH_test/gettest/manifest-badsize'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'409 Conflict'"
op|','
name|'status'
op|')'
newline|'\n'
name|'error_lines'
op|'='
name|'self'
op|'.'
name|'slo'
op|'.'
name|'logger'
op|'.'
name|'get_lines_for_level'
op|'('
string|"'error'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'error_lines'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'error_lines'
op|'['
number|'0'
op|']'
op|'.'
name|'startswith'
op|'('
nl|'\n'
string|"'ERROR: An error occurred while retrieving segments'"
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_download_takes_too_long
dedent|''
name|'def'
name|'test_download_takes_too_long'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'the_time'
op|'='
op|'['
name|'time'
op|'.'
name|'time'
op|'('
op|')'
op|']'
newline|'\n'
nl|'\n'
DECL|function|mock_time
name|'def'
name|'mock_time'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'the_time'
op|'['
number|'0'
op|']'
newline|'\n'
nl|'\n'
comment|"# this is just a convenient place to hang a time jump; there's nothing"
nl|'\n'
comment|'# special about the choice of is_success().'
nl|'\n'
DECL|function|mock_is_success
dedent|''
name|'def'
name|'mock_is_success'
op|'('
name|'status_int'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'the_time'
op|'['
number|'0'
op|']'
op|'+='
number|'7'
op|'*'
number|'3600'
newline|'\n'
name|'return'
name|'status_int'
op|'//'
number|'100'
op|'=='
number|'2'
newline|'\n'
nl|'\n'
dedent|''
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
nl|'\n'
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
nl|'\n'
name|'with'
name|'patch'
op|'.'
name|'object'
op|'('
name|'slo'
op|','
string|"'is_success'"
op|','
name|'mock_is_success'
op|')'
op|','
name|'patch'
op|'('
string|"'swift.common.request_helpers.time.time'"
op|','
nl|'\n'
name|'mock_time'
op|')'
op|','
name|'patch'
op|'('
string|"'swift.common.request_helpers.is_success'"
op|','
nl|'\n'
name|'mock_is_success'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|','
name|'exc'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
nl|'\n'
name|'req'
op|','
name|'expect_exception'
op|'='
name|'True'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'exc'
op|','
name|'SegmentError'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'app'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-abcd'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-bc'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/a_5?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/b_10?multipart-manifest=get'"
op|')'
op|','
nl|'\n'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/c_15?multipart-manifest=get'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_first_segment_not_exists
dedent|''
name|'def'
name|'test_first_segment_not_exists'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/not_exists_obj'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPNotFound'
op|','
op|'{'
op|'}'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'register'
op|'('
string|"'GET'"
op|','
string|"'/v1/AUTH_test/gettest/manifest-not-exists'"
op|','
nl|'\n'
name|'swob'
op|'.'
name|'HTTPOk'
op|','
op|'{'
string|"'Content-Type'"
op|':'
string|"'application/json'"
op|','
nl|'\n'
string|"'X-Static-Large-Object'"
op|':'
string|"'true'"
op|'}'
op|','
nl|'\n'
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'/gettest/not_exists_obj'"
op|','
nl|'\n'
string|"'hash'"
op|':'
name|'md5hex'
op|'('
string|"'not_exists_obj'"
op|')'
op|','
nl|'\n'
string|"'content_type'"
op|':'
string|"'text/plain'"
op|','
nl|'\n'
string|"'bytes'"
op|':'
string|"'%d'"
op|'%'
name|'len'
op|'('
string|"'not_exists_obj'"
op|')'
nl|'\n'
op|'}'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1/AUTH_test/gettest/manifest-not-exists'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|')'
newline|'\n'
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'self'
op|'.'
name|'call_slo'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'409 Conflict'"
op|','
name|'status'
op|')'
newline|'\n'
name|'error_lines'
op|'='
name|'self'
op|'.'
name|'slo'
op|'.'
name|'logger'
op|'.'
name|'get_lines_for_level'
op|'('
string|"'error'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'error_lines'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'error_lines'
op|'['
number|'0'
op|']'
op|'.'
name|'startswith'
op|'('
nl|'\n'
string|"'ERROR: An error occurred while retrieving segments'"
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestSloBulkLogger
dedent|''
dedent|''
name|'class'
name|'TestSloBulkLogger'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|test_reused_logger
indent|'    '
name|'def'
name|'test_reused_logger'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'slo_mware'
op|'='
name|'slo'
op|'.'
name|'filter_factory'
op|'('
op|'{'
op|'}'
op|')'
op|'('
string|"'fake app'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'slo_mware'
op|'.'
name|'logger'
name|'is'
name|'slo_mware'
op|'.'
name|'bulk_deleter'
op|'.'
name|'logger'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestSwiftInfo
dedent|''
dedent|''
name|'class'
name|'TestSwiftInfo'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'utils'
op|'.'
name|'_swift_info'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'utils'
op|'.'
name|'_swift_admin_info'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
DECL|member|test_registered_defaults
dedent|''
name|'def'
name|'test_registered_defaults'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'mware'
op|'='
name|'slo'
op|'.'
name|'filter_factory'
op|'('
op|'{'
op|'}'
op|')'
op|'('
string|"'have to pass in an app'"
op|')'
newline|'\n'
name|'swift_info'
op|'='
name|'utils'
op|'.'
name|'get_swift_info'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'slo'"
name|'in'
name|'swift_info'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'swift_info'
op|'['
string|"'slo'"
op|']'
op|'.'
name|'get'
op|'('
string|"'max_manifest_segments'"
op|')'
op|','
nl|'\n'
name|'mware'
op|'.'
name|'max_manifest_segments'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'swift_info'
op|'['
string|"'slo'"
op|']'
op|'.'
name|'get'
op|'('
string|"'min_segment_size'"
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'swift_info'
op|'['
string|"'slo'"
op|']'
op|'.'
name|'get'
op|'('
string|"'max_manifest_size'"
op|')'
op|','
nl|'\n'
name|'mware'
op|'.'
name|'max_manifest_size'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
name|'__name__'
op|'=='
string|"'__main__'"
op|':'
newline|'\n'
indent|'    '
name|'unittest'
op|'.'
name|'main'
op|'('
op|')'
newline|'\n'
dedent|''
endmarker|''
end_unit
