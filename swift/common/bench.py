begin_unit
name|'import'
name|'uuid'
newline|'\n'
name|'import'
name|'time'
newline|'\n'
name|'import'
name|'random'
newline|'\n'
name|'from'
name|'urlparse'
name|'import'
name|'urlparse'
newline|'\n'
nl|'\n'
name|'import'
name|'eventlet'
op|'.'
name|'pools'
newline|'\n'
name|'from'
name|'eventlet'
op|'.'
name|'green'
op|'.'
name|'httplib'
name|'import'
name|'HTTPSConnection'
op|','
name|'HTTPResponse'
op|','
name|'CannotSendRequest'
newline|'\n'
nl|'\n'
name|'from'
name|'swift'
op|'.'
name|'common'
op|'.'
name|'bufferedhttp'
name|'import'
name|'BufferedHTTPConnection'
name|'as'
name|'HTTPConnection'
newline|'\n'
name|'from'
name|'swift'
op|'.'
name|'common'
op|'.'
name|'utils'
name|'import'
name|'TRUE_VALUES'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ConnectionPool
name|'class'
name|'ConnectionPool'
op|'('
name|'eventlet'
op|'.'
name|'pools'
op|'.'
name|'Pool'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'url'
op|','
name|'size'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'url'
op|'='
name|'url'
newline|'\n'
name|'self'
op|'.'
name|'url_parsed'
op|'='
name|'urlparse'
op|'('
name|'self'
op|'.'
name|'url'
op|')'
newline|'\n'
name|'eventlet'
op|'.'
name|'pools'
op|'.'
name|'Pool'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'size'
op|','
name|'size'
op|')'
newline|'\n'
nl|'\n'
DECL|member|create
dedent|''
name|'def'
name|'create'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'url_parsed'
op|'['
number|'0'
op|']'
op|'=='
string|"'https'"
op|':'
newline|'\n'
indent|'            '
name|'hc'
op|'='
name|'HTTPSConnection'
op|'('
name|'self'
op|'.'
name|'url_parsed'
op|'['
number|'1'
op|']'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'self'
op|'.'
name|'url_parsed'
op|'['
number|'0'
op|']'
op|'=='
string|"'http'"
op|':'
newline|'\n'
indent|'            '
name|'hc'
op|'='
name|'HTTPConnection'
op|'('
name|'self'
op|'.'
name|'url_parsed'
op|'['
number|'1'
op|']'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'Exception'
op|'('
string|'"Can\'t handle %s"'
op|'%'
name|'self'
op|'.'
name|'url_parsed'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'hc'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|Bench
dedent|''
dedent|''
name|'class'
name|'Bench'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'logger'
op|','
name|'conf'
op|','
name|'names'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'logger'
op|'='
name|'logger'
newline|'\n'
name|'self'
op|'.'
name|'user'
op|'='
name|'conf'
op|'.'
name|'user'
newline|'\n'
name|'self'
op|'.'
name|'key'
op|'='
name|'conf'
op|'.'
name|'key'
newline|'\n'
name|'self'
op|'.'
name|'auth_url'
op|'='
name|'conf'
op|'.'
name|'auth'
newline|'\n'
name|'self'
op|'.'
name|'use_proxy'
op|'='
name|'conf'
op|'.'
name|'use_proxy'
name|'in'
name|'TRUE_VALUES'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'use_proxy'
op|':'
newline|'\n'
comment|'# Get the auth token'
nl|'\n'
indent|'            '
name|'parsed'
op|'='
name|'urlparse'
op|'('
name|'self'
op|'.'
name|'auth_url'
op|')'
newline|'\n'
name|'if'
name|'parsed'
op|'.'
name|'scheme'
op|'=='
string|"'http'"
op|':'
newline|'\n'
indent|'                '
name|'hc'
op|'='
name|'HTTPConnection'
op|'('
name|'parsed'
op|'.'
name|'netloc'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'parsed'
op|'.'
name|'scheme'
op|'=='
string|"'https'"
op|':'
newline|'\n'
indent|'                '
name|'hc'
op|'='
name|'HTTPSConnection'
op|'('
name|'parsed'
op|'.'
name|'netloc'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'ClientException'
op|'('
nl|'\n'
string|"'Cannot handle protocol scheme %s for url %s'"
op|'%'
nl|'\n'
op|'('
name|'parsed'
op|'.'
name|'scheme'
op|','
name|'self'
op|'.'
name|'auth_url'
op|')'
op|')'
newline|'\n'
dedent|''
name|'hc_args'
op|'='
op|'('
string|"'GET'"
op|','
name|'parsed'
op|'.'
name|'path'
op|','
name|'None'
op|','
nl|'\n'
op|'{'
string|"'X-Auth-User'"
op|':'
name|'self'
op|'.'
name|'user'
op|','
string|"'X-Auth-Key'"
op|':'
name|'self'
op|'.'
name|'key'
op|'}'
op|')'
newline|'\n'
name|'hc'
op|'.'
name|'request'
op|'('
op|'*'
name|'hc_args'
op|')'
newline|'\n'
name|'hcr'
op|'='
name|'hc'
op|'.'
name|'getresponse'
op|'('
op|')'
newline|'\n'
name|'hcrd'
op|'='
name|'hcr'
op|'.'
name|'read'
op|'('
op|')'
newline|'\n'
name|'if'
name|'hcr'
op|'.'
name|'status'
op|'!='
number|'204'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'Exception'
op|'('
string|'"Could not authenticate (%s)"'
op|'%'
name|'hcr'
op|'.'
name|'status'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'token'
op|'='
name|'hcr'
op|'.'
name|'getheader'
op|'('
string|"'x-auth-token'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'account'
op|'='
name|'hcr'
op|'.'
name|'getheader'
op|'('
string|"'x-storage-url'"
op|')'
op|'.'
name|'split'
op|'('
string|"'/'"
op|')'
op|'['
op|'-'
number|'1'
op|']'
newline|'\n'
name|'if'
name|'conf'
op|'.'
name|'url'
op|'=='
string|"''"
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'url'
op|'='
name|'hcr'
op|'.'
name|'getheader'
op|'('
string|"'x-storage-url'"
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'url'
op|'='
name|'conf'
op|'.'
name|'url'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'token'
op|'='
string|"'SlapChop!'"
newline|'\n'
name|'self'
op|'.'
name|'account'
op|'='
name|'conf'
op|'.'
name|'account'
newline|'\n'
name|'self'
op|'.'
name|'url'
op|'='
name|'conf'
op|'.'
name|'url'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'container_name'
op|'='
name|'conf'
op|'.'
name|'container_name'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'object_size'
op|'='
name|'int'
op|'('
name|'conf'
op|'.'
name|'object_size'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'object_sources'
op|'='
name|'conf'
op|'.'
name|'object_sources'
newline|'\n'
name|'self'
op|'.'
name|'files'
op|'='
op|'['
op|']'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'object_sources'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'object_sources'
op|'='
name|'self'
op|'.'
name|'object_sources'
op|'.'
name|'split'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'files'
op|'='
op|'['
name|'file'
op|'('
name|'f'
op|','
string|"'rb'"
op|')'
op|'.'
name|'read'
op|'('
op|')'
name|'for'
name|'f'
name|'in'
name|'self'
op|'.'
name|'object_sources'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'put_concurrency'
op|'='
name|'int'
op|'('
name|'conf'
op|'.'
name|'put_concurrency'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'get_concurrency'
op|'='
name|'int'
op|'('
name|'conf'
op|'.'
name|'get_concurrency'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'del_concurrency'
op|'='
name|'int'
op|'('
name|'conf'
op|'.'
name|'del_concurrency'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'total_objects'
op|'='
name|'int'
op|'('
name|'conf'
op|'.'
name|'num_objects'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'total_gets'
op|'='
name|'int'
op|'('
name|'conf'
op|'.'
name|'num_gets'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'timeout'
op|'='
name|'int'
op|'('
name|'conf'
op|'.'
name|'timeout'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'url_parsed'
op|'='
name|'urlparse'
op|'('
name|'self'
op|'.'
name|'url'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'devices'
op|'='
name|'conf'
op|'.'
name|'devices'
op|'.'
name|'split'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'names'
op|'='
name|'names'
newline|'\n'
name|'self'
op|'.'
name|'conn_pool'
op|'='
name|'ConnectionPool'
op|'('
name|'self'
op|'.'
name|'url'
op|','
nl|'\n'
name|'max'
op|'('
name|'self'
op|'.'
name|'put_concurrency'
op|','
name|'self'
op|'.'
name|'get_concurrency'
op|','
nl|'\n'
name|'self'
op|'.'
name|'del_concurrency'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_log_status
dedent|''
name|'def'
name|'_log_status'
op|'('
name|'self'
op|','
name|'title'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'total'
op|'='
name|'time'
op|'.'
name|'time'
op|'('
op|')'
op|'-'
name|'self'
op|'.'
name|'beginbeat'
newline|'\n'
name|'self'
op|'.'
name|'logger'
op|'.'
name|'info'
op|'('
string|"'%s %s [%s failures], %.01f/s'"
op|'%'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'complete'
op|','
name|'title'
op|','
name|'self'
op|'.'
name|'failures'
op|','
nl|'\n'
op|'('
name|'float'
op|'('
name|'self'
op|'.'
name|'complete'
op|')'
op|'/'
name|'total'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_create_connection
dedent|''
name|'def'
name|'_create_connection'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'url_parsed'
op|'['
number|'0'
op|']'
op|'=='
string|"'https'"
op|':'
newline|'\n'
indent|'            '
name|'hc'
op|'='
name|'HTTPSConnection'
op|'('
name|'self'
op|'.'
name|'url_parsed'
op|'['
number|'1'
op|']'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'self'
op|'.'
name|'url_parsed'
op|'['
number|'0'
op|']'
op|'=='
string|"'http'"
op|':'
newline|'\n'
indent|'            '
name|'hc'
op|'='
name|'HTTPConnection'
op|'('
name|'self'
op|'.'
name|'url_parsed'
op|'['
number|'1'
op|']'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'Exception'
op|'('
string|'"Can\'t handle %s"'
op|'%'
name|'self'
op|'.'
name|'url_parsed'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'hc'
newline|'\n'
nl|'\n'
DECL|member|_send_request
dedent|''
name|'def'
name|'_send_request'
op|'('
name|'self'
op|','
op|'*'
name|'args'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'hc'
op|'='
name|'self'
op|'.'
name|'conn_pool'
op|'.'
name|'get'
op|'('
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'start'
op|'='
name|'time'
op|'.'
name|'time'
op|'('
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'hc'
op|'.'
name|'request'
op|'('
op|'*'
name|'args'
op|')'
newline|'\n'
name|'hcr'
op|'='
name|'hc'
op|'.'
name|'getresponse'
op|'('
op|')'
newline|'\n'
name|'hcrd'
op|'='
name|'hcr'
op|'.'
name|'read'
op|'('
op|')'
newline|'\n'
name|'hcr'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
dedent|''
name|'except'
name|'CannotSendRequest'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'logger'
op|'.'
name|'info'
op|'('
string|'"CannotSendRequest.  Skipping..."'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'                    '
name|'hc'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
indent|'                    '
name|'pass'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'failures'
op|'+='
number|'1'
newline|'\n'
name|'hc'
op|'='
name|'self'
op|'.'
name|'_create_connection'
op|'('
op|')'
newline|'\n'
name|'return'
newline|'\n'
dedent|''
name|'total'
op|'='
name|'time'
op|'.'
name|'time'
op|'('
op|')'
op|'-'
name|'start'
newline|'\n'
name|'self'
op|'.'
name|'logger'
op|'.'
name|'debug'
op|'('
string|'"%s %s: %04f"'
op|'%'
nl|'\n'
op|'('
name|'args'
op|'['
number|'0'
op|']'
op|','
name|'args'
op|'['
number|'1'
op|']'
op|','
name|'total'
op|')'
op|')'
newline|'\n'
name|'if'
name|'hcr'
op|'.'
name|'status'
op|'<'
number|'200'
name|'or'
name|'hcr'
op|'.'
name|'status'
op|'>'
number|'299'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'failures'
op|'+='
number|'1'
newline|'\n'
name|'return'
name|'False'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'True'
newline|'\n'
dedent|''
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'conn_pool'
op|'.'
name|'put'
op|'('
name|'hc'
op|')'
newline|'\n'
nl|'\n'
DECL|member|run
dedent|''
dedent|''
name|'def'
name|'run'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pool'
op|'='
name|'eventlet'
op|'.'
name|'GreenPool'
op|'('
name|'self'
op|'.'
name|'concurrency'
op|')'
newline|'\n'
name|'events'
op|'='
op|'['
op|']'
newline|'\n'
name|'self'
op|'.'
name|'beginbeat'
op|'='
name|'self'
op|'.'
name|'heartbeat'
op|'='
name|'time'
op|'.'
name|'time'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'heartbeat'
op|'-='
number|'13'
comment|'# just to get the first report quicker'
newline|'\n'
name|'self'
op|'.'
name|'failures'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'complete'
op|'='
number|'0'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'xrange'
op|'('
name|'self'
op|'.'
name|'total'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'pool'
op|'.'
name|'spawn_n'
op|'('
name|'self'
op|'.'
name|'_run'
op|','
name|'i'
op|')'
newline|'\n'
dedent|''
name|'pool'
op|'.'
name|'waitall'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_log_status'
op|'('
name|'self'
op|'.'
name|'msg'
op|'+'
string|"' **FINAL**'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|_run
dedent|''
name|'def'
name|'_run'
op|'('
name|'self'
op|','
name|'thread'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|BenchController
dedent|''
dedent|''
name|'class'
name|'BenchController'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'logger'
op|','
name|'conf'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'logger'
op|'='
name|'logger'
newline|'\n'
name|'self'
op|'.'
name|'conf'
op|'='
name|'conf'
newline|'\n'
name|'self'
op|'.'
name|'names'
op|'='
op|'['
op|']'
newline|'\n'
name|'self'
op|'.'
name|'delete'
op|'='
name|'conf'
op|'.'
name|'delete'
name|'in'
name|'TRUE_VALUES'
newline|'\n'
name|'self'
op|'.'
name|'gets'
op|'='
name|'int'
op|'('
name|'conf'
op|'.'
name|'num_gets'
op|')'
newline|'\n'
nl|'\n'
DECL|member|run
dedent|''
name|'def'
name|'run'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'puts'
op|'='
name|'BenchPUT'
op|'('
name|'self'
op|'.'
name|'logger'
op|','
name|'self'
op|'.'
name|'conf'
op|','
name|'self'
op|'.'
name|'names'
op|')'
newline|'\n'
name|'puts'
op|'.'
name|'run'
op|'('
op|')'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'gets'
op|':'
newline|'\n'
indent|'            '
name|'gets'
op|'='
name|'BenchGET'
op|'('
name|'self'
op|'.'
name|'logger'
op|','
name|'self'
op|'.'
name|'conf'
op|','
name|'self'
op|'.'
name|'names'
op|')'
newline|'\n'
name|'gets'
op|'.'
name|'run'
op|'('
op|')'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'delete'
op|':'
newline|'\n'
indent|'            '
name|'dels'
op|'='
name|'BenchDELETE'
op|'('
name|'self'
op|'.'
name|'logger'
op|','
name|'self'
op|'.'
name|'conf'
op|','
name|'self'
op|'.'
name|'names'
op|')'
newline|'\n'
name|'dels'
op|'.'
name|'run'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|BenchDELETE
dedent|''
dedent|''
dedent|''
name|'class'
name|'BenchDELETE'
op|'('
name|'Bench'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'logger'
op|','
name|'conf'
op|','
name|'names'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'Bench'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'logger'
op|','
name|'conf'
op|','
name|'names'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'concurrency'
op|'='
name|'self'
op|'.'
name|'del_concurrency'
newline|'\n'
name|'self'
op|'.'
name|'total'
op|'='
name|'len'
op|'('
name|'names'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'msg'
op|'='
string|"'DEL'"
newline|'\n'
nl|'\n'
DECL|member|_run
dedent|''
name|'def'
name|'_run'
op|'('
name|'self'
op|','
name|'thread'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'time'
op|'.'
name|'time'
op|'('
op|')'
op|'-'
name|'self'
op|'.'
name|'heartbeat'
op|'>='
number|'15'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'heartbeat'
op|'='
name|'time'
op|'.'
name|'time'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_log_status'
op|'('
string|"'DEL'"
op|')'
newline|'\n'
dedent|''
name|'device'
op|','
name|'partition'
op|','
name|'path'
op|'='
name|'self'
op|'.'
name|'names'
op|'.'
name|'pop'
op|'('
op|')'
newline|'\n'
name|'headers'
op|'='
op|'{'
nl|'\n'
string|"'X-Timestamp'"
op|':'
string|'"%013.05f"'
op|'%'
name|'time'
op|'.'
name|'time'
op|'('
op|')'
op|','
nl|'\n'
string|"'X-ID'"
op|':'
name|'str'
op|'('
name|'uuid'
op|'.'
name|'uuid4'
op|'('
op|')'
op|')'
op|','
nl|'\n'
string|"'X-Auth-Token'"
op|':'
name|'self'
op|'.'
name|'token'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'use_proxy'
op|':'
newline|'\n'
indent|'            '
name|'hc_args'
op|'='
op|'('
string|"'DELETE'"
op|','
string|'"/v1/%s/%s/%s"'
op|'%'
nl|'\n'
op|'('
name|'self'
op|'.'
name|'account'
op|','
name|'self'
op|'.'
name|'container_name'
op|','
name|'path'
op|')'
op|','
string|"''"
op|','
name|'headers'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'hc_args'
op|'='
op|'('
string|"'DELETE'"
op|','
string|'"/%s/%s/%s/%s/%s"'
op|'%'
nl|'\n'
op|'('
name|'device'
op|','
name|'partition'
op|','
name|'self'
op|'.'
name|'account'
op|','
name|'self'
op|'.'
name|'container_name'
op|','
name|'path'
op|')'
op|','
nl|'\n'
string|"''"
op|','
name|'headers'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'_send_request'
op|'('
op|'*'
name|'hc_args'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'complete'
op|'+='
number|'1'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|BenchGET
dedent|''
dedent|''
name|'class'
name|'BenchGET'
op|'('
name|'Bench'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'logger'
op|','
name|'conf'
op|','
name|'names'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'Bench'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'logger'
op|','
name|'conf'
op|','
name|'names'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'concurrency'
op|'='
name|'self'
op|'.'
name|'get_concurrency'
newline|'\n'
name|'self'
op|'.'
name|'total'
op|'='
name|'self'
op|'.'
name|'total_gets'
newline|'\n'
name|'self'
op|'.'
name|'msg'
op|'='
string|"'GETS'"
newline|'\n'
nl|'\n'
DECL|member|_run
dedent|''
name|'def'
name|'_run'
op|'('
name|'self'
op|','
name|'thread'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'time'
op|'.'
name|'time'
op|'('
op|')'
op|'-'
name|'self'
op|'.'
name|'heartbeat'
op|'>='
number|'15'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'heartbeat'
op|'='
name|'time'
op|'.'
name|'time'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_log_status'
op|'('
string|"'GETS'"
op|')'
newline|'\n'
dedent|''
name|'device'
op|','
name|'partition'
op|','
name|'name'
op|'='
name|'random'
op|'.'
name|'choice'
op|'('
name|'self'
op|'.'
name|'names'
op|')'
newline|'\n'
name|'headers'
op|'='
op|'{'
nl|'\n'
string|"'X-Auth-Token'"
op|':'
name|'self'
op|'.'
name|'token'
op|','
nl|'\n'
string|"'X-Timestamp'"
op|':'
string|'"%013.05f"'
op|'%'
name|'time'
op|'.'
name|'time'
op|'('
op|')'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'use_proxy'
op|':'
newline|'\n'
indent|'            '
name|'hc_args'
op|'='
op|'('
string|"'GET'"
op|','
string|"'/v1/%s/%s/%s'"
op|'%'
nl|'\n'
op|'('
name|'self'
op|'.'
name|'account'
op|','
name|'self'
op|'.'
name|'container_name'
op|','
name|'name'
op|')'
op|','
string|"''"
op|','
name|'headers'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'hc_args'
op|'='
op|'('
string|"'GET'"
op|','
string|"'/%s/%s/%s/%s/%s'"
op|'%'
nl|'\n'
op|'('
name|'device'
op|','
name|'partition'
op|','
name|'self'
op|'.'
name|'account'
op|','
name|'self'
op|'.'
name|'container_name'
op|','
name|'name'
op|')'
op|','
nl|'\n'
string|"''"
op|','
name|'headers'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'_send_request'
op|'('
op|'*'
name|'hc_args'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'complete'
op|'+='
number|'1'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|BenchPUT
dedent|''
dedent|''
name|'class'
name|'BenchPUT'
op|'('
name|'Bench'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'logger'
op|','
name|'conf'
op|','
name|'names'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'Bench'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'logger'
op|','
name|'conf'
op|','
name|'names'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'concurrency'
op|'='
name|'self'
op|'.'
name|'put_concurrency'
newline|'\n'
name|'self'
op|'.'
name|'total'
op|'='
name|'self'
op|'.'
name|'total_objects'
newline|'\n'
name|'self'
op|'.'
name|'msg'
op|'='
string|"'PUTS'"
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'use_proxy'
op|':'
newline|'\n'
comment|'# Create the container'
nl|'\n'
indent|'            '
name|'if'
name|'self'
op|'.'
name|'url'
op|'.'
name|'startswith'
op|'('
string|"'http://'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'hc'
op|'='
name|'HTTPConnection'
op|'('
name|'self'
op|'.'
name|'url'
op|'.'
name|'split'
op|'('
string|"'/'"
op|')'
op|'['
number|'2'
op|']'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'hc'
op|'='
name|'HTTPSConnection'
op|'('
name|'self'
op|'.'
name|'url'
op|'.'
name|'split'
op|'('
string|"'/'"
op|')'
op|'['
number|'2'
op|']'
op|')'
newline|'\n'
dedent|''
name|'hc_args'
op|'='
op|'('
string|"'PUT'"
op|','
nl|'\n'
string|"'/v1/%s/%s'"
op|'%'
op|'('
name|'self'
op|'.'
name|'account'
op|','
name|'self'
op|'.'
name|'container_name'
op|')'
op|','
nl|'\n'
name|'None'
op|','
op|'{'
string|"'X-Auth-Token'"
op|':'
name|'self'
op|'.'
name|'token'
op|'}'
op|')'
newline|'\n'
name|'hc'
op|'.'
name|'request'
op|'('
op|'*'
name|'hc_args'
op|')'
newline|'\n'
name|'hcr'
op|'='
name|'hc'
op|'.'
name|'getresponse'
op|'('
op|')'
newline|'\n'
name|'hcrd'
op|'='
name|'hcr'
op|'.'
name|'read'
op|'('
op|')'
newline|'\n'
name|'if'
name|'hcr'
op|'.'
name|'status'
op|'<'
number|'200'
name|'or'
name|'hcr'
op|'.'
name|'status'
op|'>'
number|'299'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'Exception'
op|'('
string|"'Could not create container %s: code: %s'"
op|'%'
nl|'\n'
op|'('
name|'self'
op|'.'
name|'container_name'
op|','
name|'hcr'
op|'.'
name|'status'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_run
dedent|''
dedent|''
dedent|''
name|'def'
name|'_run'
op|'('
name|'self'
op|','
name|'thread'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'time'
op|'.'
name|'time'
op|'('
op|')'
op|'-'
name|'self'
op|'.'
name|'heartbeat'
op|'>='
number|'15'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'heartbeat'
op|'='
name|'time'
op|'.'
name|'time'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_log_status'
op|'('
string|"'PUTS'"
op|')'
newline|'\n'
dedent|''
name|'name'
op|'='
name|'uuid'
op|'.'
name|'uuid4'
op|'('
op|')'
op|'.'
name|'hex'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'object_sources'
op|':'
newline|'\n'
indent|'            '
name|'source'
op|'='
name|'random'
op|'.'
name|'choice'
op|'('
name|'self'
op|'.'
name|'files'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'source'
op|'='
string|"'0'"
op|'*'
name|'self'
op|'.'
name|'object_size'
newline|'\n'
dedent|''
name|'headers'
op|'='
op|'{'
nl|'\n'
string|"'Content-Type'"
op|':'
string|"'application/octet-stream'"
op|','
nl|'\n'
string|"'X-ID'"
op|':'
name|'str'
op|'('
name|'uuid'
op|'.'
name|'uuid4'
op|'('
op|')'
op|')'
op|','
nl|'\n'
string|"'X-Auth-Token'"
op|':'
name|'self'
op|'.'
name|'token'
op|','
nl|'\n'
string|"'X-Timestamp'"
op|':'
string|'"%013.05f"'
op|'%'
name|'time'
op|'.'
name|'time'
op|'('
op|')'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'device'
op|'='
name|'random'
op|'.'
name|'choice'
op|'('
name|'self'
op|'.'
name|'devices'
op|')'
newline|'\n'
name|'partition'
op|'='
name|'str'
op|'('
name|'random'
op|'.'
name|'randint'
op|'('
number|'1'
op|','
number|'3000'
op|')'
op|')'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'use_proxy'
op|':'
newline|'\n'
indent|'            '
name|'hc_args'
op|'='
op|'('
string|"'PUT'"
op|','
string|"'/v1/%s/%s/%s'"
op|'%'
nl|'\n'
op|'('
name|'self'
op|'.'
name|'account'
op|','
name|'self'
op|'.'
name|'container_name'
op|','
name|'name'
op|')'
op|','
name|'source'
op|','
name|'headers'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'hc_args'
op|'='
op|'('
string|"'PUT'"
op|','
string|"'/%s/%s/%s/%s/%s'"
op|'%'
nl|'\n'
op|'('
name|'device'
op|','
name|'partition'
op|','
name|'self'
op|'.'
name|'account'
op|','
name|'self'
op|'.'
name|'container_name'
op|','
name|'name'
op|')'
op|','
nl|'\n'
name|'source'
op|','
name|'headers'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'_send_request'
op|'('
op|'*'
name|'hc_args'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'names'
op|'.'
name|'append'
op|'('
op|'('
name|'device'
op|','
name|'partition'
op|','
name|'name'
op|')'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'complete'
op|'+='
number|'1'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
