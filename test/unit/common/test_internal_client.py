begin_unit
comment|'# Copyright (c) 2010-2012 OpenStack, LLC.'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Licensed under the Apache License, Version 2.0 (the "License");'
nl|'\n'
comment|'# you may not use this file except in compliance with the License.'
nl|'\n'
comment|'# You may obtain a copy of the License at'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    http://www.apache.org/licenses/LICENSE-2.0'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Unless required by applicable law or agreed to in writing, software'
nl|'\n'
comment|'# distributed under the License is distributed on an "AS IS" BASIS,'
nl|'\n'
comment|'# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or'
nl|'\n'
comment|'# implied.'
nl|'\n'
comment|'# See the License for the specific language governing permissions and'
nl|'\n'
comment|'# limitations under the License.'
nl|'\n'
nl|'\n'
name|'import'
name|'json'
newline|'\n'
name|'from'
name|'StringIO'
name|'import'
name|'StringIO'
newline|'\n'
name|'import'
name|'unittest'
newline|'\n'
name|'from'
name|'urllib'
name|'import'
name|'quote'
newline|'\n'
name|'import'
name|'zlib'
newline|'\n'
nl|'\n'
name|'from'
name|'swift'
op|'.'
name|'common'
name|'import'
name|'internal_client'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|not_sleep
name|'def'
name|'not_sleep'
op|'('
name|'seconds'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|unicode_string
dedent|''
name|'def'
name|'unicode_string'
op|'('
name|'start'
op|','
name|'length'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
string|"u''"
op|'.'
name|'join'
op|'('
op|'['
name|'unichr'
op|'('
name|'x'
op|')'
name|'for'
name|'x'
name|'in'
name|'xrange'
op|'('
name|'start'
op|','
name|'start'
op|'+'
name|'length'
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|path_parts
dedent|''
name|'def'
name|'path_parts'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'account'
op|'='
name|'unicode_string'
op|'('
number|'1000'
op|','
number|'4'
op|')'
op|'+'
string|"' '"
op|'+'
name|'unicode_string'
op|'('
number|'1100'
op|','
number|'4'
op|')'
newline|'\n'
name|'container'
op|'='
name|'unicode_string'
op|'('
number|'2000'
op|','
number|'4'
op|')'
op|'+'
string|"' '"
op|'+'
name|'unicode_string'
op|'('
number|'2100'
op|','
number|'4'
op|')'
newline|'\n'
name|'obj'
op|'='
name|'unicode_string'
op|'('
number|'3000'
op|','
number|'4'
op|')'
op|'+'
string|"' '"
op|'+'
name|'unicode_string'
op|'('
number|'3100'
op|','
number|'4'
op|')'
newline|'\n'
name|'return'
name|'account'
op|','
name|'container'
op|','
name|'obj'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|make_path
dedent|''
name|'def'
name|'make_path'
op|'('
name|'account'
op|','
name|'container'
op|'='
name|'None'
op|','
name|'obj'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'path'
op|'='
string|"'/v1/%s'"
op|'%'
name|'quote'
op|'('
name|'account'
op|'.'
name|'encode'
op|'('
string|"'utf-8'"
op|')'
op|')'
newline|'\n'
name|'if'
name|'container'
op|':'
newline|'\n'
indent|'        '
name|'path'
op|'+='
string|"'/%s'"
op|'%'
name|'quote'
op|'('
name|'container'
op|'.'
name|'encode'
op|'('
string|"'utf-8'"
op|')'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'obj'
op|':'
newline|'\n'
indent|'        '
name|'path'
op|'+='
string|"'/%s'"
op|'%'
name|'quote'
op|'('
name|'obj'
op|'.'
name|'encode'
op|'('
string|"'utf-8'"
op|')'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'path'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|InternalClient
dedent|''
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|GetMetadataInternalClient
dedent|''
dedent|''
name|'class'
name|'GetMetadataInternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|','
name|'path'
op|','
name|'metadata_prefix'
op|','
name|'acceptable_statuses'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\n'
name|'self'
op|'.'
name|'metadata_prefix'
op|'='
name|'metadata_prefix'
newline|'\n'
name|'self'
op|'.'
name|'acceptable_statuses'
op|'='
name|'acceptable_statuses'
newline|'\n'
name|'self'
op|'.'
name|'get_metadata_called'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'metadata'
op|'='
string|"'some_metadata'"
newline|'\n'
nl|'\n'
DECL|member|_get_metadata
dedent|''
name|'def'
name|'_get_metadata'
op|'('
name|'self'
op|','
name|'path'
op|','
name|'metadata_prefix'
op|','
name|'acceptable_statuses'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'get_metadata_called'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'path'
op|','
name|'path'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'metadata_prefix'
op|','
name|'metadata_prefix'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'acceptable_statuses'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'metadata'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|SetMetadataInternalClient
dedent|''
dedent|''
name|'class'
name|'SetMetadataInternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
nl|'\n'
name|'self'
op|','
name|'test'
op|','
name|'path'
op|','
name|'metadata'
op|','
name|'metadata_prefix'
op|','
name|'acceptable_statuses'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\n'
name|'self'
op|'.'
name|'metadata'
op|'='
name|'metadata'
newline|'\n'
name|'self'
op|'.'
name|'metadata_prefix'
op|'='
name|'metadata_prefix'
newline|'\n'
name|'self'
op|'.'
name|'acceptable_statuses'
op|'='
name|'acceptable_statuses'
newline|'\n'
name|'self'
op|'.'
name|'set_metadata_called'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'metadata'
op|'='
string|"'some_metadata'"
newline|'\n'
nl|'\n'
DECL|member|_set_metadata
dedent|''
name|'def'
name|'_set_metadata'
op|'('
nl|'\n'
name|'self'
op|','
name|'path'
op|','
name|'metadata'
op|','
name|'metadata_prefix'
op|'='
string|"''"
op|','
nl|'\n'
name|'acceptable_statuses'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'set_metadata_called'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'path'
op|','
name|'path'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'metadata_prefix'
op|','
name|'metadata_prefix'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'metadata'
op|','
name|'metadata'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'acceptable_statuses'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|IterInternalClient
dedent|''
dedent|''
name|'class'
name|'IterInternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
nl|'\n'
name|'self'
op|','
name|'test'
op|','
name|'path'
op|','
name|'marker'
op|','
name|'end_marker'
op|','
name|'acceptable_statuses'
op|','
name|'items'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\n'
name|'self'
op|'.'
name|'marker'
op|'='
name|'marker'
newline|'\n'
name|'self'
op|'.'
name|'end_marker'
op|'='
name|'end_marker'
newline|'\n'
name|'self'
op|'.'
name|'acceptable_statuses'
op|'='
name|'acceptable_statuses'
newline|'\n'
name|'self'
op|'.'
name|'items'
op|'='
name|'items'
newline|'\n'
nl|'\n'
DECL|member|_iter_items
dedent|''
name|'def'
name|'_iter_items'
op|'('
nl|'\n'
name|'self'
op|','
name|'path'
op|','
name|'marker'
op|'='
string|"''"
op|','
name|'end_marker'
op|'='
string|"''"
op|','
name|'acceptable_statuses'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'path'
op|','
name|'path'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'marker'
op|','
name|'marker'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'end_marker'
op|','
name|'end_marker'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'acceptable_statuses'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'for'
name|'item'
name|'in'
name|'self'
op|'.'
name|'items'
op|':'
newline|'\n'
indent|'            '
name|'yield'
name|'item'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestCompressingfileReader
dedent|''
dedent|''
dedent|''
name|'class'
name|'TestCompressingfileReader'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|test_init
indent|'    '
name|'def'
name|'test_init'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|CompressObj
indent|'        '
name|'class'
name|'CompressObj'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|','
op|'*'
name|'args'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'args'
op|'='
name|'args'
newline|'\n'
nl|'\n'
DECL|member|method
dedent|''
name|'def'
name|'method'
op|'('
name|'self'
op|','
op|'*'
name|'args'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'args'
op|','
name|'args'
op|')'
newline|'\n'
name|'return'
name|'self'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'try'
op|':'
newline|'\n'
DECL|variable|compressobj
indent|'            '
name|'compressobj'
op|'='
name|'CompressObj'
op|'('
nl|'\n'
name|'self'
op|','
number|'9'
op|','
name|'zlib'
op|'.'
name|'DEFLATED'
op|','
op|'-'
name|'zlib'
op|'.'
name|'MAX_WBITS'
op|','
name|'zlib'
op|'.'
name|'DEF_MEM_LEVEL'
op|','
number|'0'
op|')'
newline|'\n'
nl|'\n'
DECL|variable|old_compressobj
name|'old_compressobj'
op|'='
name|'internal_client'
op|'.'
name|'compressobj'
newline|'\n'
name|'internal_client'
op|'.'
name|'compressobj'
op|'='
name|'compressobj'
op|'.'
name|'method'
newline|'\n'
nl|'\n'
DECL|variable|f
name|'f'
op|'='
name|'StringIO'
op|'('
string|"''"
op|')'
newline|'\n'
nl|'\n'
DECL|variable|fobj
name|'fobj'
op|'='
name|'internal_client'
op|'.'
name|'CompressingFileReader'
op|'('
name|'f'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'f'
op|','
name|'fobj'
op|'.'
name|'_f'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'compressobj'
op|','
name|'fobj'
op|'.'
name|'_compressor'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'False'
op|','
name|'fobj'
op|'.'
name|'done'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'True'
op|','
name|'fobj'
op|'.'
name|'first'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'0'
op|','
name|'fobj'
op|'.'
name|'crc32'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'0'
op|','
name|'fobj'
op|'.'
name|'total_size'
op|')'
newline|'\n'
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'            '
name|'internal_client'
op|'.'
name|'compressobj'
op|'='
name|'old_compressobj'
newline|'\n'
nl|'\n'
DECL|member|test_read
dedent|''
dedent|''
name|'def'
name|'test_read'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'exp_data'
op|'='
string|"'abcdefghijklmnopqrstuvwxyz'"
newline|'\n'
name|'fobj'
op|'='
name|'internal_client'
op|'.'
name|'CompressingFileReader'
op|'('
name|'StringIO'
op|'('
name|'exp_data'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'data'
op|'='
string|"''"
newline|'\n'
name|'d'
op|'='
name|'zlib'
op|'.'
name|'decompressobj'
op|'('
number|'16'
op|'+'
name|'zlib'
op|'.'
name|'MAX_WBITS'
op|')'
newline|'\n'
name|'for'
name|'chunk'
name|'in'
name|'fobj'
op|'.'
name|'read'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'data'
op|'+='
name|'d'
op|'.'
name|'decompress'
op|'('
name|'chunk'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'exp_data'
op|','
name|'data'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestInternalClient
dedent|''
dedent|''
name|'class'
name|'TestInternalClient'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|test_init
indent|'    '
name|'def'
name|'test_init'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|App
indent|'        '
name|'class'
name|'App'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|','
name|'conf_path'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'conf_path'
op|'='
name|'conf_path'
newline|'\n'
name|'self'
op|'.'
name|'load_called'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|member|load
dedent|''
name|'def'
name|'load'
op|'('
name|'self'
op|','
name|'uri'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'load_called'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
string|"'config:'"
op|'+'
name|'conf_path'
op|','
name|'uri'
op|')'
newline|'\n'
name|'return'
name|'self'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'conf_path'
op|'='
string|"'some_path'"
newline|'\n'
name|'app'
op|'='
name|'App'
op|'('
name|'self'
op|','
name|'conf_path'
op|')'
newline|'\n'
name|'old_loadapp'
op|'='
name|'internal_client'
op|'.'
name|'loadapp'
newline|'\n'
name|'internal_client'
op|'.'
name|'loadapp'
op|'='
name|'app'
op|'.'
name|'load'
newline|'\n'
nl|'\n'
name|'user_agent'
op|'='
string|"'some_user_agent'"
newline|'\n'
name|'request_tries'
op|'='
string|"'some_request_tries'"
newline|'\n'
nl|'\n'
name|'try'
op|':'
newline|'\n'
DECL|variable|client
indent|'            '
name|'client'
op|'='
name|'internal_client'
op|'.'
name|'InternalClient'
op|'('
nl|'\n'
name|'conf_path'
op|','
name|'user_agent'
op|','
name|'request_tries'
op|')'
newline|'\n'
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'            '
name|'internal_client'
op|'.'
name|'loadapp'
op|'='
name|'old_loadapp'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'app'
op|'.'
name|'load_called'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'app'
op|','
name|'client'
op|'.'
name|'app'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'user_agent'
op|','
name|'client'
op|'.'
name|'user_agent'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request_tries'
op|','
name|'client'
op|'.'
name|'request_tries'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_make_request_sets_user_agent
dedent|''
name|'def'
name|'test_make_request_sets_user_agent'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|InternalClient
indent|'        '
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'='
name|'self'
op|'.'
name|'fake_app'
newline|'\n'
name|'self'
op|'.'
name|'user_agent'
op|'='
string|"'some_agent'"
newline|'\n'
name|'self'
op|'.'
name|'request_tries'
op|'='
number|'1'
newline|'\n'
nl|'\n'
DECL|member|fake_app
dedent|''
name|'def'
name|'fake_app'
op|'('
name|'self'
op|','
name|'env'
op|','
name|'start_response'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'user_agent'
op|','
name|'env'
op|'['
string|"'HTTP_USER_AGENT'"
op|']'
op|')'
newline|'\n'
name|'start_response'
op|'('
string|"'200 Ok'"
op|','
op|'['
op|'('
string|"'Content-Length'"
op|','
string|"'0'"
op|')'
op|']'
op|')'
newline|'\n'
name|'return'
op|'['
op|']'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'self'
op|')'
newline|'\n'
name|'client'
op|'.'
name|'make_request'
op|'('
string|"'GET'"
op|','
string|"'/'"
op|','
op|'{'
op|'}'
op|','
op|'('
number|'200'
op|','
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_make_request_retries
dedent|''
name|'def'
name|'test_make_request_retries'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|InternalClient
indent|'        '
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'='
name|'self'
op|'.'
name|'fake_app'
newline|'\n'
name|'self'
op|'.'
name|'user_agent'
op|'='
string|"'some_agent'"
newline|'\n'
name|'self'
op|'.'
name|'request_tries'
op|'='
number|'4'
newline|'\n'
name|'self'
op|'.'
name|'tries'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'sleep_called'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|member|fake_app
dedent|''
name|'def'
name|'fake_app'
op|'('
name|'self'
op|','
name|'env'
op|','
name|'start_response'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'tries'
op|'+='
number|'1'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'tries'
op|'<'
name|'self'
op|'.'
name|'request_tries'
op|':'
newline|'\n'
indent|'                    '
name|'start_response'
op|'('
nl|'\n'
string|"'500 Internal Server Error'"
op|','
op|'['
op|'('
string|"'Content-Length'"
op|','
string|"'0'"
op|')'
op|']'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'start_response'
op|'('
string|"'200 Ok'"
op|','
op|'['
op|'('
string|"'Content-Length'"
op|','
string|"'0'"
op|')'
op|']'
op|')'
newline|'\n'
dedent|''
name|'return'
op|'['
op|']'
newline|'\n'
nl|'\n'
DECL|member|sleep
dedent|''
name|'def'
name|'sleep'
op|'('
name|'self'
op|','
name|'seconds'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'sleep_called'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
number|'2'
op|'**'
op|'('
name|'self'
op|'.'
name|'sleep_called'
op|')'
op|','
name|'seconds'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'self'
op|')'
newline|'\n'
nl|'\n'
name|'old_sleep'
op|'='
name|'internal_client'
op|'.'
name|'sleep'
newline|'\n'
name|'internal_client'
op|'.'
name|'sleep'
op|'='
name|'client'
op|'.'
name|'sleep'
newline|'\n'
nl|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'client'
op|'.'
name|'make_request'
op|'('
string|"'GET'"
op|','
string|"'/'"
op|','
op|'{'
op|'}'
op|','
op|'('
number|'200'
op|','
op|')'
op|')'
newline|'\n'
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'            '
name|'internal_client'
op|'.'
name|'sleep'
op|'='
name|'old_sleep'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'3'
op|','
name|'client'
op|'.'
name|'sleep_called'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'4'
op|','
name|'client'
op|'.'
name|'tries'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_make_request_method_path_headers
dedent|''
name|'def'
name|'test_make_request_method_path_headers'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|InternalClient
indent|'        '
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'app'
op|'='
name|'self'
op|'.'
name|'fake_app'
newline|'\n'
name|'self'
op|'.'
name|'user_agent'
op|'='
string|"'some_agent'"
newline|'\n'
name|'self'
op|'.'
name|'request_tries'
op|'='
number|'3'
newline|'\n'
name|'self'
op|'.'
name|'env'
op|'='
name|'None'
newline|'\n'
nl|'\n'
DECL|member|fake_app
dedent|''
name|'def'
name|'fake_app'
op|'('
name|'self'
op|','
name|'env'
op|','
name|'start_response'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'env'
op|'='
name|'env'
newline|'\n'
name|'start_response'
op|'('
string|"'200 Ok'"
op|','
op|'['
op|'('
string|"'Content-Length'"
op|','
string|"'0'"
op|')'
op|']'
op|')'
newline|'\n'
name|'return'
op|'['
op|']'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'client'
op|'='
name|'InternalClient'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'method'
name|'in'
string|"'GET PUT HEAD'"
op|'.'
name|'split'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'client'
op|'.'
name|'make_request'
op|'('
name|'method'
op|','
string|"'/'"
op|','
op|'{'
op|'}'
op|','
op|'('
number|'200'
op|','
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'client'
op|'.'
name|'env'
op|'['
string|"'REQUEST_METHOD'"
op|']'
op|','
name|'method'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'for'
name|'path'
name|'in'
string|"'/one /two/three'"
op|'.'
name|'split'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'client'
op|'.'
name|'make_request'
op|'('
string|"'GET'"
op|','
name|'path'
op|','
op|'{'
string|"'X-Test'"
op|':'
name|'path'
op|'}'
op|','
op|'('
number|'200'
op|','
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'client'
op|'.'
name|'env'
op|'['
string|"'PATH_INFO'"
op|']'
op|','
name|'path'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'client'
op|'.'
name|'env'
op|'['
string|"'HTTP_X_TEST'"
op|']'
op|','
name|'path'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_make_request_codes
dedent|''
dedent|''
name|'def'
name|'test_make_request_codes'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|InternalClient
indent|'        '
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'app'
op|'='
name|'self'
op|'.'
name|'fake_app'
newline|'\n'
name|'self'
op|'.'
name|'user_agent'
op|'='
string|"'some_agent'"
newline|'\n'
name|'self'
op|'.'
name|'request_tries'
op|'='
number|'3'
newline|'\n'
nl|'\n'
DECL|member|fake_app
dedent|''
name|'def'
name|'fake_app'
op|'('
name|'self'
op|','
name|'env'
op|','
name|'start_response'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'start_response'
op|'('
string|"'200 Ok'"
op|','
op|'['
op|'('
string|"'Content-Length'"
op|','
string|"'0'"
op|')'
op|']'
op|')'
newline|'\n'
name|'return'
op|'['
op|']'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'client'
op|'='
name|'InternalClient'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'try'
op|':'
newline|'\n'
DECL|variable|old_sleep
indent|'            '
name|'old_sleep'
op|'='
name|'internal_client'
op|'.'
name|'sleep'
newline|'\n'
name|'internal_client'
op|'.'
name|'sleep'
op|'='
name|'not_sleep'
newline|'\n'
nl|'\n'
name|'client'
op|'.'
name|'make_request'
op|'('
string|"'GET'"
op|','
string|"'/'"
op|','
op|'{'
op|'}'
op|','
op|'('
number|'200'
op|','
op|')'
op|')'
newline|'\n'
name|'client'
op|'.'
name|'make_request'
op|'('
string|"'GET'"
op|','
string|"'/'"
op|','
op|'{'
op|'}'
op|','
op|'('
number|'2'
op|','
op|')'
op|')'
newline|'\n'
name|'client'
op|'.'
name|'make_request'
op|'('
string|"'GET'"
op|','
string|"'/'"
op|','
op|'{'
op|'}'
op|','
op|'('
number|'400'
op|','
number|'200'
op|')'
op|')'
newline|'\n'
name|'client'
op|'.'
name|'make_request'
op|'('
string|"'GET'"
op|','
string|"'/'"
op|','
op|'{'
op|'}'
op|','
op|'('
number|'400'
op|','
number|'2'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'client'
op|'.'
name|'make_request'
op|'('
string|"'GET'"
op|','
string|"'/'"
op|','
op|'{'
op|'}'
op|','
op|'('
number|'400'
op|','
op|')'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'Exception'
op|','
name|'err'
op|':'
newline|'\n'
indent|'                '
name|'exc'
op|'='
name|'err'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'200'
op|','
name|'err'
op|'.'
name|'resp'
op|'.'
name|'status_int'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'client'
op|'.'
name|'make_request'
op|'('
string|"'GET'"
op|','
string|"'/'"
op|','
op|'{'
op|'}'
op|','
op|'('
number|'201'
op|','
op|')'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'Exception'
op|','
name|'err'
op|':'
newline|'\n'
indent|'                '
name|'exc'
op|'='
name|'err'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'200'
op|','
name|'err'
op|'.'
name|'resp'
op|'.'
name|'status_int'
op|')'
newline|'\n'
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'            '
name|'internal_client'
op|'.'
name|'sleep'
op|'='
name|'old_sleep'
newline|'\n'
nl|'\n'
DECL|member|test_make_request_calls_fobj_seek_each_try
dedent|''
dedent|''
name|'def'
name|'test_make_request_calls_fobj_seek_each_try'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|FileObject
indent|'        '
name|'class'
name|'FileObject'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'seek_called'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|member|seek
dedent|''
name|'def'
name|'seek'
op|'('
name|'self'
op|','
name|'offset'
op|','
name|'whence'
op|'='
number|'0'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'seek_called'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
number|'0'
op|','
name|'offset'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
number|'0'
op|','
name|'whence'
op|')'
newline|'\n'
nl|'\n'
DECL|class|InternalClient
dedent|''
dedent|''
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'app'
op|'='
name|'self'
op|'.'
name|'fake_app'
newline|'\n'
name|'self'
op|'.'
name|'user_agent'
op|'='
string|"'some_agent'"
newline|'\n'
name|'self'
op|'.'
name|'request_tries'
op|'='
number|'3'
newline|'\n'
nl|'\n'
DECL|member|fake_app
dedent|''
name|'def'
name|'fake_app'
op|'('
name|'self'
op|','
name|'env'
op|','
name|'start_response'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'start_response'
op|'('
string|"'404 Not Found'"
op|','
op|'['
op|'('
string|"'Content-Length'"
op|','
string|"'0'"
op|')'
op|']'
op|')'
newline|'\n'
name|'return'
op|'['
op|']'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'fobj'
op|'='
name|'FileObject'
op|'('
name|'self'
op|')'
newline|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'try'
op|':'
newline|'\n'
DECL|variable|old_sleep
indent|'            '
name|'old_sleep'
op|'='
name|'internal_client'
op|'.'
name|'sleep'
newline|'\n'
name|'internal_client'
op|'.'
name|'sleep'
op|'='
name|'not_sleep'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'client'
op|'.'
name|'make_request'
op|'('
string|"'PUT'"
op|','
string|"'/'"
op|','
op|'{'
op|'}'
op|','
op|'('
number|'2'
op|','
op|')'
op|','
name|'fobj'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'Exception'
op|','
name|'err'
op|':'
newline|'\n'
indent|'                '
name|'exc'
op|'='
name|'err'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'404'
op|','
name|'err'
op|'.'
name|'resp'
op|'.'
name|'status_int'
op|')'
newline|'\n'
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'            '
name|'internal_client'
op|'.'
name|'sleep'
op|'='
name|'old_sleep'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'client'
op|'.'
name|'request_tries'
op|','
name|'fobj'
op|'.'
name|'seek_called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_make_request_request_exception
dedent|''
name|'def'
name|'test_make_request_request_exception'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|InternalClient
indent|'        '
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'app'
op|'='
name|'self'
op|'.'
name|'fake_app'
newline|'\n'
name|'self'
op|'.'
name|'user_agent'
op|'='
string|"'some_agent'"
newline|'\n'
name|'self'
op|'.'
name|'request_tries'
op|'='
number|'3'
newline|'\n'
nl|'\n'
DECL|member|fake_app
dedent|''
name|'def'
name|'fake_app'
op|'('
name|'self'
op|','
name|'env'
op|','
name|'start_response'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'Exception'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'client'
op|'='
name|'InternalClient'
op|'('
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
DECL|variable|old_sleep
indent|'            '
name|'old_sleep'
op|'='
name|'internal_client'
op|'.'
name|'sleep'
newline|'\n'
name|'internal_client'
op|'.'
name|'sleep'
op|'='
name|'not_sleep'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
nl|'\n'
name|'Exception'
op|','
name|'client'
op|'.'
name|'make_request'
op|','
string|"'GET'"
op|','
string|"'/'"
op|','
op|'{'
op|'}'
op|','
op|'('
number|'2'
op|','
op|')'
op|')'
newline|'\n'
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'            '
name|'internal_client'
op|'.'
name|'sleep'
op|'='
name|'old_sleep'
newline|'\n'
nl|'\n'
DECL|member|test_get_metadata
dedent|''
dedent|''
name|'def'
name|'test_get_metadata'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|Response
indent|'        '
name|'class'
name|'Response'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'headers'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'headers'
op|'='
name|'headers'
newline|'\n'
name|'self'
op|'.'
name|'status_int'
op|'='
number|'200'
newline|'\n'
nl|'\n'
DECL|class|InternalClient
dedent|''
dedent|''
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|','
name|'path'
op|','
name|'resp_headers'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\n'
name|'self'
op|'.'
name|'resp_headers'
op|'='
name|'resp_headers'
newline|'\n'
name|'self'
op|'.'
name|'make_request_called'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|member|make_request
dedent|''
name|'def'
name|'make_request'
op|'('
nl|'\n'
name|'self'
op|','
name|'method'
op|','
name|'path'
op|','
name|'headers'
op|','
name|'acceptable_statuses'
op|','
nl|'\n'
name|'body_file'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'make_request_called'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
string|"'HEAD'"
op|','
name|'method'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'path'
op|','
name|'path'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
op|'('
number|'2'
op|','
op|')'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'None'
op|','
name|'body_file'
op|')'
newline|'\n'
name|'return'
name|'Response'
op|'('
name|'self'
op|'.'
name|'resp_headers'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'path'
op|'='
string|"'some_path'"
newline|'\n'
name|'metadata_prefix'
op|'='
string|"'some_key-'"
newline|'\n'
name|'resp_headers'
op|'='
op|'{'
nl|'\n'
string|"'%sone'"
op|'%'
op|'('
name|'metadata_prefix'
op|')'
op|':'
string|"'1'"
op|','
nl|'\n'
string|"'%stwo'"
op|'%'
op|'('
name|'metadata_prefix'
op|')'
op|':'
string|"'2'"
op|','
nl|'\n'
string|"'%sthree'"
op|'%'
op|'('
name|'metadata_prefix'
op|')'
op|':'
string|"'3'"
op|','
nl|'\n'
string|"'some_header-four'"
op|':'
string|"'4'"
op|','
nl|'\n'
string|"'some_header-five'"
op|':'
string|"'5'"
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'exp_metadata'
op|'='
op|'{'
nl|'\n'
string|"'one'"
op|':'
string|"'1'"
op|','
nl|'\n'
string|"'two'"
op|':'
string|"'2'"
op|','
nl|'\n'
string|"'three'"
op|':'
string|"'3'"
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'self'
op|','
name|'path'
op|','
name|'resp_headers'
op|')'
newline|'\n'
name|'metadata'
op|'='
name|'client'
op|'.'
name|'_get_metadata'
op|'('
name|'path'
op|','
name|'metadata_prefix'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'exp_metadata'
op|','
name|'metadata'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'client'
op|'.'
name|'make_request_called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_metadata_invalid_status
dedent|''
name|'def'
name|'test_get_metadata_invalid_status'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|Response
indent|'        '
name|'class'
name|'Response'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'status_int'
op|'='
number|'404'
newline|'\n'
name|'self'
op|'.'
name|'headers'
op|'='
op|'{'
string|"'some_key'"
op|':'
string|"'some_value'"
op|'}'
newline|'\n'
nl|'\n'
DECL|class|InternalClient
dedent|''
dedent|''
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|make_request
dedent|''
name|'def'
name|'make_request'
op|'('
name|'self'
op|','
op|'*'
name|'a'
op|','
op|'**'
name|'kw'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'Response'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'client'
op|'='
name|'InternalClient'
op|'('
op|')'
newline|'\n'
name|'metadata'
op|'='
name|'client'
op|'.'
name|'_get_metadata'
op|'('
string|"'path'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
op|'{'
op|'}'
op|','
name|'metadata'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_make_path
dedent|''
name|'def'
name|'test_make_path'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|')'
newline|'\n'
nl|'\n'
name|'c'
op|'='
name|'InternalClient'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'path'
op|','
name|'c'
op|'.'
name|'make_path'
op|'('
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_make_path_exception
dedent|''
name|'def'
name|'test_make_path_exception'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'c'
op|'='
name|'InternalClient'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'ValueError'
op|','
name|'c'
op|'.'
name|'make_path'
op|','
string|"'account'"
op|','
name|'None'
op|','
string|"'obj'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_iter_items
dedent|''
name|'def'
name|'test_iter_items'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|Response
indent|'        '
name|'class'
name|'Response'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'status_int'
op|','
name|'body'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'status_int'
op|'='
name|'status_int'
newline|'\n'
name|'self'
op|'.'
name|'body'
op|'='
name|'body'
newline|'\n'
nl|'\n'
DECL|class|InternalClient
dedent|''
dedent|''
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|','
name|'responses'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'responses'
op|'='
name|'responses'
newline|'\n'
name|'self'
op|'.'
name|'make_request_called'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|member|make_request
dedent|''
name|'def'
name|'make_request'
op|'('
nl|'\n'
name|'self'
op|','
name|'method'
op|','
name|'path'
op|','
name|'headers'
op|','
name|'acceptable_statuses'
op|','
nl|'\n'
name|'body_file'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'make_request_called'
op|'+='
number|'1'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'responses'
op|'.'
name|'pop'
op|'('
number|'0'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'exp_items'
op|'='
op|'['
op|']'
newline|'\n'
name|'responses'
op|'='
op|'['
name|'Response'
op|'('
number|'200'
op|','
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
op|']'
newline|'\n'
name|'items'
op|'='
op|'['
op|']'
newline|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'self'
op|','
name|'responses'
op|')'
newline|'\n'
name|'for'
name|'item'
name|'in'
name|'client'
op|'.'
name|'_iter_items'
op|'('
string|"'/'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'items'
op|'.'
name|'append'
op|'('
name|'item'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'exp_items'
op|','
name|'items'
op|')'
newline|'\n'
nl|'\n'
name|'exp_items'
op|'='
op|'['
op|']'
newline|'\n'
name|'responses'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'xrange'
op|'('
number|'3'
op|')'
op|':'
newline|'\n'
DECL|variable|data
indent|'            '
name|'data'
op|'='
op|'['
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'item%02d'"
op|'%'
op|'('
number|'2'
op|'*'
name|'i'
op|')'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'name'"
op|':'
string|"'item%02d'"
op|'%'
op|'('
number|'2'
op|'*'
name|'i'
op|'+'
number|'1'
op|')'
op|'}'
op|']'
newline|'\n'
name|'responses'
op|'.'
name|'append'
op|'('
name|'Response'
op|'('
number|'200'
op|','
name|'json'
op|'.'
name|'dumps'
op|'('
name|'data'
op|')'
op|')'
op|')'
newline|'\n'
name|'exp_items'
op|'.'
name|'extend'
op|'('
name|'data'
op|')'
newline|'\n'
dedent|''
name|'responses'
op|'.'
name|'append'
op|'('
name|'Response'
op|'('
number|'204'
op|','
string|"''"
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'items'
op|'='
op|'['
op|']'
newline|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'self'
op|','
name|'responses'
op|')'
newline|'\n'
name|'for'
name|'item'
name|'in'
name|'client'
op|'.'
name|'_iter_items'
op|'('
string|"'/'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'items'
op|'.'
name|'append'
op|'('
name|'item'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'exp_items'
op|','
name|'items'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_iter_items_with_markers
dedent|''
name|'def'
name|'test_iter_items_with_markers'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|Response
indent|'        '
name|'class'
name|'Response'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'status_int'
op|','
name|'body'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'status_int'
op|'='
name|'status_int'
newline|'\n'
name|'self'
op|'.'
name|'body'
op|'='
name|'body'
newline|'\n'
nl|'\n'
DECL|class|InternalClient
dedent|''
dedent|''
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|','
name|'paths'
op|','
name|'responses'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'paths'
op|'='
name|'paths'
newline|'\n'
name|'self'
op|'.'
name|'responses'
op|'='
name|'responses'
newline|'\n'
nl|'\n'
DECL|member|make_request
dedent|''
name|'def'
name|'make_request'
op|'('
nl|'\n'
name|'self'
op|','
name|'method'
op|','
name|'path'
op|','
name|'headers'
op|','
name|'acceptable_statuses'
op|','
nl|'\n'
name|'body_file'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'exp_path'
op|'='
name|'self'
op|'.'
name|'paths'
op|'.'
name|'pop'
op|'('
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'exp_path'
op|','
name|'path'
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'responses'
op|'.'
name|'pop'
op|'('
number|'0'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'paths'
op|'='
op|'['
nl|'\n'
string|"'/?format=json&marker=start&end_marker=end'"
op|','
nl|'\n'
string|"'/?format=json&marker=one%C3%A9&end_marker=end'"
op|','
nl|'\n'
string|"'/?format=json&marker=two&end_marker=end'"
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
name|'responses'
op|'='
op|'['
nl|'\n'
name|'Response'
op|'('
number|'200'
op|','
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'one\\xc3\\xa9'"
op|'}'
op|','
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'Response'
op|'('
number|'200'
op|','
name|'json'
op|'.'
name|'dumps'
op|'('
op|'['
op|'{'
string|"'name'"
op|':'
string|"'two'"
op|'}'
op|','
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'Response'
op|'('
number|'204'
op|','
string|"''"
op|')'
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
name|'items'
op|'='
op|'['
op|']'
newline|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'self'
op|','
name|'paths'
op|','
name|'responses'
op|')'
newline|'\n'
name|'for'
name|'item'
name|'in'
name|'client'
op|'.'
name|'_iter_items'
op|'('
string|"'/'"
op|','
name|'marker'
op|'='
string|"'start'"
op|','
name|'end_marker'
op|'='
string|"'end'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'items'
op|'.'
name|'append'
op|'('
name|'item'
op|'['
string|"'name'"
op|']'
op|'.'
name|'encode'
op|'('
string|"'utf8'"
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEquals'
op|'('
string|"'one\\xc3\\xa9 two'"
op|'.'
name|'split'
op|'('
op|')'
op|','
name|'items'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_set_metadata
dedent|''
name|'def'
name|'test_set_metadata'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|InternalClient
indent|'        '
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|','
name|'path'
op|','
name|'exp_headers'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\n'
name|'self'
op|'.'
name|'exp_headers'
op|'='
name|'exp_headers'
newline|'\n'
name|'self'
op|'.'
name|'make_request_called'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|member|make_request
dedent|''
name|'def'
name|'make_request'
op|'('
nl|'\n'
name|'self'
op|','
name|'method'
op|','
name|'path'
op|','
name|'headers'
op|','
name|'acceptable_statuses'
op|','
nl|'\n'
name|'body_file'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'make_request_called'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
string|"'POST'"
op|','
name|'method'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'path'
op|','
name|'path'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'exp_headers'
op|','
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
op|'('
number|'2'
op|','
op|')'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'None'
op|','
name|'body_file'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'path'
op|'='
string|"'some_path'"
newline|'\n'
name|'metadata_prefix'
op|'='
string|"'some_key-'"
newline|'\n'
name|'metadata'
op|'='
op|'{'
nl|'\n'
string|"'%sone'"
op|'%'
op|'('
name|'metadata_prefix'
op|')'
op|':'
string|"'1'"
op|','
nl|'\n'
string|"'%stwo'"
op|'%'
op|'('
name|'metadata_prefix'
op|')'
op|':'
string|"'2'"
op|','
nl|'\n'
string|"'three'"
op|':'
string|"'3'"
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'exp_headers'
op|'='
op|'{'
nl|'\n'
string|"'%sone'"
op|'%'
op|'('
name|'metadata_prefix'
op|')'
op|':'
string|"'1'"
op|','
nl|'\n'
string|"'%stwo'"
op|'%'
op|'('
name|'metadata_prefix'
op|')'
op|':'
string|"'2'"
op|','
nl|'\n'
string|"'%sthree'"
op|'%'
op|'('
name|'metadata_prefix'
op|')'
op|':'
string|"'3'"
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'self'
op|','
name|'path'
op|','
name|'exp_headers'
op|')'
newline|'\n'
name|'client'
op|'.'
name|'_set_metadata'
op|'('
name|'path'
op|','
name|'metadata'
op|','
name|'metadata_prefix'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'client'
op|'.'
name|'make_request_called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_iter_containers
dedent|''
name|'def'
name|'test_iter_containers'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|')'
newline|'\n'
name|'items'
op|'='
string|"'0 1 2'"
op|'.'
name|'split'
op|'('
op|')'
newline|'\n'
name|'marker'
op|'='
string|"'some_marker'"
newline|'\n'
name|'end_marker'
op|'='
string|"'some_end_marker'"
newline|'\n'
name|'acceptable_statuses'
op|'='
string|"'some_status_list'"
newline|'\n'
name|'client'
op|'='
name|'IterInternalClient'
op|'('
nl|'\n'
name|'self'
op|','
name|'path'
op|','
name|'marker'
op|','
name|'end_marker'
op|','
name|'acceptable_statuses'
op|','
name|'items'
op|')'
newline|'\n'
name|'ret_items'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'container'
name|'in'
name|'client'
op|'.'
name|'iter_containers'
op|'('
nl|'\n'
name|'account'
op|','
name|'marker'
op|','
name|'end_marker'
op|','
nl|'\n'
name|'acceptable_statuses'
op|'='
name|'acceptable_statuses'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'ret_items'
op|'.'
name|'append'
op|'('
name|'container'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'items'
op|','
name|'ret_items'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_account_info
dedent|''
name|'def'
name|'test_get_account_info'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|Response
indent|'        '
name|'class'
name|'Response'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'containers'
op|','
name|'objects'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'headers'
op|'='
op|'{'
nl|'\n'
string|"'x-account-container-count'"
op|':'
name|'containers'
op|','
nl|'\n'
string|"'x-account-object-count'"
op|':'
name|'objects'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
DECL|class|InternalClient
dedent|''
dedent|''
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|','
name|'path'
op|','
name|'resp'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\n'
name|'self'
op|'.'
name|'resp'
op|'='
name|'resp'
newline|'\n'
nl|'\n'
DECL|member|make_request
dedent|''
name|'def'
name|'make_request'
op|'('
nl|'\n'
name|'self'
op|','
name|'method'
op|','
name|'path'
op|','
name|'headers'
op|','
name|'acceptable_statuses'
op|','
nl|'\n'
name|'body_file'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
string|"'HEAD'"
op|','
name|'method'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'path'
op|','
name|'path'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
op|'{'
op|'}'
op|','
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
op|'('
number|'2'
op|','
number|'404'
op|')'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'None'
op|','
name|'body_file'
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'resp'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|')'
newline|'\n'
name|'containers'
op|','
name|'objects'
op|'='
number|'10'
op|','
number|'100'
newline|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'self'
op|','
name|'path'
op|','
name|'Response'
op|'('
name|'containers'
op|','
name|'objects'
op|')'
op|')'
newline|'\n'
name|'info'
op|'='
name|'client'
op|'.'
name|'get_account_info'
op|'('
name|'account'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
op|'('
name|'containers'
op|','
name|'objects'
op|')'
op|','
name|'info'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_account_metadata
dedent|''
name|'def'
name|'test_get_account_metadata'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|')'
newline|'\n'
name|'acceptable_statuses'
op|'='
string|"'some_status_list'"
newline|'\n'
name|'metadata_prefix'
op|'='
string|"'some_metadata_prefix'"
newline|'\n'
name|'client'
op|'='
name|'GetMetadataInternalClient'
op|'('
nl|'\n'
name|'self'
op|','
name|'path'
op|','
name|'metadata_prefix'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'metadata'
op|'='
name|'client'
op|'.'
name|'get_account_metadata'
op|'('
nl|'\n'
name|'account'
op|','
name|'metadata_prefix'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'client'
op|'.'
name|'metadata'
op|','
name|'metadata'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'client'
op|'.'
name|'get_metadata_called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_set_account_metadata
dedent|''
name|'def'
name|'test_set_account_metadata'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|')'
newline|'\n'
name|'metadata'
op|'='
string|"'some_metadata'"
newline|'\n'
name|'metadata_prefix'
op|'='
string|"'some_metadata_prefix'"
newline|'\n'
name|'acceptable_statuses'
op|'='
string|"'some_status_list'"
newline|'\n'
name|'client'
op|'='
name|'SetMetadataInternalClient'
op|'('
nl|'\n'
name|'self'
op|','
name|'path'
op|','
name|'metadata'
op|','
name|'metadata_prefix'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'client'
op|'.'
name|'set_account_metadata'
op|'('
nl|'\n'
name|'account'
op|','
name|'metadata'
op|','
name|'metadata_prefix'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'client'
op|'.'
name|'set_metadata_called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_container_exists
dedent|''
name|'def'
name|'test_container_exists'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|Response
indent|'        '
name|'class'
name|'Response'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'status_int'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'status_int'
op|'='
name|'status_int'
newline|'\n'
nl|'\n'
DECL|class|InternalClient
dedent|''
dedent|''
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|','
name|'path'
op|','
name|'resp'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\n'
name|'self'
op|'.'
name|'make_request_called'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'resp'
op|'='
name|'resp'
newline|'\n'
nl|'\n'
DECL|member|make_request
dedent|''
name|'def'
name|'make_request'
op|'('
nl|'\n'
name|'self'
op|','
name|'method'
op|','
name|'path'
op|','
name|'headers'
op|','
name|'acceptable_statuses'
op|','
nl|'\n'
name|'body_file'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'make_request_called'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
string|"'HEAD'"
op|','
name|'method'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'path'
op|','
name|'path'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
op|'{'
op|'}'
op|','
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
op|'('
number|'2'
op|','
number|'404'
op|')'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'None'
op|','
name|'body_file'
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'resp'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|','
name|'container'
op|')'
newline|'\n'
nl|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'self'
op|','
name|'path'
op|','
name|'Response'
op|'('
number|'200'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'True'
op|','
name|'client'
op|'.'
name|'container_exists'
op|'('
name|'account'
op|','
name|'container'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'client'
op|'.'
name|'make_request_called'
op|')'
newline|'\n'
nl|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'self'
op|','
name|'path'
op|','
name|'Response'
op|'('
number|'404'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'False'
op|','
name|'client'
op|'.'
name|'container_exists'
op|'('
name|'account'
op|','
name|'container'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'client'
op|'.'
name|'make_request_called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_container
dedent|''
name|'def'
name|'test_create_container'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|InternalClient
indent|'        '
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|','
name|'path'
op|','
name|'headers'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\n'
name|'self'
op|'.'
name|'headers'
op|'='
name|'headers'
newline|'\n'
name|'self'
op|'.'
name|'make_request_called'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|member|make_request
dedent|''
name|'def'
name|'make_request'
op|'('
nl|'\n'
name|'self'
op|','
name|'method'
op|','
name|'path'
op|','
name|'headers'
op|','
name|'acceptable_statuses'
op|','
nl|'\n'
name|'body_file'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'make_request_called'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
string|"'PUT'"
op|','
name|'method'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'path'
op|','
name|'path'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'headers'
op|','
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
op|'('
number|'2'
op|','
op|')'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'None'
op|','
name|'body_file'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|','
name|'container'
op|')'
newline|'\n'
name|'headers'
op|'='
string|"'some_headers'"
newline|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'self'
op|','
name|'path'
op|','
name|'headers'
op|')'
newline|'\n'
name|'client'
op|'.'
name|'create_container'
op|'('
name|'account'
op|','
name|'container'
op|','
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'client'
op|'.'
name|'make_request_called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_delete_container
dedent|''
name|'def'
name|'test_delete_container'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|InternalClient
indent|'        '
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|','
name|'path'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\n'
name|'self'
op|'.'
name|'make_request_called'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|member|make_request
dedent|''
name|'def'
name|'make_request'
op|'('
nl|'\n'
name|'self'
op|','
name|'method'
op|','
name|'path'
op|','
name|'headers'
op|','
name|'acceptable_statuses'
op|','
nl|'\n'
name|'body_file'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'make_request_called'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
string|"'DELETE'"
op|','
name|'method'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'path'
op|','
name|'path'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
op|'{'
op|'}'
op|','
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
op|'('
number|'2'
op|','
number|'404'
op|')'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'None'
op|','
name|'body_file'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|','
name|'container'
op|')'
newline|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'self'
op|','
name|'path'
op|')'
newline|'\n'
name|'client'
op|'.'
name|'delete_container'
op|'('
name|'account'
op|','
name|'container'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'client'
op|'.'
name|'make_request_called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_container_metadata
dedent|''
name|'def'
name|'test_get_container_metadata'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|','
name|'container'
op|')'
newline|'\n'
name|'metadata_prefix'
op|'='
string|"'some_metadata_prefix'"
newline|'\n'
name|'acceptable_statuses'
op|'='
string|"'some_status_list'"
newline|'\n'
name|'client'
op|'='
name|'GetMetadataInternalClient'
op|'('
nl|'\n'
name|'self'
op|','
name|'path'
op|','
name|'metadata_prefix'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'metadata'
op|'='
name|'client'
op|'.'
name|'get_container_metadata'
op|'('
nl|'\n'
name|'account'
op|','
name|'container'
op|','
name|'metadata_prefix'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'client'
op|'.'
name|'metadata'
op|','
name|'metadata'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'client'
op|'.'
name|'get_metadata_called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_iter_objects
dedent|''
name|'def'
name|'test_iter_objects'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|','
name|'container'
op|')'
newline|'\n'
name|'marker'
op|'='
string|"'some_maker'"
newline|'\n'
name|'end_marker'
op|'='
string|"'some_end_marker'"
newline|'\n'
name|'acceptable_statuses'
op|'='
string|"'some_status_list'"
newline|'\n'
name|'items'
op|'='
string|"'0 1 2'"
op|'.'
name|'split'
op|'('
op|')'
newline|'\n'
name|'client'
op|'='
name|'IterInternalClient'
op|'('
nl|'\n'
name|'self'
op|','
name|'path'
op|','
name|'marker'
op|','
name|'end_marker'
op|','
name|'acceptable_statuses'
op|','
name|'items'
op|')'
newline|'\n'
name|'ret_items'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'obj'
name|'in'
name|'client'
op|'.'
name|'iter_objects'
op|'('
nl|'\n'
name|'account'
op|','
name|'container'
op|','
name|'marker'
op|','
name|'end_marker'
op|','
name|'acceptable_statuses'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'ret_items'
op|'.'
name|'append'
op|'('
name|'obj'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'items'
op|','
name|'ret_items'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_set_container_metadata
dedent|''
name|'def'
name|'test_set_container_metadata'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|','
name|'container'
op|')'
newline|'\n'
name|'metadata'
op|'='
string|"'some_metadata'"
newline|'\n'
name|'metadata_prefix'
op|'='
string|"'some_metadata_prefix'"
newline|'\n'
name|'acceptable_statuses'
op|'='
string|"'some_status_list'"
newline|'\n'
name|'client'
op|'='
name|'SetMetadataInternalClient'
op|'('
nl|'\n'
name|'self'
op|','
name|'path'
op|','
name|'metadata'
op|','
name|'metadata_prefix'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'client'
op|'.'
name|'set_container_metadata'
op|'('
nl|'\n'
name|'account'
op|','
name|'container'
op|','
name|'metadata'
op|','
name|'metadata_prefix'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'client'
op|'.'
name|'set_metadata_called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_delete_object
dedent|''
name|'def'
name|'test_delete_object'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|InternalClient
indent|'        '
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|','
name|'path'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\n'
name|'self'
op|'.'
name|'make_request_called'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|member|make_request
dedent|''
name|'def'
name|'make_request'
op|'('
nl|'\n'
name|'self'
op|','
name|'method'
op|','
name|'path'
op|','
name|'headers'
op|','
name|'acceptable_statuses'
op|','
nl|'\n'
name|'body_file'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'make_request_called'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
string|"'DELETE'"
op|','
name|'method'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'path'
op|','
name|'path'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
op|'{'
op|'}'
op|','
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
op|'('
number|'2'
op|','
number|'404'
op|')'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'None'
op|','
name|'body_file'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|')'
newline|'\n'
nl|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'self'
op|','
name|'path'
op|')'
newline|'\n'
name|'client'
op|'.'
name|'delete_object'
op|'('
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'client'
op|'.'
name|'make_request_called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_object_metadata
dedent|''
name|'def'
name|'test_get_object_metadata'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|')'
newline|'\n'
name|'metadata_prefix'
op|'='
string|"'some_metadata_prefix'"
newline|'\n'
name|'acceptable_statuses'
op|'='
string|"'some_status_list'"
newline|'\n'
name|'client'
op|'='
name|'GetMetadataInternalClient'
op|'('
nl|'\n'
name|'self'
op|','
name|'path'
op|','
name|'metadata_prefix'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'metadata'
op|'='
name|'client'
op|'.'
name|'get_object_metadata'
op|'('
nl|'\n'
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|','
name|'metadata_prefix'
op|','
nl|'\n'
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'client'
op|'.'
name|'metadata'
op|','
name|'metadata'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'client'
op|'.'
name|'get_metadata_called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_iter_object_lines
dedent|''
name|'def'
name|'test_iter_object_lines'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|InternalClient
indent|'        '
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'lines'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'lines'
op|'='
name|'lines'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'='
name|'self'
op|'.'
name|'fake_app'
newline|'\n'
name|'self'
op|'.'
name|'user_agent'
op|'='
string|"'some_agent'"
newline|'\n'
name|'self'
op|'.'
name|'request_tries'
op|'='
number|'3'
newline|'\n'
nl|'\n'
DECL|member|fake_app
dedent|''
name|'def'
name|'fake_app'
op|'('
name|'self'
op|','
name|'env'
op|','
name|'start_response'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'start_response'
op|'('
string|"'200 Ok'"
op|','
op|'['
op|'('
string|"'Content-Length'"
op|','
string|"'0'"
op|')'
op|']'
op|')'
newline|'\n'
name|'return'
op|'['
string|"'%s\\n'"
op|'%'
name|'x'
name|'for'
name|'x'
name|'in'
name|'self'
op|'.'
name|'lines'
op|']'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'lines'
op|'='
string|"'line1 line2 line3'"
op|'.'
name|'split'
op|'('
op|')'
newline|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'lines'
op|')'
newline|'\n'
name|'ret_lines'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'line'
name|'in'
name|'client'
op|'.'
name|'iter_object_lines'
op|'('
string|"'account'"
op|','
string|"'container'"
op|','
string|"'object'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'ret_lines'
op|'.'
name|'append'
op|'('
name|'line'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'lines'
op|','
name|'ret_lines'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_iter_object_lines_compressed_object
dedent|''
name|'def'
name|'test_iter_object_lines_compressed_object'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|InternalClient
indent|'        '
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'lines'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'lines'
op|'='
name|'lines'
newline|'\n'
name|'self'
op|'.'
name|'app'
op|'='
name|'self'
op|'.'
name|'fake_app'
newline|'\n'
name|'self'
op|'.'
name|'user_agent'
op|'='
string|"'some_agent'"
newline|'\n'
name|'self'
op|'.'
name|'request_tries'
op|'='
number|'3'
newline|'\n'
nl|'\n'
DECL|member|fake_app
dedent|''
name|'def'
name|'fake_app'
op|'('
name|'self'
op|','
name|'env'
op|','
name|'start_response'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'start_response'
op|'('
string|"'200 Ok'"
op|','
op|'['
op|'('
string|"'Content-Length'"
op|','
string|"'0'"
op|')'
op|']'
op|')'
newline|'\n'
name|'return'
name|'internal_client'
op|'.'
name|'CompressingFileReader'
op|'('
nl|'\n'
name|'StringIO'
op|'('
string|"'\\n'"
op|'.'
name|'join'
op|'('
name|'self'
op|'.'
name|'lines'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'lines'
op|'='
string|"'line1 line2 line3'"
op|'.'
name|'split'
op|'('
op|')'
newline|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'lines'
op|')'
newline|'\n'
name|'ret_lines'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'line'
name|'in'
name|'client'
op|'.'
name|'iter_object_lines'
op|'('
nl|'\n'
string|"'account'"
op|','
string|"'container'"
op|','
string|"'object.gz'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'ret_lines'
op|'.'
name|'append'
op|'('
name|'line'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'lines'
op|','
name|'ret_lines'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_set_object_metadata
dedent|''
name|'def'
name|'test_set_object_metadata'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|')'
newline|'\n'
name|'metadata'
op|'='
string|"'some_metadata'"
newline|'\n'
name|'metadata_prefix'
op|'='
string|"'some_metadata_prefix'"
newline|'\n'
name|'acceptable_statuses'
op|'='
string|"'some_status_list'"
newline|'\n'
name|'client'
op|'='
name|'SetMetadataInternalClient'
op|'('
nl|'\n'
name|'self'
op|','
name|'path'
op|','
name|'metadata'
op|','
name|'metadata_prefix'
op|','
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'client'
op|'.'
name|'set_object_metadata'
op|'('
nl|'\n'
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|','
name|'metadata'
op|','
name|'metadata_prefix'
op|','
nl|'\n'
name|'acceptable_statuses'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'client'
op|'.'
name|'set_metadata_called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_upload_object
dedent|''
name|'def'
name|'test_upload_object'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|InternalClient
indent|'        '
name|'class'
name|'InternalClient'
op|'('
name|'internal_client'
op|'.'
name|'InternalClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'test'
op|','
name|'path'
op|','
name|'headers'
op|','
name|'fobj'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'test'
op|'='
name|'test'
newline|'\n'
name|'self'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\n'
name|'self'
op|'.'
name|'headers'
op|'='
name|'headers'
newline|'\n'
name|'self'
op|'.'
name|'fobj'
op|'='
name|'fobj'
newline|'\n'
name|'self'
op|'.'
name|'make_request_called'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|member|make_request
dedent|''
name|'def'
name|'make_request'
op|'('
nl|'\n'
name|'self'
op|','
name|'method'
op|','
name|'path'
op|','
name|'headers'
op|','
name|'acceptable_statuses'
op|','
nl|'\n'
name|'body_file'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'make_request_called'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'path'
op|','
name|'path'
op|')'
newline|'\n'
name|'exp_headers'
op|'='
name|'dict'
op|'('
name|'self'
op|'.'
name|'headers'
op|')'
newline|'\n'
name|'exp_headers'
op|'['
string|"'Transfer-Encoding'"
op|']'
op|'='
string|"'chunked'"
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'exp_headers'
op|','
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'test'
op|'.'
name|'assertEquals'
op|'('
name|'self'
op|'.'
name|'fobj'
op|','
name|'fobj'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'fobj'
op|'='
string|"'some_fobj'"
newline|'\n'
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|'='
name|'path_parts'
op|'('
op|')'
newline|'\n'
name|'path'
op|'='
name|'make_path'
op|'('
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|')'
newline|'\n'
name|'headers'
op|'='
op|'{'
string|"'key'"
op|':'
string|"'value'"
op|'}'
newline|'\n'
nl|'\n'
name|'client'
op|'='
name|'InternalClient'
op|'('
name|'self'
op|','
name|'path'
op|','
name|'headers'
op|','
name|'fobj'
op|')'
newline|'\n'
name|'client'
op|'.'
name|'upload_object'
op|'('
name|'fobj'
op|','
name|'account'
op|','
name|'container'
op|','
name|'obj'
op|','
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
number|'1'
op|','
name|'client'
op|'.'
name|'make_request_called'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
name|'__name__'
op|'=='
string|"'__main__'"
op|':'
newline|'\n'
indent|'    '
name|'unittest'
op|'.'
name|'main'
op|'('
op|')'
newline|'\n'
dedent|''
endmarker|''
end_unit
