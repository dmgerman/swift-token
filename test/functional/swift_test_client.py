begin_unit
comment|'# Copyright (c) 2010-2012 OpenStack Foundation'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Licensed under the Apache License, Version 2.0 (the "License");'
nl|'\n'
comment|'# you may not use this file except in compliance with the License.'
nl|'\n'
comment|'# You may obtain a copy of the License at'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    http://www.apache.org/licenses/LICENSE-2.0'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Unless required by applicable law or agreed to in writing, software'
nl|'\n'
comment|'# distributed under the License is distributed on an "AS IS" BASIS,'
nl|'\n'
comment|'# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or'
nl|'\n'
comment|'# implied.'
nl|'\n'
comment|'# See the License for the specific language governing permissions and'
nl|'\n'
comment|'# limitations under the License.'
nl|'\n'
nl|'\n'
name|'import'
name|'hashlib'
newline|'\n'
name|'import'
name|'httplib'
newline|'\n'
name|'import'
name|'os'
newline|'\n'
name|'import'
name|'random'
newline|'\n'
name|'import'
name|'socket'
newline|'\n'
name|'import'
name|'StringIO'
newline|'\n'
name|'import'
name|'time'
newline|'\n'
name|'import'
name|'urllib'
newline|'\n'
nl|'\n'
name|'import'
name|'simplejson'
name|'as'
name|'json'
newline|'\n'
nl|'\n'
name|'from'
name|'nose'
name|'import'
name|'SkipTest'
newline|'\n'
name|'from'
name|'xml'
op|'.'
name|'dom'
name|'import'
name|'minidom'
newline|'\n'
name|'from'
name|'swiftclient'
name|'import'
name|'get_auth'
newline|'\n'
nl|'\n'
name|'from'
name|'test'
name|'import'
name|'safe_repr'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|AuthenticationFailed
name|'class'
name|'AuthenticationFailed'
op|'('
name|'Exception'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|RequestError
dedent|''
name|'class'
name|'RequestError'
op|'('
name|'Exception'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ResponseError
dedent|''
name|'class'
name|'ResponseError'
op|'('
name|'Exception'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'response'
op|','
name|'method'
op|'='
name|'None'
op|','
name|'path'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'status'
op|'='
name|'response'
op|'.'
name|'status'
newline|'\n'
name|'self'
op|'.'
name|'reason'
op|'='
name|'response'
op|'.'
name|'reason'
newline|'\n'
name|'self'
op|'.'
name|'method'
op|'='
name|'method'
newline|'\n'
name|'self'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\n'
name|'self'
op|'.'
name|'headers'
op|'='
name|'response'
op|'.'
name|'getheaders'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'name'
op|','
name|'value'
name|'in'
name|'self'
op|'.'
name|'headers'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'name'
op|'.'
name|'lower'
op|'('
op|')'
op|'=='
string|"'x-trans-id'"
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'txid'
op|'='
name|'value'
newline|'\n'
name|'break'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'txid'
op|'='
name|'None'
newline|'\n'
nl|'\n'
dedent|''
name|'super'
op|'('
name|'ResponseError'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|__str__
dedent|''
name|'def'
name|'__str__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'repr'
op|'('
name|'self'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__repr__
dedent|''
name|'def'
name|'__repr__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
string|"'%d: %r (%r %r) txid=%s'"
op|'%'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'status'
op|','
name|'self'
op|'.'
name|'reason'
op|','
name|'self'
op|'.'
name|'method'
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'self'
op|'.'
name|'txid'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|listing_empty
dedent|''
dedent|''
name|'def'
name|'listing_empty'
op|'('
name|'method'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'for'
name|'i'
name|'in'
name|'xrange'
op|'('
number|'6'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'len'
op|'('
name|'method'
op|'('
op|')'
op|')'
op|'=='
number|'0'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'True'
newline|'\n'
nl|'\n'
dedent|''
name|'time'
op|'.'
name|'sleep'
op|'('
number|'2'
op|'**'
name|'i'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'False'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|listing_items
dedent|''
name|'def'
name|'listing_items'
op|'('
name|'method'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'marker'
op|'='
name|'None'
newline|'\n'
name|'once'
op|'='
name|'True'
newline|'\n'
name|'items'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
name|'while'
name|'once'
name|'or'
name|'items'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'i'
name|'in'
name|'items'
op|':'
newline|'\n'
indent|'            '
name|'yield'
name|'i'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'once'
name|'or'
name|'marker'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'marker'
op|':'
newline|'\n'
indent|'                '
name|'items'
op|'='
name|'method'
op|'('
name|'parms'
op|'='
op|'{'
string|"'marker'"
op|':'
name|'marker'
op|'}'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'items'
op|'='
name|'method'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'len'
op|'('
name|'items'
op|')'
op|'=='
number|'10000'
op|':'
newline|'\n'
indent|'                '
name|'marker'
op|'='
name|'items'
op|'['
op|'-'
number|'1'
op|']'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'marker'
op|'='
name|'None'
newline|'\n'
nl|'\n'
dedent|''
name|'once'
op|'='
name|'False'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'items'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|Connection
dedent|''
dedent|''
dedent|''
name|'class'
name|'Connection'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'config'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'key'
name|'in'
string|"'auth_host auth_port auth_ssl username password'"
op|'.'
name|'split'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'key'
name|'not'
name|'in'
name|'config'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'SkipTest'
op|'('
nl|'\n'
string|'"Missing required configuration parameter: %s"'
op|'%'
name|'key'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'self'
op|'.'
name|'auth_host'
op|'='
name|'config'
op|'['
string|"'auth_host'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'auth_port'
op|'='
name|'int'
op|'('
name|'config'
op|'['
string|"'auth_port'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'auth_ssl'
op|'='
name|'config'
op|'['
string|"'auth_ssl'"
op|']'
name|'in'
op|'('
string|"'on'"
op|','
string|"'true'"
op|','
string|"'yes'"
op|','
string|"'1'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'auth_prefix'
op|'='
name|'config'
op|'.'
name|'get'
op|'('
string|"'auth_prefix'"
op|','
string|"'/'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'auth_version'
op|'='
name|'str'
op|'('
name|'config'
op|'.'
name|'get'
op|'('
string|"'auth_version'"
op|','
string|"'1'"
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'account'
op|'='
name|'config'
op|'.'
name|'get'
op|'('
string|"'account'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'username'
op|'='
name|'config'
op|'['
string|"'username'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'password'
op|'='
name|'config'
op|'['
string|"'password'"
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'storage_host'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'storage_port'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'storage_url'
op|'='
name|'None'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'conn_class'
op|'='
name|'None'
newline|'\n'
nl|'\n'
DECL|member|get_account
dedent|''
name|'def'
name|'get_account'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'Account'
op|'('
name|'self'
op|','
name|'self'
op|'.'
name|'account'
op|')'
newline|'\n'
nl|'\n'
DECL|member|authenticate
dedent|''
name|'def'
name|'authenticate'
op|'('
name|'self'
op|','
name|'clone_conn'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'clone_conn'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'conn_class'
op|'='
name|'clone_conn'
op|'.'
name|'conn_class'
newline|'\n'
name|'self'
op|'.'
name|'storage_host'
op|'='
name|'clone_conn'
op|'.'
name|'storage_host'
newline|'\n'
name|'self'
op|'.'
name|'storage_url'
op|'='
name|'clone_conn'
op|'.'
name|'storage_url'
newline|'\n'
name|'self'
op|'.'
name|'storage_port'
op|'='
name|'clone_conn'
op|'.'
name|'storage_port'
newline|'\n'
name|'self'
op|'.'
name|'storage_token'
op|'='
name|'clone_conn'
op|'.'
name|'storage_token'
newline|'\n'
name|'return'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'auth_version'
op|'=='
string|'"1"'
op|':'
newline|'\n'
indent|'            '
name|'auth_path'
op|'='
string|"'%sv1.0'"
op|'%'
op|'('
name|'self'
op|'.'
name|'auth_prefix'
op|')'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'account'
op|':'
newline|'\n'
indent|'                '
name|'auth_user'
op|'='
string|"'%s:%s'"
op|'%'
op|'('
name|'self'
op|'.'
name|'account'
op|','
name|'self'
op|'.'
name|'username'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'auth_user'
op|'='
name|'self'
op|'.'
name|'username'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'auth_user'
op|'='
name|'self'
op|'.'
name|'username'
newline|'\n'
name|'auth_path'
op|'='
name|'self'
op|'.'
name|'auth_prefix'
newline|'\n'
dedent|''
name|'auth_scheme'
op|'='
string|"'https://'"
name|'if'
name|'self'
op|'.'
name|'auth_ssl'
name|'else'
string|"'http://'"
newline|'\n'
name|'auth_netloc'
op|'='
string|'"%s:%d"'
op|'%'
op|'('
name|'self'
op|'.'
name|'auth_host'
op|','
name|'self'
op|'.'
name|'auth_port'
op|')'
newline|'\n'
name|'auth_url'
op|'='
name|'auth_scheme'
op|'+'
name|'auth_netloc'
op|'+'
name|'auth_path'
newline|'\n'
nl|'\n'
op|'('
name|'storage_url'
op|','
name|'storage_token'
op|')'
op|'='
name|'get_auth'
op|'('
nl|'\n'
name|'auth_url'
op|','
name|'auth_user'
op|','
name|'self'
op|'.'
name|'password'
op|','
name|'snet'
op|'='
name|'False'
op|','
nl|'\n'
name|'tenant_name'
op|'='
name|'self'
op|'.'
name|'account'
op|','
name|'auth_version'
op|'='
name|'self'
op|'.'
name|'auth_version'
op|','
nl|'\n'
name|'os_options'
op|'='
op|'{'
op|'}'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'not'
op|'('
name|'storage_url'
name|'and'
name|'storage_token'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'AuthenticationFailed'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'x'
op|'='
name|'storage_url'
op|'.'
name|'split'
op|'('
string|"'/'"
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'x'
op|'['
number|'0'
op|']'
op|'=='
string|"'http:'"
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'conn_class'
op|'='
name|'httplib'
op|'.'
name|'HTTPConnection'
newline|'\n'
name|'self'
op|'.'
name|'storage_port'
op|'='
number|'80'
newline|'\n'
dedent|''
name|'elif'
name|'x'
op|'['
number|'0'
op|']'
op|'=='
string|"'https:'"
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'conn_class'
op|'='
name|'httplib'
op|'.'
name|'HTTPSConnection'
newline|'\n'
name|'self'
op|'.'
name|'storage_port'
op|'='
number|'443'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ValueError'
op|'('
string|"'unexpected protocol %s'"
op|'%'
op|'('
name|'x'
op|'['
number|'0'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'storage_host'
op|'='
name|'x'
op|'['
number|'2'
op|']'
op|'.'
name|'split'
op|'('
string|"':'"
op|')'
op|'['
number|'0'
op|']'
newline|'\n'
name|'if'
string|"':'"
name|'in'
name|'x'
op|'['
number|'2'
op|']'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'storage_port'
op|'='
name|'int'
op|'('
name|'x'
op|'['
number|'2'
op|']'
op|'.'
name|'split'
op|'('
string|"':'"
op|')'
op|'['
number|'1'
op|']'
op|')'
newline|'\n'
comment|'# Make sure storage_url is a string and not unicode, since'
nl|'\n'
comment|'# keystoneclient (called by swiftclient) returns them in'
nl|'\n'
comment|'# unicode and this would cause troubles when doing'
nl|'\n'
comment|'# no_safe_quote query.'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'storage_url'
op|'='
name|'str'
op|'('
string|"'/%s/%s'"
op|'%'
op|'('
name|'x'
op|'['
number|'3'
op|']'
op|','
name|'x'
op|'['
number|'4'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'storage_token'
op|'='
name|'storage_token'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'http_connect'
op|'('
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'storage_url'
op|','
name|'self'
op|'.'
name|'storage_token'
newline|'\n'
nl|'\n'
DECL|member|cluster_info
dedent|''
name|'def'
name|'cluster_info'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Retrieve the data in /info, or {} on 404\n        """'
newline|'\n'
name|'status'
op|'='
name|'self'
op|'.'
name|'make_request'
op|'('
string|"'GET'"
op|','
string|"'/info'"
op|','
nl|'\n'
name|'cfg'
op|'='
op|'{'
string|"'absolute_path'"
op|':'
name|'True'
op|'}'
op|')'
newline|'\n'
name|'if'
name|'status'
op|'=='
number|'404'
op|':'
newline|'\n'
indent|'            '
name|'return'
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'not'
number|'200'
op|'<='
name|'status'
op|'<='
number|'299'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'response'
op|','
string|"'GET'"
op|','
string|"'/info'"
op|')'
newline|'\n'
dedent|''
name|'return'
name|'json'
op|'.'
name|'loads'
op|'('
name|'self'
op|'.'
name|'response'
op|'.'
name|'read'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|http_connect
dedent|''
name|'def'
name|'http_connect'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'connection'
op|'='
name|'self'
op|'.'
name|'conn_class'
op|'('
name|'self'
op|'.'
name|'storage_host'
op|','
nl|'\n'
name|'port'
op|'='
name|'self'
op|'.'
name|'storage_port'
op|')'
newline|'\n'
comment|'#self.connection.set_debuglevel(3)'
nl|'\n'
nl|'\n'
DECL|member|make_path
dedent|''
name|'def'
name|'make_path'
op|'('
name|'self'
op|','
name|'path'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'path'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'path'
op|'='
op|'['
op|']'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'version_only_path'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
string|"'/'"
op|'+'
name|'self'
op|'.'
name|'storage_url'
op|'.'
name|'split'
op|'('
string|"'/'"
op|')'
op|'['
number|'1'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'path'
op|':'
newline|'\n'
indent|'            '
name|'quote'
op|'='
name|'urllib'
op|'.'
name|'quote'
newline|'\n'
name|'if'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'no_quote'"
op|')'
name|'or'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'no_path_quote'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'quote'
op|'='
name|'lambda'
name|'x'
op|':'
name|'x'
newline|'\n'
dedent|''
name|'return'
string|"'%s/%s'"
op|'%'
op|'('
name|'self'
op|'.'
name|'storage_url'
op|','
nl|'\n'
string|"'/'"
op|'.'
name|'join'
op|'('
op|'['
name|'quote'
op|'('
name|'i'
op|')'
name|'for'
name|'i'
name|'in'
name|'path'
op|']'
op|')'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'storage_url'
newline|'\n'
nl|'\n'
DECL|member|make_headers
dedent|''
dedent|''
name|'def'
name|'make_headers'
op|'('
name|'self'
op|','
name|'hdrs'
op|','
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'headers'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
name|'if'
name|'not'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'no_auth_token'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'headers'
op|'['
string|"'X-Auth-Token'"
op|']'
op|'='
name|'self'
op|'.'
name|'storage_token'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'isinstance'
op|'('
name|'hdrs'
op|','
name|'dict'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'headers'
op|'.'
name|'update'
op|'('
name|'hdrs'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'headers'
newline|'\n'
nl|'\n'
DECL|member|make_request
dedent|''
name|'def'
name|'make_request'
op|'('
name|'self'
op|','
name|'method'
op|','
name|'path'
op|'='
name|'None'
op|','
name|'data'
op|'='
string|"''"
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|','
nl|'\n'
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'path'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'path'
op|'='
op|'['
op|']'
newline|'\n'
dedent|''
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'not'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'absolute_path'"
op|')'
op|':'
newline|'\n'
comment|'# Set absolute_path=True to make a request to exactly the given'
nl|'\n'
comment|'# path, not storage path + given path. Useful for'
nl|'\n'
comment|'# non-account/container/object requests.'
nl|'\n'
indent|'            '
name|'path'
op|'='
name|'self'
op|'.'
name|'make_path'
op|'('
name|'path'
op|','
name|'cfg'
op|'='
name|'cfg'
op|')'
newline|'\n'
dedent|''
name|'headers'
op|'='
name|'self'
op|'.'
name|'make_headers'
op|'('
name|'hdrs'
op|','
name|'cfg'
op|'='
name|'cfg'
op|')'
newline|'\n'
name|'if'
name|'isinstance'
op|'('
name|'parms'
op|','
name|'dict'
op|')'
name|'and'
name|'parms'
op|':'
newline|'\n'
indent|'            '
name|'quote'
op|'='
name|'urllib'
op|'.'
name|'quote'
newline|'\n'
name|'if'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'no_quote'"
op|')'
name|'or'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'no_parms_quote'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'quote'
op|'='
name|'lambda'
name|'x'
op|':'
name|'x'
newline|'\n'
dedent|''
name|'query_args'
op|'='
op|'['
string|"'%s=%s'"
op|'%'
op|'('
name|'quote'
op|'('
name|'x'
op|')'
op|','
name|'quote'
op|'('
name|'str'
op|'('
name|'y'
op|')'
op|')'
op|')'
nl|'\n'
name|'for'
op|'('
name|'x'
op|','
name|'y'
op|')'
name|'in'
name|'parms'
op|'.'
name|'items'
op|'('
op|')'
op|']'
newline|'\n'
name|'path'
op|'='
string|"'%s?%s'"
op|'%'
op|'('
name|'path'
op|','
string|"'&'"
op|'.'
name|'join'
op|'('
name|'query_args'
op|')'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'not'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'no_content_length'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'set_content_length'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|'='
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'set_content_length'"
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|'='
name|'len'
op|'('
name|'data'
op|')'
newline|'\n'
nl|'\n'
DECL|function|try_request
dedent|''
dedent|''
name|'def'
name|'try_request'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'http_connect'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'connection'
op|'.'
name|'request'
op|'('
name|'method'
op|','
name|'path'
op|','
name|'data'
op|','
name|'headers'
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'connection'
op|'.'
name|'getresponse'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'response'
op|'='
name|'None'
newline|'\n'
name|'try_count'
op|'='
number|'0'
newline|'\n'
name|'fail_messages'
op|'='
op|'['
op|']'
newline|'\n'
name|'while'
name|'try_count'
op|'<'
number|'5'
op|':'
newline|'\n'
indent|'            '
name|'try_count'
op|'+='
number|'1'
newline|'\n'
nl|'\n'
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'response'
op|'='
name|'try_request'
op|'('
op|')'
newline|'\n'
dedent|''
name|'except'
name|'httplib'
op|'.'
name|'HTTPException'
name|'as'
name|'e'
op|':'
newline|'\n'
indent|'                '
name|'fail_messages'
op|'.'
name|'append'
op|'('
name|'safe_repr'
op|'('
name|'e'
op|')'
op|')'
newline|'\n'
name|'continue'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'response'
op|'.'
name|'status'
op|'=='
number|'401'
op|':'
newline|'\n'
indent|'                '
name|'fail_messages'
op|'.'
name|'append'
op|'('
string|'"Response 401"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'authenticate'
op|'('
op|')'
newline|'\n'
name|'continue'
newline|'\n'
dedent|''
name|'elif'
name|'self'
op|'.'
name|'response'
op|'.'
name|'status'
op|'=='
number|'503'
op|':'
newline|'\n'
indent|'                '
name|'fail_messages'
op|'.'
name|'append'
op|'('
string|'"Response 503"'
op|')'
newline|'\n'
name|'if'
name|'try_count'
op|'!='
number|'5'
op|':'
newline|'\n'
indent|'                    '
name|'time'
op|'.'
name|'sleep'
op|'('
number|'5'
op|')'
newline|'\n'
dedent|''
name|'continue'
newline|'\n'
nl|'\n'
dedent|''
name|'break'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'response'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'response'
op|'.'
name|'status'
newline|'\n'
nl|'\n'
dedent|''
name|'request'
op|'='
string|'"{method} {path} headers: {headers} data: {data}"'
op|'.'
name|'format'
op|'('
nl|'\n'
name|'method'
op|'='
name|'method'
op|','
name|'path'
op|'='
name|'path'
op|','
name|'headers'
op|'='
name|'headers'
op|','
name|'data'
op|'='
name|'data'
op|')'
newline|'\n'
name|'raise'
name|'RequestError'
op|'('
string|"'Unable to complete http request: %s. '"
nl|'\n'
string|"'Attempts: %s, Failures: %s'"
op|'%'
nl|'\n'
op|'('
name|'request'
op|','
name|'len'
op|'('
name|'fail_messages'
op|')'
op|','
name|'fail_messages'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|put_start
dedent|''
name|'def'
name|'put_start'
op|'('
name|'self'
op|','
name|'path'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|','
name|'chunked'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'http_connect'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'path'
op|'='
name|'self'
op|'.'
name|'make_path'
op|'('
name|'path'
op|','
name|'cfg'
op|')'
newline|'\n'
name|'headers'
op|'='
name|'self'
op|'.'
name|'make_headers'
op|'('
name|'hdrs'
op|','
name|'cfg'
op|'='
name|'cfg'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'chunked'
op|':'
newline|'\n'
indent|'            '
name|'headers'
op|'['
string|"'Transfer-Encoding'"
op|']'
op|'='
string|"'chunked'"
newline|'\n'
name|'headers'
op|'.'
name|'pop'
op|'('
string|"'Content-Length'"
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'isinstance'
op|'('
name|'parms'
op|','
name|'dict'
op|')'
name|'and'
name|'parms'
op|':'
newline|'\n'
indent|'            '
name|'quote'
op|'='
name|'urllib'
op|'.'
name|'quote'
newline|'\n'
name|'if'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'no_quote'"
op|')'
name|'or'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'no_parms_quote'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'quote'
op|'='
name|'lambda'
name|'x'
op|':'
name|'x'
newline|'\n'
dedent|''
name|'query_args'
op|'='
op|'['
string|"'%s=%s'"
op|'%'
op|'('
name|'quote'
op|'('
name|'x'
op|')'
op|','
name|'quote'
op|'('
name|'str'
op|'('
name|'y'
op|')'
op|')'
op|')'
nl|'\n'
name|'for'
op|'('
name|'x'
op|','
name|'y'
op|')'
name|'in'
name|'parms'
op|'.'
name|'items'
op|'('
op|')'
op|']'
newline|'\n'
name|'path'
op|'='
string|"'%s?%s'"
op|'%'
op|'('
name|'path'
op|','
string|"'&'"
op|'.'
name|'join'
op|'('
name|'query_args'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'connection'
op|'='
name|'self'
op|'.'
name|'conn_class'
op|'('
name|'self'
op|'.'
name|'storage_host'
op|','
nl|'\n'
name|'port'
op|'='
name|'self'
op|'.'
name|'storage_port'
op|')'
newline|'\n'
comment|'#self.connection.set_debuglevel(3)'
nl|'\n'
name|'self'
op|'.'
name|'connection'
op|'.'
name|'putrequest'
op|'('
string|"'PUT'"
op|','
name|'path'
op|')'
newline|'\n'
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'headers'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'connection'
op|'.'
name|'putheader'
op|'('
name|'key'
op|','
name|'value'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'connection'
op|'.'
name|'endheaders'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|put_data
dedent|''
name|'def'
name|'put_data'
op|'('
name|'self'
op|','
name|'data'
op|','
name|'chunked'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'chunked'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'connection'
op|'.'
name|'send'
op|'('
string|"'%x\\r\\n%s\\r\\n'"
op|'%'
op|'('
name|'len'
op|'('
name|'data'
op|')'
op|','
name|'data'
op|')'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'connection'
op|'.'
name|'send'
op|'('
name|'data'
op|')'
newline|'\n'
nl|'\n'
DECL|member|put_end
dedent|''
dedent|''
name|'def'
name|'put_end'
op|'('
name|'self'
op|','
name|'chunked'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'chunked'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'connection'
op|'.'
name|'send'
op|'('
string|"'0\\r\\n\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'response'
op|'='
name|'self'
op|'.'
name|'connection'
op|'.'
name|'getresponse'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'connection'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'response'
op|'.'
name|'status'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|Base
dedent|''
dedent|''
name|'class'
name|'Base'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__str__
indent|'    '
name|'def'
name|'__str__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'name'
newline|'\n'
nl|'\n'
DECL|member|header_fields
dedent|''
name|'def'
name|'header_fields'
op|'('
name|'self'
op|','
name|'required_fields'
op|','
name|'optional_fields'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'optional_fields'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'optional_fields'
op|'='
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'headers'
op|'='
name|'dict'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'getheaders'
op|'('
op|')'
op|')'
newline|'\n'
name|'ret'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
name|'for'
name|'field'
name|'in'
name|'required_fields'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'field'
op|'['
number|'1'
op|']'
name|'not'
name|'in'
name|'headers'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'ValueError'
op|'('
string|'"%s was not found in response header"'
op|'%'
nl|'\n'
op|'('
name|'field'
op|'['
number|'1'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'ret'
op|'['
name|'field'
op|'['
number|'0'
op|']'
op|']'
op|'='
name|'int'
op|'('
name|'headers'
op|'['
name|'field'
op|'['
number|'1'
op|']'
op|']'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'ValueError'
op|':'
newline|'\n'
indent|'                '
name|'ret'
op|'['
name|'field'
op|'['
number|'0'
op|']'
op|']'
op|'='
name|'headers'
op|'['
name|'field'
op|'['
number|'1'
op|']'
op|']'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'for'
name|'field'
name|'in'
name|'optional_fields'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'field'
op|'['
number|'1'
op|']'
name|'not'
name|'in'
name|'headers'
op|':'
newline|'\n'
indent|'                '
name|'continue'
newline|'\n'
dedent|''
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'ret'
op|'['
name|'field'
op|'['
number|'0'
op|']'
op|']'
op|'='
name|'int'
op|'('
name|'headers'
op|'['
name|'field'
op|'['
number|'1'
op|']'
op|']'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'ValueError'
op|':'
newline|'\n'
indent|'                '
name|'ret'
op|'['
name|'field'
op|'['
number|'0'
op|']'
op|']'
op|'='
name|'headers'
op|'['
name|'field'
op|'['
number|'1'
op|']'
op|']'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'return'
name|'ret'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|Account
dedent|''
dedent|''
name|'class'
name|'Account'
op|'('
name|'Base'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'conn'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'conn'
op|'='
name|'conn'
newline|'\n'
name|'self'
op|'.'
name|'name'
op|'='
name|'str'
op|'('
name|'name'
op|')'
newline|'\n'
nl|'\n'
DECL|member|update_metadata
dedent|''
name|'def'
name|'update_metadata'
op|'('
name|'self'
op|','
name|'metadata'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'metadata'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'metadata'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'headers'
op|'='
name|'dict'
op|'('
op|'('
string|'"X-Account-Meta-%s"'
op|'%'
name|'k'
op|','
name|'v'
op|')'
nl|'\n'
name|'for'
name|'k'
op|','
name|'v'
name|'in'
name|'metadata'
op|'.'
name|'items'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_request'
op|'('
string|"'POST'"
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'headers'
op|','
name|'cfg'
op|'='
name|'cfg'
op|')'
newline|'\n'
name|'if'
name|'not'
number|'200'
op|'<='
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'status'
op|'<='
number|'299'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|','
string|"'POST'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_path'
op|'('
name|'self'
op|'.'
name|'path'
op|')'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'True'
newline|'\n'
nl|'\n'
DECL|member|container
dedent|''
name|'def'
name|'container'
op|'('
name|'self'
op|','
name|'container_name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'Container'
op|'('
name|'self'
op|'.'
name|'conn'
op|','
name|'self'
op|'.'
name|'name'
op|','
name|'container_name'
op|')'
newline|'\n'
nl|'\n'
DECL|member|containers
dedent|''
name|'def'
name|'containers'
op|'('
name|'self'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'format_type'
op|'='
name|'parms'
op|'.'
name|'get'
op|'('
string|"'format'"
op|','
name|'None'
op|')'
newline|'\n'
name|'if'
name|'format_type'
name|'not'
name|'in'
op|'['
name|'None'
op|','
string|"'json'"
op|','
string|"'xml'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'RequestError'
op|'('
string|"'Invalid format: %s'"
op|'%'
name|'format_type'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'format_type'
name|'is'
name|'None'
name|'and'
string|"'format'"
name|'in'
name|'parms'
op|':'
newline|'\n'
indent|'            '
name|'del'
name|'parms'
op|'['
string|"'format'"
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'status'
op|'='
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_request'
op|'('
string|"'GET'"
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'hdrs'
op|','
nl|'\n'
name|'parms'
op|'='
name|'parms'
op|','
name|'cfg'
op|'='
name|'cfg'
op|')'
newline|'\n'
name|'if'
name|'status'
op|'=='
number|'200'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'format_type'
op|'=='
string|"'json'"
op|':'
newline|'\n'
indent|'                '
name|'conts'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'read'
op|'('
op|')'
op|')'
newline|'\n'
name|'for'
name|'cont'
name|'in'
name|'conts'
op|':'
newline|'\n'
indent|'                    '
name|'cont'
op|'['
string|"'name'"
op|']'
op|'='
name|'cont'
op|'['
string|"'name'"
op|']'
op|'.'
name|'encode'
op|'('
string|"'utf-8'"
op|')'
newline|'\n'
dedent|''
name|'return'
name|'conts'
newline|'\n'
dedent|''
name|'elif'
name|'format_type'
op|'=='
string|"'xml'"
op|':'
newline|'\n'
indent|'                '
name|'conts'
op|'='
op|'['
op|']'
newline|'\n'
name|'tree'
op|'='
name|'minidom'
op|'.'
name|'parseString'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'read'
op|'('
op|')'
op|')'
newline|'\n'
name|'for'
name|'x'
name|'in'
name|'tree'
op|'.'
name|'getElementsByTagName'
op|'('
string|"'container'"
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'cont'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'for'
name|'key'
name|'in'
op|'['
string|"'name'"
op|','
string|"'count'"
op|','
string|"'bytes'"
op|']'
op|':'
newline|'\n'
indent|'                        '
name|'cont'
op|'['
name|'key'
op|']'
op|'='
name|'x'
op|'.'
name|'getElementsByTagName'
op|'('
name|'key'
op|')'
op|'['
number|'0'
op|']'
op|'.'
name|'childNodes'
op|'['
number|'0'
op|']'
op|'.'
name|'nodeValue'
newline|'\n'
dedent|''
name|'conts'
op|'.'
name|'append'
op|'('
name|'cont'
op|')'
newline|'\n'
dedent|''
name|'for'
name|'cont'
name|'in'
name|'conts'
op|':'
newline|'\n'
indent|'                    '
name|'cont'
op|'['
string|"'name'"
op|']'
op|'='
name|'cont'
op|'['
string|"'name'"
op|']'
op|'.'
name|'encode'
op|'('
string|"'utf-8'"
op|')'
newline|'\n'
dedent|''
name|'return'
name|'conts'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'lines'
op|'='
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'read'
op|'('
op|')'
op|'.'
name|'split'
op|'('
string|"'\\n'"
op|')'
newline|'\n'
name|'if'
name|'lines'
name|'and'
name|'not'
name|'lines'
op|'['
op|'-'
number|'1'
op|']'
op|':'
newline|'\n'
indent|'                    '
name|'lines'
op|'='
name|'lines'
op|'['
op|':'
op|'-'
number|'1'
op|']'
newline|'\n'
dedent|''
name|'return'
name|'lines'
newline|'\n'
dedent|''
dedent|''
name|'elif'
name|'status'
op|'=='
number|'204'
op|':'
newline|'\n'
indent|'            '
name|'return'
op|'['
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|','
string|"'GET'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_path'
op|'('
name|'self'
op|'.'
name|'path'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|delete_containers
dedent|''
name|'def'
name|'delete_containers'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'c'
name|'in'
name|'listing_items'
op|'('
name|'self'
op|'.'
name|'containers'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'cont'
op|'='
name|'self'
op|'.'
name|'container'
op|'('
name|'c'
op|')'
newline|'\n'
name|'if'
name|'not'
name|'cont'
op|'.'
name|'delete_recursive'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'False'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'return'
name|'listing_empty'
op|'('
name|'self'
op|'.'
name|'containers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|info
dedent|''
name|'def'
name|'info'
op|'('
name|'self'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_request'
op|'('
string|"'HEAD'"
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'hdrs'
op|','
nl|'\n'
name|'parms'
op|'='
name|'parms'
op|','
name|'cfg'
op|'='
name|'cfg'
op|')'
op|'!='
number|'204'
op|':'
newline|'\n'
nl|'\n'
indent|'            '
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|','
string|"'HEAD'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_path'
op|'('
name|'self'
op|'.'
name|'path'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'fields'
op|'='
op|'['
op|'['
string|"'object_count'"
op|','
string|"'x-account-object-count'"
op|']'
op|','
nl|'\n'
op|'['
string|"'container_count'"
op|','
string|"'x-account-container-count'"
op|']'
op|','
nl|'\n'
op|'['
string|"'bytes_used'"
op|','
string|"'x-account-bytes-used'"
op|']'
op|']'
newline|'\n'
nl|'\n'
name|'return'
name|'self'
op|'.'
name|'header_fields'
op|'('
name|'fields'
op|')'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'property'
newline|'\n'
DECL|member|path
name|'def'
name|'path'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
op|'['
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|Container
dedent|''
dedent|''
name|'class'
name|'Container'
op|'('
name|'Base'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'conn'
op|','
name|'account'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'conn'
op|'='
name|'conn'
newline|'\n'
name|'self'
op|'.'
name|'account'
op|'='
name|'str'
op|'('
name|'account'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'name'
op|'='
name|'str'
op|'('
name|'name'
op|')'
newline|'\n'
nl|'\n'
DECL|member|create
dedent|''
name|'def'
name|'create'
op|'('
name|'self'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'return'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_request'
op|'('
string|"'PUT'"
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'hdrs'
op|','
nl|'\n'
name|'parms'
op|'='
name|'parms'
op|','
name|'cfg'
op|'='
name|'cfg'
op|')'
name|'in'
op|'('
number|'201'
op|','
number|'202'
op|')'
newline|'\n'
nl|'\n'
DECL|member|delete
dedent|''
name|'def'
name|'delete'
op|'('
name|'self'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'return'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_request'
op|'('
string|"'DELETE'"
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'hdrs'
op|','
nl|'\n'
name|'parms'
op|'='
name|'parms'
op|')'
op|'=='
number|'204'
newline|'\n'
nl|'\n'
DECL|member|delete_files
dedent|''
name|'def'
name|'delete_files'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'f'
name|'in'
name|'listing_items'
op|'('
name|'self'
op|'.'
name|'files'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'file_item'
op|'='
name|'self'
op|'.'
name|'file'
op|'('
name|'f'
op|')'
newline|'\n'
name|'if'
name|'not'
name|'file_item'
op|'.'
name|'delete'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'False'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'return'
name|'listing_empty'
op|'('
name|'self'
op|'.'
name|'files'
op|')'
newline|'\n'
nl|'\n'
DECL|member|delete_recursive
dedent|''
name|'def'
name|'delete_recursive'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'delete_files'
op|'('
op|')'
name|'and'
name|'self'
op|'.'
name|'delete'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|file
dedent|''
name|'def'
name|'file'
op|'('
name|'self'
op|','
name|'file_name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'File'
op|'('
name|'self'
op|'.'
name|'conn'
op|','
name|'self'
op|'.'
name|'account'
op|','
name|'self'
op|'.'
name|'name'
op|','
name|'file_name'
op|')'
newline|'\n'
nl|'\n'
DECL|member|files
dedent|''
name|'def'
name|'files'
op|'('
name|'self'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'format_type'
op|'='
name|'parms'
op|'.'
name|'get'
op|'('
string|"'format'"
op|','
name|'None'
op|')'
newline|'\n'
name|'if'
name|'format_type'
name|'not'
name|'in'
op|'['
name|'None'
op|','
string|"'json'"
op|','
string|"'xml'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'RequestError'
op|'('
string|"'Invalid format: %s'"
op|'%'
name|'format_type'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'format_type'
name|'is'
name|'None'
name|'and'
string|"'format'"
name|'in'
name|'parms'
op|':'
newline|'\n'
indent|'            '
name|'del'
name|'parms'
op|'['
string|"'format'"
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'status'
op|'='
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_request'
op|'('
string|"'GET'"
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'hdrs'
op|','
nl|'\n'
name|'parms'
op|'='
name|'parms'
op|','
name|'cfg'
op|'='
name|'cfg'
op|')'
newline|'\n'
name|'if'
name|'status'
op|'=='
number|'200'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'format_type'
op|'=='
string|"'json'"
op|':'
newline|'\n'
indent|'                '
name|'files'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'read'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'file_item'
name|'in'
name|'files'
op|':'
newline|'\n'
indent|'                    '
name|'file_item'
op|'['
string|"'name'"
op|']'
op|'='
name|'file_item'
op|'['
string|"'name'"
op|']'
op|'.'
name|'encode'
op|'('
string|"'utf-8'"
op|')'
newline|'\n'
name|'file_item'
op|'['
string|"'content_type'"
op|']'
op|'='
name|'file_item'
op|'['
string|"'content_type'"
op|']'
op|'.'
name|'encode'
op|'('
string|"'utf-8'"
op|')'
newline|'\n'
dedent|''
name|'return'
name|'files'
newline|'\n'
dedent|''
name|'elif'
name|'format_type'
op|'=='
string|"'xml'"
op|':'
newline|'\n'
indent|'                '
name|'files'
op|'='
op|'['
op|']'
newline|'\n'
name|'tree'
op|'='
name|'minidom'
op|'.'
name|'parseString'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'read'
op|'('
op|')'
op|')'
newline|'\n'
name|'for'
name|'x'
name|'in'
name|'tree'
op|'.'
name|'getElementsByTagName'
op|'('
string|"'object'"
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'file_item'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'for'
name|'key'
name|'in'
op|'['
string|"'name'"
op|','
string|"'hash'"
op|','
string|"'bytes'"
op|','
string|"'content_type'"
op|','
nl|'\n'
string|"'last_modified'"
op|']'
op|':'
newline|'\n'
nl|'\n'
indent|'                        '
name|'file_item'
op|'['
name|'key'
op|']'
op|'='
name|'x'
op|'.'
name|'getElementsByTagName'
op|'('
name|'key'
op|')'
op|'['
number|'0'
op|']'
op|'.'
name|'childNodes'
op|'['
number|'0'
op|']'
op|'.'
name|'nodeValue'
newline|'\n'
dedent|''
name|'files'
op|'.'
name|'append'
op|'('
name|'file_item'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'for'
name|'file_item'
name|'in'
name|'files'
op|':'
newline|'\n'
indent|'                    '
name|'file_item'
op|'['
string|"'name'"
op|']'
op|'='
name|'file_item'
op|'['
string|"'name'"
op|']'
op|'.'
name|'encode'
op|'('
string|"'utf-8'"
op|')'
newline|'\n'
name|'file_item'
op|'['
string|"'content_type'"
op|']'
op|'='
name|'file_item'
op|'['
string|"'content_type'"
op|']'
op|'.'
name|'encode'
op|'('
string|"'utf-8'"
op|')'
newline|'\n'
dedent|''
name|'return'
name|'files'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'content'
op|'='
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'read'
op|'('
op|')'
newline|'\n'
name|'if'
name|'content'
op|':'
newline|'\n'
indent|'                    '
name|'lines'
op|'='
name|'content'
op|'.'
name|'split'
op|'('
string|"'\\n'"
op|')'
newline|'\n'
name|'if'
name|'lines'
name|'and'
name|'not'
name|'lines'
op|'['
op|'-'
number|'1'
op|']'
op|':'
newline|'\n'
indent|'                        '
name|'lines'
op|'='
name|'lines'
op|'['
op|':'
op|'-'
number|'1'
op|']'
newline|'\n'
dedent|''
name|'return'
name|'lines'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'return'
op|'['
op|']'
newline|'\n'
dedent|''
dedent|''
dedent|''
name|'elif'
name|'status'
op|'=='
number|'204'
op|':'
newline|'\n'
indent|'            '
name|'return'
op|'['
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|','
string|"'GET'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_path'
op|'('
name|'self'
op|'.'
name|'path'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|info
dedent|''
name|'def'
name|'info'
op|'('
name|'self'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_request'
op|'('
string|"'HEAD'"
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'hdrs'
op|','
nl|'\n'
name|'parms'
op|'='
name|'parms'
op|','
name|'cfg'
op|'='
name|'cfg'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'status'
op|'=='
number|'204'
op|':'
newline|'\n'
indent|'            '
name|'required_fields'
op|'='
op|'['
op|'['
string|"'bytes_used'"
op|','
string|"'x-container-bytes-used'"
op|']'
op|','
nl|'\n'
op|'['
string|"'object_count'"
op|','
string|"'x-container-object-count'"
op|']'
op|']'
newline|'\n'
name|'optional_fields'
op|'='
op|'['
op|'['
string|"'versions'"
op|','
string|"'x-versions-location'"
op|']'
op|']'
newline|'\n'
nl|'\n'
name|'return'
name|'self'
op|'.'
name|'header_fields'
op|'('
name|'required_fields'
op|','
name|'optional_fields'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|','
string|"'HEAD'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_path'
op|'('
name|'self'
op|'.'
name|'path'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'property'
newline|'\n'
DECL|member|path
name|'def'
name|'path'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
op|'['
name|'self'
op|'.'
name|'name'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|File
dedent|''
dedent|''
name|'class'
name|'File'
op|'('
name|'Base'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'conn'
op|','
name|'account'
op|','
name|'container'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'conn'
op|'='
name|'conn'
newline|'\n'
name|'self'
op|'.'
name|'account'
op|'='
name|'str'
op|'('
name|'account'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'container'
op|'='
name|'str'
op|'('
name|'container'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'name'
op|'='
name|'str'
op|'('
name|'name'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'chunked_write_in_progress'
op|'='
name|'False'
newline|'\n'
name|'self'
op|'.'
name|'content_type'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'size'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'metadata'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
DECL|member|make_headers
dedent|''
name|'def'
name|'make_headers'
op|'('
name|'self'
op|','
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'headers'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'if'
name|'not'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'no_content_length'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'set_content_length'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|'='
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'set_content_length'"
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'self'
op|'.'
name|'size'
op|':'
newline|'\n'
indent|'                '
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|'='
name|'self'
op|'.'
name|'size'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|'='
number|'0'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'no_content_type'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'pass'
newline|'\n'
dedent|''
name|'elif'
name|'self'
op|'.'
name|'content_type'
op|':'
newline|'\n'
indent|'            '
name|'headers'
op|'['
string|"'Content-Type'"
op|']'
op|'='
name|'self'
op|'.'
name|'content_type'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'headers'
op|'['
string|"'Content-Type'"
op|']'
op|'='
string|"'application/octet-stream'"
newline|'\n'
nl|'\n'
dedent|''
name|'for'
name|'key'
name|'in'
name|'self'
op|'.'
name|'metadata'
op|':'
newline|'\n'
indent|'            '
name|'headers'
op|'['
string|"'X-Object-Meta-'"
op|'+'
name|'key'
op|']'
op|'='
name|'self'
op|'.'
name|'metadata'
op|'['
name|'key'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'headers'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'classmethod'
newline|'\n'
DECL|member|compute_md5sum
name|'def'
name|'compute_md5sum'
op|'('
name|'cls'
op|','
name|'data'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'block_size'
op|'='
number|'4096'
newline|'\n'
nl|'\n'
name|'if'
name|'isinstance'
op|'('
name|'data'
op|','
name|'str'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'data'
op|'='
name|'StringIO'
op|'.'
name|'StringIO'
op|'('
name|'data'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'checksum'
op|'='
name|'hashlib'
op|'.'
name|'md5'
op|'('
op|')'
newline|'\n'
name|'buff'
op|'='
name|'data'
op|'.'
name|'read'
op|'('
name|'block_size'
op|')'
newline|'\n'
name|'while'
name|'buff'
op|':'
newline|'\n'
indent|'            '
name|'checksum'
op|'.'
name|'update'
op|'('
name|'buff'
op|')'
newline|'\n'
name|'buff'
op|'='
name|'data'
op|'.'
name|'read'
op|'('
name|'block_size'
op|')'
newline|'\n'
dedent|''
name|'data'
op|'.'
name|'seek'
op|'('
number|'0'
op|')'
newline|'\n'
name|'return'
name|'checksum'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|copy
dedent|''
name|'def'
name|'copy'
op|'('
name|'self'
op|','
name|'dest_cont'
op|','
name|'dest_file'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
string|"'destination'"
name|'in'
name|'cfg'
op|':'
newline|'\n'
indent|'            '
name|'headers'
op|'='
op|'{'
string|"'Destination'"
op|':'
name|'cfg'
op|'['
string|"'destination'"
op|']'
op|'}'
newline|'\n'
dedent|''
name|'elif'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'no_destination'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'headers'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'headers'
op|'='
op|'{'
string|"'Destination'"
op|':'
string|"'%s/%s'"
op|'%'
op|'('
name|'dest_cont'
op|','
name|'dest_file'
op|')'
op|'}'
newline|'\n'
dedent|''
name|'headers'
op|'.'
name|'update'
op|'('
name|'hdrs'
op|')'
newline|'\n'
nl|'\n'
name|'if'
string|"'Destination'"
name|'in'
name|'headers'
op|':'
newline|'\n'
indent|'            '
name|'headers'
op|'['
string|"'Destination'"
op|']'
op|'='
name|'urllib'
op|'.'
name|'quote'
op|'('
name|'headers'
op|'['
string|"'Destination'"
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_request'
op|'('
string|"'COPY'"
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'headers'
op|','
nl|'\n'
name|'parms'
op|'='
name|'parms'
op|')'
op|'=='
number|'201'
newline|'\n'
nl|'\n'
DECL|member|delete
dedent|''
name|'def'
name|'delete'
op|'('
name|'self'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_request'
op|'('
string|"'DELETE'"
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'hdrs'
op|','
nl|'\n'
name|'parms'
op|'='
name|'parms'
op|')'
op|'!='
number|'204'
op|':'
newline|'\n'
nl|'\n'
indent|'            '
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|','
string|"'DELETE'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_path'
op|'('
name|'self'
op|'.'
name|'path'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'True'
newline|'\n'
nl|'\n'
DECL|member|info
dedent|''
name|'def'
name|'info'
op|'('
name|'self'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_request'
op|'('
string|"'HEAD'"
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'hdrs'
op|','
nl|'\n'
name|'parms'
op|'='
name|'parms'
op|','
name|'cfg'
op|'='
name|'cfg'
op|')'
op|'!='
number|'200'
op|':'
newline|'\n'
nl|'\n'
indent|'            '
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|','
string|"'HEAD'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_path'
op|'('
name|'self'
op|'.'
name|'path'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'fields'
op|'='
op|'['
op|'['
string|"'content_length'"
op|','
string|"'content-length'"
op|']'
op|','
nl|'\n'
op|'['
string|"'content_type'"
op|','
string|"'content-type'"
op|']'
op|','
nl|'\n'
op|'['
string|"'last_modified'"
op|','
string|"'last-modified'"
op|']'
op|','
nl|'\n'
op|'['
string|"'etag'"
op|','
string|"'etag'"
op|']'
op|']'
newline|'\n'
nl|'\n'
name|'header_fields'
op|'='
name|'self'
op|'.'
name|'header_fields'
op|'('
name|'fields'
op|')'
newline|'\n'
name|'header_fields'
op|'['
string|"'etag'"
op|']'
op|'='
name|'header_fields'
op|'['
string|"'etag'"
op|']'
op|'.'
name|'strip'
op|'('
string|'\'"\''
op|')'
newline|'\n'
name|'return'
name|'header_fields'
newline|'\n'
nl|'\n'
DECL|member|initialize
dedent|''
name|'def'
name|'initialize'
op|'('
name|'self'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'not'
name|'self'
op|'.'
name|'name'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'False'
newline|'\n'
nl|'\n'
dedent|''
name|'status'
op|'='
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_request'
op|'('
string|"'HEAD'"
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'hdrs'
op|','
nl|'\n'
name|'parms'
op|'='
name|'parms'
op|')'
newline|'\n'
name|'if'
name|'status'
op|'=='
number|'404'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'False'
newline|'\n'
dedent|''
name|'elif'
op|'('
name|'status'
op|'<'
number|'200'
op|')'
name|'or'
op|'('
name|'status'
op|'>'
number|'299'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|','
string|"'HEAD'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_path'
op|'('
name|'self'
op|'.'
name|'path'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'for'
name|'hdr'
name|'in'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'getheaders'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'hdr'
op|'['
number|'0'
op|']'
op|'.'
name|'lower'
op|'('
op|')'
op|'=='
string|"'content-type'"
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'content_type'
op|'='
name|'hdr'
op|'['
number|'1'
op|']'
newline|'\n'
dedent|''
name|'if'
name|'hdr'
op|'['
number|'0'
op|']'
op|'.'
name|'lower'
op|'('
op|')'
op|'.'
name|'startswith'
op|'('
string|"'x-object-meta-'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'metadata'
op|'['
name|'hdr'
op|'['
number|'0'
op|']'
op|'['
number|'14'
op|':'
op|']'
op|']'
op|'='
name|'hdr'
op|'['
number|'1'
op|']'
newline|'\n'
dedent|''
name|'if'
name|'hdr'
op|'['
number|'0'
op|']'
op|'.'
name|'lower'
op|'('
op|')'
op|'=='
string|"'etag'"
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'etag'
op|'='
name|'hdr'
op|'['
number|'1'
op|']'
op|'.'
name|'strip'
op|'('
string|'\'"\''
op|')'
newline|'\n'
dedent|''
name|'if'
name|'hdr'
op|'['
number|'0'
op|']'
op|'.'
name|'lower'
op|'('
op|')'
op|'=='
string|"'content-length'"
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'size'
op|'='
name|'int'
op|'('
name|'hdr'
op|'['
number|'1'
op|']'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'hdr'
op|'['
number|'0'
op|']'
op|'.'
name|'lower'
op|'('
op|')'
op|'=='
string|"'last-modified'"
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'last_modified'
op|'='
name|'hdr'
op|'['
number|'1'
op|']'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'return'
name|'True'
newline|'\n'
nl|'\n'
DECL|member|load_from_filename
dedent|''
name|'def'
name|'load_from_filename'
op|'('
name|'self'
op|','
name|'filename'
op|','
name|'callback'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fobj'
op|'='
name|'open'
op|'('
name|'filename'
op|','
string|"'rb'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'write'
op|'('
name|'fobj'
op|','
name|'callback'
op|'='
name|'callback'
op|')'
newline|'\n'
name|'fobj'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'property'
newline|'\n'
DECL|member|path
name|'def'
name|'path'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
op|'['
name|'self'
op|'.'
name|'container'
op|','
name|'self'
op|'.'
name|'name'
op|']'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'classmethod'
newline|'\n'
DECL|member|random_data
name|'def'
name|'random_data'
op|'('
name|'cls'
op|','
name|'size'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'size'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'size'
op|'='
name|'random'
op|'.'
name|'randint'
op|'('
number|'1'
op|','
number|'32768'
op|')'
newline|'\n'
dedent|''
name|'fd'
op|'='
name|'open'
op|'('
string|"'/dev/urandom'"
op|','
string|"'r'"
op|')'
newline|'\n'
name|'data'
op|'='
name|'fd'
op|'.'
name|'read'
op|'('
name|'size'
op|')'
newline|'\n'
name|'fd'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
name|'return'
name|'data'
newline|'\n'
nl|'\n'
DECL|member|read
dedent|''
name|'def'
name|'read'
op|'('
name|'self'
op|','
name|'size'
op|'='
op|'-'
number|'1'
op|','
name|'offset'
op|'='
number|'0'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'buffer'
op|'='
name|'None'
op|','
nl|'\n'
name|'callback'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'size'
op|'>'
number|'0'
op|':'
newline|'\n'
indent|'            '
name|'range_string'
op|'='
string|"'bytes=%d-%d'"
op|'%'
op|'('
name|'offset'
op|','
op|'('
name|'offset'
op|'+'
name|'size'
op|')'
op|'-'
number|'1'
op|')'
newline|'\n'
name|'if'
name|'hdrs'
op|':'
newline|'\n'
indent|'                '
name|'hdrs'
op|'['
string|"'Range'"
op|']'
op|'='
name|'range_string'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'hdrs'
op|'='
op|'{'
string|"'Range'"
op|':'
name|'range_string'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'status'
op|'='
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_request'
op|'('
string|"'GET'"
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'hdrs'
op|','
nl|'\n'
name|'cfg'
op|'='
name|'cfg'
op|','
name|'parms'
op|'='
name|'parms'
op|')'
newline|'\n'
nl|'\n'
name|'if'
op|'('
name|'status'
op|'<'
number|'200'
op|')'
name|'or'
op|'('
name|'status'
op|'>'
number|'299'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|','
string|"'GET'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_path'
op|'('
name|'self'
op|'.'
name|'path'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'for'
name|'hdr'
name|'in'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'getheaders'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'hdr'
op|'['
number|'0'
op|']'
op|'.'
name|'lower'
op|'('
op|')'
op|'=='
string|"'content-type'"
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'content_type'
op|'='
name|'hdr'
op|'['
number|'1'
op|']'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
name|'hasattr'
op|'('
name|'buffer'
op|','
string|"'write'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'scratch'
op|'='
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'read'
op|'('
number|'8192'
op|')'
newline|'\n'
name|'transferred'
op|'='
number|'0'
newline|'\n'
nl|'\n'
name|'while'
name|'len'
op|'('
name|'scratch'
op|')'
op|'>'
number|'0'
op|':'
newline|'\n'
indent|'                '
name|'buffer'
op|'.'
name|'write'
op|'('
name|'scratch'
op|')'
newline|'\n'
name|'transferred'
op|'+='
name|'len'
op|'('
name|'scratch'
op|')'
newline|'\n'
name|'if'
name|'callable'
op|'('
name|'callback'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'callback'
op|'('
name|'transferred'
op|','
name|'self'
op|'.'
name|'size'
op|')'
newline|'\n'
dedent|''
name|'scratch'
op|'='
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'read'
op|'('
number|'8192'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'None'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'read'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|read_md5
dedent|''
dedent|''
name|'def'
name|'read_md5'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'status'
op|'='
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_request'
op|'('
string|"'GET'"
op|','
name|'self'
op|'.'
name|'path'
op|')'
newline|'\n'
nl|'\n'
name|'if'
op|'('
name|'status'
op|'<'
number|'200'
op|')'
name|'or'
op|'('
name|'status'
op|'>'
number|'299'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|','
string|"'GET'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_path'
op|'('
name|'self'
op|'.'
name|'path'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'checksum'
op|'='
name|'hashlib'
op|'.'
name|'md5'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'scratch'
op|'='
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'read'
op|'('
number|'8192'
op|')'
newline|'\n'
name|'while'
name|'len'
op|'('
name|'scratch'
op|')'
op|'>'
number|'0'
op|':'
newline|'\n'
indent|'            '
name|'checksum'
op|'.'
name|'update'
op|'('
name|'scratch'
op|')'
newline|'\n'
name|'scratch'
op|'='
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'read'
op|'('
number|'8192'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'checksum'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|save_to_filename
dedent|''
name|'def'
name|'save_to_filename'
op|'('
name|'self'
op|','
name|'filename'
op|','
name|'callback'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'fobj'
op|'='
name|'open'
op|'('
name|'filename'
op|','
string|"'wb'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'read'
op|'('
name|'buffer'
op|'='
name|'fobj'
op|','
name|'callback'
op|'='
name|'callback'
op|')'
newline|'\n'
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'            '
name|'fobj'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|sync_metadata
dedent|''
dedent|''
name|'def'
name|'sync_metadata'
op|'('
name|'self'
op|','
name|'metadata'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'metadata'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'metadata'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'metadata'
op|'.'
name|'update'
op|'('
name|'metadata'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'metadata'
op|':'
newline|'\n'
indent|'            '
name|'headers'
op|'='
name|'self'
op|'.'
name|'make_headers'
op|'('
name|'cfg'
op|'='
name|'cfg'
op|')'
newline|'\n'
name|'if'
name|'not'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'no_content_length'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'set_content_length'"
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|'='
name|'cfg'
op|'.'
name|'get'
op|'('
string|"'set_content_length'"
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'headers'
op|'['
string|"'Content-Length'"
op|']'
op|'='
number|'0'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_request'
op|'('
string|"'POST'"
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'headers'
op|','
name|'cfg'
op|'='
name|'cfg'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'status'
name|'not'
name|'in'
op|'('
number|'201'
op|','
number|'202'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|','
string|"'POST'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_path'
op|'('
name|'self'
op|'.'
name|'path'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'return'
name|'True'
newline|'\n'
nl|'\n'
DECL|member|chunked_write
dedent|''
name|'def'
name|'chunked_write'
op|'('
name|'self'
op|','
name|'data'
op|'='
name|'None'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'data'
name|'is'
name|'not'
name|'None'
name|'and'
name|'self'
op|'.'
name|'chunked_write_in_progress'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'conn'
op|'.'
name|'put_data'
op|'('
name|'data'
op|','
name|'True'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'data'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'chunked_write_in_progress'
op|'='
name|'True'
newline|'\n'
nl|'\n'
name|'headers'
op|'='
name|'self'
op|'.'
name|'make_headers'
op|'('
name|'cfg'
op|'='
name|'cfg'
op|')'
newline|'\n'
name|'headers'
op|'.'
name|'update'
op|'('
name|'hdrs'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'put_start'
op|'('
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'headers'
op|','
name|'parms'
op|'='
name|'parms'
op|','
nl|'\n'
name|'cfg'
op|'='
name|'cfg'
op|','
name|'chunked'
op|'='
name|'True'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'put_data'
op|'('
name|'data'
op|','
name|'True'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'self'
op|'.'
name|'chunked_write_in_progress'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'chunked_write_in_progress'
op|'='
name|'False'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'put_end'
op|'('
name|'True'
op|')'
op|'=='
number|'201'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'RuntimeError'
newline|'\n'
nl|'\n'
DECL|member|write
dedent|''
dedent|''
name|'def'
name|'write'
op|'('
name|'self'
op|','
name|'data'
op|'='
string|"''"
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|','
name|'callback'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|','
nl|'\n'
name|'return_resp'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'block_size'
op|'='
number|'2'
op|'**'
number|'20'
newline|'\n'
nl|'\n'
name|'if'
name|'isinstance'
op|'('
name|'data'
op|','
name|'file'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'data'
op|'.'
name|'flush'
op|'('
op|')'
newline|'\n'
name|'data'
op|'.'
name|'seek'
op|'('
number|'0'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'IOError'
op|':'
newline|'\n'
indent|'                '
name|'pass'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'size'
op|'='
name|'int'
op|'('
name|'os'
op|'.'
name|'fstat'
op|'('
name|'data'
op|'.'
name|'fileno'
op|'('
op|')'
op|')'
op|'['
number|'6'
op|']'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'data'
op|'='
name|'StringIO'
op|'.'
name|'StringIO'
op|'('
name|'data'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'size'
op|'='
name|'data'
op|'.'
name|'len'
newline|'\n'
nl|'\n'
dedent|''
name|'headers'
op|'='
name|'self'
op|'.'
name|'make_headers'
op|'('
name|'cfg'
op|'='
name|'cfg'
op|')'
newline|'\n'
name|'headers'
op|'.'
name|'update'
op|'('
name|'hdrs'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'put_start'
op|'('
name|'self'
op|'.'
name|'path'
op|','
name|'hdrs'
op|'='
name|'headers'
op|','
name|'parms'
op|'='
name|'parms'
op|','
name|'cfg'
op|'='
name|'cfg'
op|')'
newline|'\n'
nl|'\n'
name|'transferred'
op|'='
number|'0'
newline|'\n'
name|'buff'
op|'='
name|'data'
op|'.'
name|'read'
op|'('
name|'block_size'
op|')'
newline|'\n'
name|'buff_len'
op|'='
name|'len'
op|'('
name|'buff'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'while'
name|'buff_len'
op|'>'
number|'0'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'conn'
op|'.'
name|'put_data'
op|'('
name|'buff'
op|')'
newline|'\n'
name|'transferred'
op|'+='
name|'buff_len'
newline|'\n'
name|'if'
name|'callable'
op|'('
name|'callback'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'callback'
op|'('
name|'transferred'
op|','
name|'self'
op|'.'
name|'size'
op|')'
newline|'\n'
dedent|''
name|'buff'
op|'='
name|'data'
op|'.'
name|'read'
op|'('
name|'block_size'
op|')'
newline|'\n'
name|'buff_len'
op|'='
name|'len'
op|'('
name|'buff'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'conn'
op|'.'
name|'put_end'
op|'('
op|')'
newline|'\n'
dedent|''
name|'except'
name|'socket'
op|'.'
name|'timeout'
name|'as'
name|'err'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'err'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'status'
op|'<'
number|'200'
op|')'
name|'or'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|'.'
name|'status'
op|'>'
number|'299'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|','
string|"'PUT'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_path'
op|'('
name|'self'
op|'.'
name|'path'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'data'
op|'.'
name|'seek'
op|'('
number|'0'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'IOError'
op|':'
newline|'\n'
indent|'            '
name|'pass'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'md5'
op|'='
name|'self'
op|'.'
name|'compute_md5sum'
op|'('
name|'data'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'return_resp'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'True'
newline|'\n'
nl|'\n'
DECL|member|write_random
dedent|''
name|'def'
name|'write_random'
op|'('
name|'self'
op|','
name|'size'
op|'='
name|'None'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|','
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'data'
op|'='
name|'self'
op|'.'
name|'random_data'
op|'('
name|'size'
op|')'
newline|'\n'
name|'if'
name|'not'
name|'self'
op|'.'
name|'write'
op|'('
name|'data'
op|','
name|'hdrs'
op|'='
name|'hdrs'
op|','
name|'parms'
op|'='
name|'parms'
op|','
name|'cfg'
op|'='
name|'cfg'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|','
string|"'PUT'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'conn'
op|'.'
name|'make_path'
op|'('
name|'self'
op|'.'
name|'path'
op|')'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'md5'
op|'='
name|'self'
op|'.'
name|'compute_md5sum'
op|'('
name|'StringIO'
op|'.'
name|'StringIO'
op|'('
name|'data'
op|')'
op|')'
newline|'\n'
name|'return'
name|'data'
newline|'\n'
nl|'\n'
DECL|member|write_random_return_resp
dedent|''
name|'def'
name|'write_random_return_resp'
op|'('
name|'self'
op|','
name|'size'
op|'='
name|'None'
op|','
name|'hdrs'
op|'='
name|'None'
op|','
name|'parms'
op|'='
name|'None'
op|','
nl|'\n'
name|'cfg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'hdrs'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'hdrs'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'parms'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'parms'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'if'
name|'cfg'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'cfg'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'data'
op|'='
name|'self'
op|'.'
name|'random_data'
op|'('
name|'size'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'self'
op|'.'
name|'write'
op|'('
name|'data'
op|','
name|'hdrs'
op|'='
name|'hdrs'
op|','
name|'parms'
op|'='
name|'parms'
op|','
name|'cfg'
op|'='
name|'cfg'
op|','
nl|'\n'
name|'return_resp'
op|'='
name|'True'
op|')'
newline|'\n'
name|'if'
name|'not'
name|'resp'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ResponseError'
op|'('
name|'self'
op|'.'
name|'conn'
op|'.'
name|'response'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'md5'
op|'='
name|'self'
op|'.'
name|'compute_md5sum'
op|'('
name|'StringIO'
op|'.'
name|'StringIO'
op|'('
name|'data'
op|')'
op|')'
newline|'\n'
name|'return'
name|'resp'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
