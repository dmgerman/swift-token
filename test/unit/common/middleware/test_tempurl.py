begin_unit
comment|'# Copyright (c) 2011-2014 Greg Holt'
nl|'\n'
comment|'# Copyright (c) 2012-2013 Peter Portante'
nl|'\n'
comment|'# Copyright (c) 2012 Iryoung Jeong'
nl|'\n'
comment|'# Copyright (c) 2012 Michael Barton'
nl|'\n'
comment|'# Copyright (c) 2013 Alex Gaynor'
nl|'\n'
comment|'# Copyright (c) 2013 Chuck Thier'
nl|'\n'
comment|'# Copyright (c) 2013 David Goetz'
nl|'\n'
comment|'# Copyright (c) 2015 Donagh McCabe'
nl|'\n'
comment|'# Copyright (c) 2013 Greg Lange'
nl|'\n'
comment|'# Copyright (c) 2013 John Dickinson'
nl|'\n'
comment|'# Copyright (c) 2013 Kun Huang'
nl|'\n'
comment|'# Copyright (c) 2013 Richard Hawkins'
nl|'\n'
comment|'# Copyright (c) 2013 Samuel Merritt'
nl|'\n'
comment|'# Copyright (c) 2013 Shri Javadekar'
nl|'\n'
comment|'# Copyright (c) 2013 Tong Li'
nl|'\n'
comment|'# Copyright (c) 2013 ZhiQiang Fan'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Licensed under the Apache License, Version 2.0 (the "License");'
nl|'\n'
comment|'# you may not use this file except in compliance with the License.'
nl|'\n'
comment|'# You may obtain a copy of the License at'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    http://www.apache.org/licenses/LICENSE-2.0'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Unless required by applicable law or agreed to in writing, software'
nl|'\n'
comment|'# distributed under the License is distributed on an "AS IS" BASIS,'
nl|'\n'
comment|'# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or'
nl|'\n'
comment|'# implied.'
nl|'\n'
comment|'# See the License for the specific language governing permissions and'
nl|'\n'
comment|'# limitations under the License.'
nl|'\n'
nl|'\n'
name|'import'
name|'hmac'
newline|'\n'
name|'import'
name|'itertools'
newline|'\n'
name|'import'
name|'unittest'
newline|'\n'
name|'from'
name|'hashlib'
name|'import'
name|'sha1'
newline|'\n'
name|'from'
name|'time'
name|'import'
name|'time'
newline|'\n'
nl|'\n'
name|'from'
name|'swift'
op|'.'
name|'common'
op|'.'
name|'middleware'
name|'import'
name|'tempauth'
op|','
name|'tempurl'
newline|'\n'
name|'from'
name|'swift'
op|'.'
name|'common'
op|'.'
name|'swob'
name|'import'
name|'Request'
op|','
name|'Response'
op|','
name|'HeaderKeyDict'
newline|'\n'
name|'from'
name|'swift'
op|'.'
name|'common'
name|'import'
name|'utils'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|FakeApp
name|'class'
name|'FakeApp'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'status_headers_body_iter'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'calls'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'status_headers_body_iter'
op|'='
name|'status_headers_body_iter'
newline|'\n'
name|'if'
name|'not'
name|'self'
op|'.'
name|'status_headers_body_iter'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'status_headers_body_iter'
op|'='
name|'iter'
op|'('
nl|'\n'
name|'itertools'
op|'.'
name|'repeat'
op|'('
op|'('
nl|'\n'
string|"'404 Not Found'"
op|','
op|'{'
nl|'\n'
string|"'x-test-header-one-a'"
op|':'
string|"'value1'"
op|','
nl|'\n'
string|"'x-test-header-two-a'"
op|':'
string|"'value2'"
op|','
nl|'\n'
string|"'x-test-header-two-b'"
op|':'
string|"'value3'"
op|'}'
op|','
nl|'\n'
string|"''"
op|')'
op|')'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'request'
op|'='
name|'None'
newline|'\n'
nl|'\n'
DECL|member|__call__
dedent|''
name|'def'
name|'__call__'
op|'('
name|'self'
op|','
name|'env'
op|','
name|'start_response'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'calls'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'request'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|"''"
op|','
name|'environ'
op|'='
name|'env'
op|')'
newline|'\n'
name|'if'
string|"'swift.authorize'"
name|'in'
name|'env'
op|':'
newline|'\n'
indent|'            '
name|'resp'
op|'='
name|'env'
op|'['
string|"'swift.authorize'"
op|']'
op|'('
name|'self'
op|'.'
name|'request'
op|')'
newline|'\n'
name|'if'
name|'resp'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'resp'
op|'('
name|'env'
op|','
name|'start_response'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'status'
op|','
name|'headers'
op|','
name|'body'
op|'='
name|'next'
op|'('
name|'self'
op|'.'
name|'status_headers_body_iter'
op|')'
newline|'\n'
name|'return'
name|'Response'
op|'('
name|'status'
op|'='
name|'status'
op|','
name|'headers'
op|'='
name|'headers'
op|','
nl|'\n'
name|'body'
op|'='
name|'body'
op|')'
op|'('
name|'env'
op|','
name|'start_response'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestTempURL
dedent|''
dedent|''
name|'class'
name|'TestTempURL'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'app'
op|'='
name|'FakeApp'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'auth'
op|'='
name|'tempauth'
op|'.'
name|'filter_factory'
op|'('
op|'{'
string|"'reseller_prefix'"
op|':'
string|"''"
op|'}'
op|')'
op|'('
name|'self'
op|'.'
name|'app'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'='
name|'tempurl'
op|'.'
name|'filter_factory'
op|'('
op|'{'
op|'}'
op|')'
op|'('
name|'self'
op|'.'
name|'auth'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_make_request
dedent|''
name|'def'
name|'_make_request'
op|'('
name|'self'
op|','
name|'path'
op|','
name|'environ'
op|'='
name|'None'
op|','
name|'keys'
op|'='
op|'('
op|')'
op|','
name|'container_keys'
op|'='
name|'None'
op|','
nl|'\n'
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'environ'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'environ'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'_junk'
op|','
name|'account'
op|','
name|'_junk'
op|','
name|'_junk'
op|'='
name|'utils'
op|'.'
name|'split_path'
op|'('
name|'path'
op|','
number|'2'
op|','
number|'4'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_fake_cache_environ'
op|'('
name|'environ'
op|','
name|'account'
op|','
name|'keys'
op|','
nl|'\n'
name|'container_keys'
op|'='
name|'container_keys'
op|')'
newline|'\n'
name|'req'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
name|'path'
op|','
name|'environ'
op|'='
name|'environ'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
name|'return'
name|'req'
newline|'\n'
nl|'\n'
DECL|member|_fake_cache_environ
dedent|''
name|'def'
name|'_fake_cache_environ'
op|'('
name|'self'
op|','
name|'environ'
op|','
name|'account'
op|','
name|'keys'
op|','
name|'container_keys'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Fake out the caching layer for get_account_info(). Injects account data\n        into environ such that keys are the tempurl keys, if set.\n        """'
newline|'\n'
name|'meta'
op|'='
op|'{'
string|"'swash'"
op|':'
string|"'buckle'"
op|'}'
newline|'\n'
name|'for'
name|'idx'
op|','
name|'key'
name|'in'
name|'enumerate'
op|'('
name|'keys'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'meta_name'
op|'='
string|"'Temp-URL-key'"
op|'+'
op|'('
op|'('
string|'"-%d"'
op|'%'
op|'('
name|'idx'
op|'+'
number|'1'
op|')'
name|'if'
name|'idx'
name|'else'
string|'""'
op|')'
op|')'
newline|'\n'
name|'if'
name|'key'
op|':'
newline|'\n'
indent|'                '
name|'meta'
op|'['
name|'meta_name'
op|']'
op|'='
name|'key'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'environ'
op|'['
string|"'swift.account/'"
op|'+'
name|'account'
op|']'
op|'='
op|'{'
nl|'\n'
string|"'status'"
op|':'
number|'204'
op|','
nl|'\n'
string|"'container_count'"
op|':'
string|"'0'"
op|','
nl|'\n'
string|"'total_object_count'"
op|':'
string|"'0'"
op|','
nl|'\n'
string|"'bytes'"
op|':'
string|"'0'"
op|','
nl|'\n'
string|"'meta'"
op|':'
name|'meta'
op|'}'
newline|'\n'
nl|'\n'
name|'meta'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'for'
name|'i'
op|','
name|'key'
name|'in'
name|'enumerate'
op|'('
name|'container_keys'
name|'or'
op|'['
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'meta_name'
op|'='
string|"'Temp-URL-key'"
op|'+'
op|'('
op|'('
string|'"-%d"'
op|'%'
op|'('
name|'i'
op|'+'
number|'1'
op|')'
name|'if'
name|'i'
name|'else'
string|'""'
op|')'
op|')'
newline|'\n'
name|'meta'
op|'['
name|'meta_name'
op|']'
op|'='
name|'key'
newline|'\n'
nl|'\n'
dedent|''
name|'container_cache_key'
op|'='
string|"'swift.container/'"
op|'+'
name|'account'
op|'+'
string|"'/c'"
newline|'\n'
name|'environ'
op|'.'
name|'setdefault'
op|'('
name|'container_cache_key'
op|','
op|'{'
string|"'meta'"
op|':'
name|'meta'
op|'}'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_passthrough
dedent|''
name|'def'
name|'test_passthrough'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'resp'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
string|"'/v1/a/c/o'"
op|')'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'not'
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_allow_options
dedent|''
name|'def'
name|'test_allow_options'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'app'
op|'.'
name|'status_headers_body_iter'
op|'='
name|'iter'
op|'('
op|'['
op|'('
string|"'200 Ok'"
op|','
op|'{'
op|'}'
op|','
string|"''"
op|')'
op|']'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
string|"'/v1/a/c/o?temp_url_sig=abcde&temp_url_expires=12345'"
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'OPTIONS'"
op|'}'
op|')'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'200'
op|')'
newline|'\n'
nl|'\n'
DECL|member|assert_valid_sig
dedent|''
name|'def'
name|'assert_valid_sig'
op|'('
name|'self'
op|','
name|'expires'
op|','
name|'path'
op|','
name|'keys'
op|','
name|'sig'
op|','
name|'environ'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'not'
name|'environ'
op|':'
newline|'\n'
indent|'            '
name|'environ'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'environ'
op|'['
string|"'QUERY_STRING'"
op|']'
op|'='
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
name|'path'
op|','
name|'keys'
op|'='
name|'keys'
op|','
name|'environ'
op|'='
name|'environ'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'app'
op|'='
name|'FakeApp'
op|'('
name|'iter'
op|'('
op|'['
op|'('
string|"'200 Ok'"
op|','
op|'('
op|')'
op|','
string|"'123'"
op|')'
op|']'
op|')'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'200'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'headers'
op|'['
string|"'content-disposition'"
op|']'
op|','
nl|'\n'
string|'\'attachment; filename="o"; \''
op|'+'
string|'"filename*=UTF-8\'\'o"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize_override'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'REMOTE_USER'"
op|']'
op|','
string|"'.wsgi.tempurl'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_valid
dedent|''
name|'def'
name|'test_get_valid'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assert_valid_sig'
op|'('
name|'expires'
op|','
name|'path'
op|','
op|'['
name|'key'
op|']'
op|','
name|'sig'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_valid_key2
dedent|''
name|'def'
name|'test_get_valid_key2'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key1'
op|'='
string|"'abc123'"
newline|'\n'
name|'key2'
op|'='
string|"'def456'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig1'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key1'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'sig2'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key2'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'for'
name|'sig'
name|'in'
op|'('
name|'sig1'
op|','
name|'sig2'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assert_valid_sig'
op|'('
name|'expires'
op|','
name|'path'
op|','
op|'['
name|'key1'
op|','
name|'key2'
op|']'
op|','
name|'sig'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_valid_container_keys
dedent|''
dedent|''
name|'def'
name|'test_get_valid_container_keys'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'environ'
op|'='
op|'{'
op|'}'
newline|'\n'
comment|'# Add two static container keys'
nl|'\n'
name|'container_keys'
op|'='
op|'['
string|"'me'"
op|','
string|"'other'"
op|']'
newline|'\n'
name|'meta'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'for'
name|'idx'
op|','
name|'key'
name|'in'
name|'enumerate'
op|'('
name|'container_keys'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'meta_name'
op|'='
string|"'Temp-URL-key'"
op|'+'
op|'('
op|'('
string|'"-%d"'
op|'%'
op|'('
name|'idx'
op|'+'
number|'1'
op|')'
name|'if'
name|'idx'
name|'else'
string|'""'
op|')'
op|')'
newline|'\n'
name|'if'
name|'key'
op|':'
newline|'\n'
indent|'                '
name|'meta'
op|'['
name|'meta_name'
op|']'
op|'='
name|'key'
newline|'\n'
dedent|''
dedent|''
name|'environ'
op|'['
string|"'swift.container/a/c'"
op|']'
op|'='
op|'{'
string|"'meta'"
op|':'
name|'meta'
op|'}'
newline|'\n'
nl|'\n'
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key1'
op|'='
string|"'me'"
newline|'\n'
name|'key2'
op|'='
string|"'other'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig1'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key1'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'sig2'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key2'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'account_keys'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'sig'
name|'in'
op|'('
name|'sig1'
op|','
name|'sig2'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assert_valid_sig'
op|'('
name|'expires'
op|','
name|'path'
op|','
name|'account_keys'
op|','
name|'sig'
op|','
name|'environ'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_valid_with_filename
dedent|''
dedent|''
name|'def'
name|'test_get_valid_with_filename'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
name|'environ'
op|'='
op|'{'
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s&'"
nl|'\n'
string|"'filename=bob%%20%%22killer%%22.txt'"
op|'%'
op|'('
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'app'
op|'='
name|'FakeApp'
op|'('
name|'iter'
op|'('
op|'['
op|'('
string|"'200 Ok'"
op|','
op|'('
op|')'
op|','
string|"'123'"
op|')'
op|']'
op|')'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'200'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'headers'
op|'['
string|"'content-disposition'"
op|']'
op|','
nl|'\n'
string|'\'attachment; filename="bob %22killer%22.txt"; \''
op|'+'
nl|'\n'
string|'"filename*=UTF-8\'\'bob%20%22killer%22.txt"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize_override'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'REMOTE_USER'"
op|']'
op|','
string|"'.wsgi.tempurl'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_head_valid
dedent|''
name|'def'
name|'test_head_valid'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'HEAD'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
name|'environ'
op|'='
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'HEAD'"
op|','
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
nl|'\n'
op|'%'
op|'('
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'app'
op|'='
name|'FakeApp'
op|'('
name|'iter'
op|'('
op|'['
op|'('
string|"'200 Ok'"
op|','
op|'('
op|')'
op|','
string|"'123'"
op|')'
op|']'
op|')'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'200'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_valid_with_filename_and_inline
dedent|''
name|'def'
name|'test_get_valid_with_filename_and_inline'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
name|'environ'
op|'='
op|'{'
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s&'"
nl|'\n'
string|"'filename=bob%%20%%22killer%%22.txt&inline='"
op|'%'
op|'('
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'app'
op|'='
name|'FakeApp'
op|'('
name|'iter'
op|'('
op|'['
op|'('
string|"'200 Ok'"
op|','
op|'('
op|')'
op|','
string|"'123'"
op|')'
op|']'
op|')'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'200'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'headers'
op|'['
string|"'content-disposition'"
op|']'
op|','
string|"'inline'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize_override'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'REMOTE_USER'"
op|']'
op|','
string|"'.wsgi.tempurl'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_valid_with_inline
dedent|''
name|'def'
name|'test_get_valid_with_inline'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
name|'environ'
op|'='
op|'{'
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s&'"
nl|'\n'
string|"'inline='"
op|'%'
op|'('
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'app'
op|'='
name|'FakeApp'
op|'('
name|'iter'
op|'('
op|'['
op|'('
string|"'200 Ok'"
op|','
op|'('
op|')'
op|','
string|"'123'"
op|')'
op|']'
op|')'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'200'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'headers'
op|'['
string|"'content-disposition'"
op|']'
op|','
string|"'inline'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize_override'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'REMOTE_USER'"
op|']'
op|','
string|"'.wsgi.tempurl'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_obj_odd_chars
dedent|''
name|'def'
name|'test_obj_odd_chars'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/a\\r\\nb'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
name|'environ'
op|'='
op|'{'
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'app'
op|'='
name|'FakeApp'
op|'('
name|'iter'
op|'('
op|'['
op|'('
string|"'200 Ok'"
op|','
op|'('
op|')'
op|','
string|"'123'"
op|')'
op|']'
op|')'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'200'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'headers'
op|'['
string|"'content-disposition'"
op|']'
op|','
nl|'\n'
string|'\'attachment; filename="a%0D%0Ab"; \''
op|'+'
nl|'\n'
string|'"filename*=UTF-8\'\'a%0D%0Ab"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize_override'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'REMOTE_USER'"
op|']'
op|','
string|"'.wsgi.tempurl'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_obj_odd_chars_in_content_disposition_metadata
dedent|''
name|'def'
name|'test_obj_odd_chars_in_content_disposition_metadata'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
name|'environ'
op|'='
op|'{'
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'headers'
op|'='
op|'['
op|'('
string|"'Content-Disposition'"
op|','
string|'\'attachment; filename="fu\\nbar"\''
op|')'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'app'
op|'='
name|'FakeApp'
op|'('
name|'iter'
op|'('
op|'['
op|'('
string|"'200 Ok'"
op|','
name|'headers'
op|','
string|"'123'"
op|')'
op|']'
op|')'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'200'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'headers'
op|'['
string|"'content-disposition'"
op|']'
op|','
nl|'\n'
string|'\'attachment; filename="fu%0Abar"\''
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize_override'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'REMOTE_USER'"
op|']'
op|','
string|"'.wsgi.tempurl'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_obj_trailing_slash
dedent|''
name|'def'
name|'test_obj_trailing_slash'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o/'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
name|'environ'
op|'='
op|'{'
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'app'
op|'='
name|'FakeApp'
op|'('
name|'iter'
op|'('
op|'['
op|'('
string|"'200 Ok'"
op|','
op|'('
op|')'
op|','
string|"'123'"
op|')'
op|']'
op|')'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'200'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'headers'
op|'['
string|"'content-disposition'"
op|']'
op|','
nl|'\n'
string|'\'attachment; filename="o"; \''
op|'+'
nl|'\n'
string|'"filename*=UTF-8\'\'o"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize_override'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'REMOTE_USER'"
op|']'
op|','
string|"'.wsgi.tempurl'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_filename_trailing_slash
dedent|''
name|'def'
name|'test_filename_trailing_slash'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
name|'environ'
op|'='
op|'{'
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s&'"
nl|'\n'
string|"'filename=/i/want/this/just/as/it/is/'"
op|'%'
op|'('
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'app'
op|'='
name|'FakeApp'
op|'('
name|'iter'
op|'('
op|'['
op|'('
string|"'200 Ok'"
op|','
op|'('
op|')'
op|','
string|"'123'"
op|')'
op|']'
op|')'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'200'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'resp'
op|'.'
name|'headers'
op|'['
string|"'content-disposition'"
op|']'
op|','
nl|'\n'
string|'\'attachment; filename="/i/want/this/just/as/it/is/"; \''
op|'+'
nl|'\n'
string|'"filename*=UTF-8\'\'/i/want/this/just/as/it/is/"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize_override'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'REMOTE_USER'"
op|']'
op|','
string|"'.wsgi.tempurl'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_valid_but_404
dedent|''
name|'def'
name|'test_get_valid_but_404'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertFalse'
op|'('
string|"'content-disposition'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize_override'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'REMOTE_USER'"
op|']'
op|','
string|"'.wsgi.tempurl'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_put_not_allowed_by_get
dedent|''
name|'def'
name|'test_put_not_allowed_by_get'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|','
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_put_valid
dedent|''
name|'def'
name|'test_put_valid'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|','
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize_override'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'REMOTE_USER'"
op|']'
op|','
string|"'.wsgi.tempurl'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_not_allowed_by_put
dedent|''
name|'def'
name|'test_get_not_allowed_by_put'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_missing_sig
dedent|''
name|'def'
name|'test_missing_sig'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_expires=%s'"
op|'%'
name|'expires'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_missing_expires
dedent|''
name|'def'
name|'test_missing_expires'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s'"
op|'%'
name|'sig'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_bad_path
dedent|''
name|'def'
name|'test_bad_path'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_no_key
dedent|''
name|'def'
name|'test_no_key'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_head_allowed_by_get
dedent|''
name|'def'
name|'test_head_allowed_by_get'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'HEAD'"
op|','
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize_override'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'REMOTE_USER'"
op|']'
op|','
string|"'.wsgi.tempurl'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_head_allowed_by_put
dedent|''
name|'def'
name|'test_head_allowed_by_put'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'HEAD'"
op|','
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize_override'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'REMOTE_USER'"
op|']'
op|','
string|"'.wsgi.tempurl'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_head_allowed_by_post
dedent|''
name|'def'
name|'test_head_allowed_by_post'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'HEAD'"
op|','
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize_override'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'req'
op|'.'
name|'environ'
op|'['
string|"'REMOTE_USER'"
op|']'
op|','
string|"'.wsgi.tempurl'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_head_otherwise_not_allowed
dedent|''
name|'def'
name|'test_head_otherwise_not_allowed'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
comment|"# Deliberately fudge expires to show HEADs aren't just automatically"
nl|'\n'
comment|'# allowed.'
nl|'\n'
name|'expires'
op|'+='
number|'1'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'HEAD'"
op|','
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_post_when_forbidden_by_config
dedent|''
name|'def'
name|'test_post_when_forbidden_by_config'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'conf'
op|'['
string|"'methods'"
op|']'
op|'.'
name|'remove'
op|'('
string|"'POST'"
op|')'
newline|'\n'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'POST'"
op|','
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_delete_when_forbidden_by_config
dedent|''
name|'def'
name|'test_delete_when_forbidden_by_config'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'conf'
op|'['
string|"'methods'"
op|']'
op|'.'
name|'remove'
op|'('
string|"'DELETE'"
op|')'
newline|'\n'
name|'method'
op|'='
string|"'DELETE'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|','
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_delete_allowed
dedent|''
name|'def'
name|'test_delete_allowed'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'DELETE'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|','
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_unknown_not_allowed
dedent|''
name|'def'
name|'test_unknown_not_allowed'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'UNKNOWN'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'UNKNOWN'"
op|','
nl|'\n'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_authorize_limits_scope
dedent|''
name|'def'
name|'test_authorize_limits_scope'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req_other_object'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|'"/v1/a/c/o2"'
op|')'
newline|'\n'
name|'req_other_container'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|'"/v1/a/c2/o2"'
op|')'
newline|'\n'
name|'req_other_account'
op|'='
name|'Request'
op|'.'
name|'blank'
op|'('
string|'"/v1/a2/c2/o2"'
op|')'
newline|'\n'
nl|'\n'
name|'key_kwargs'
op|'='
op|'{'
nl|'\n'
string|"'keys'"
op|':'
op|'['
string|"'account-key'"
op|','
string|"'shared-key'"
op|']'
op|','
nl|'\n'
string|"'container_keys'"
op|':'
op|'['
string|"'container-key'"
op|','
string|"'shared-key'"
op|']'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
comment|'# A request with the account key limits the pre-authed scope to the'
nl|'\n'
comment|'# account level.'
nl|'\n'
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
nl|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
string|"'account-key'"
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'qs'
op|'='
string|"'?temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
name|'sig'
op|','
name|'expires'
op|')'
newline|'\n'
nl|'\n'
comment|'# make request will setup the environ cache for us'
nl|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
name|'path'
op|'+'
name|'qs'
op|','
op|'**'
name|'key_kwargs'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
comment|'# sanity check'
newline|'\n'
nl|'\n'
name|'authorize'
op|'='
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize'"
op|']'
newline|'\n'
comment|"# Requests for other objects happen if, for example, you're"
nl|'\n'
comment|'# downloading a large object or creating a large-object manifest.'
nl|'\n'
name|'oo_resp'
op|'='
name|'authorize'
op|'('
name|'req_other_object'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'oo_resp'
op|','
name|'None'
op|')'
newline|'\n'
name|'oc_resp'
op|'='
name|'authorize'
op|'('
name|'req_other_container'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'oc_resp'
op|','
name|'None'
op|')'
newline|'\n'
name|'oa_resp'
op|'='
name|'authorize'
op|'('
name|'req_other_account'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'oa_resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
nl|'\n'
comment|'# A request with the container key limits the pre-authed scope to'
nl|'\n'
comment|'# the container level; a different container in the same account is'
nl|'\n'
comment|'# out of scope and thus forbidden.'
nl|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
string|"'container-key'"
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'qs'
op|'='
string|"'?temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
name|'sig'
op|','
name|'expires'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
name|'path'
op|'+'
name|'qs'
op|','
op|'**'
name|'key_kwargs'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
comment|'# sanity check'
newline|'\n'
nl|'\n'
name|'authorize'
op|'='
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize'"
op|']'
newline|'\n'
name|'oo_resp'
op|'='
name|'authorize'
op|'('
name|'req_other_object'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'oo_resp'
op|','
name|'None'
op|')'
newline|'\n'
name|'oc_resp'
op|'='
name|'authorize'
op|'('
name|'req_other_container'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'oc_resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'oa_resp'
op|'='
name|'authorize'
op|'('
name|'req_other_account'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'oa_resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
nl|'\n'
comment|'# If account and container share a key (users set these, so this can'
nl|'\n'
comment|'# happen by accident, stupidity, *or* malice!), limit the scope to'
nl|'\n'
comment|'# account level. This prevents someone from shrinking the scope of'
nl|'\n'
comment|"# account-level tempurls by reusing one of the account's keys on a"
nl|'\n'
comment|'# container.'
nl|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
string|"'shared-key'"
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'qs'
op|'='
string|"'?temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
name|'sig'
op|','
name|'expires'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
name|'path'
op|'+'
name|'qs'
op|','
op|'**'
name|'key_kwargs'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
comment|'# sanity check'
newline|'\n'
nl|'\n'
name|'authorize'
op|'='
name|'req'
op|'.'
name|'environ'
op|'['
string|"'swift.authorize'"
op|']'
newline|'\n'
name|'oo_resp'
op|'='
name|'authorize'
op|'('
name|'req_other_object'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'oo_resp'
op|','
name|'None'
op|')'
newline|'\n'
name|'oc_resp'
op|'='
name|'authorize'
op|'('
name|'req_other_container'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'oc_resp'
op|','
name|'None'
op|')'
newline|'\n'
name|'oa_resp'
op|'='
name|'authorize'
op|'('
name|'req_other_account'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'oa_resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_changed_path_invalid
dedent|''
name|'def'
name|'test_changed_path_invalid'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|'+'
string|"'2'"
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_changed_sig_invalid
dedent|''
name|'def'
name|'test_changed_sig_invalid'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'if'
name|'sig'
op|'['
op|'-'
number|'1'
op|']'
op|'!='
string|"'0'"
op|':'
newline|'\n'
indent|'            '
name|'sig'
op|'='
name|'sig'
op|'['
op|':'
op|'-'
number|'1'
op|']'
op|'+'
string|"'0'"
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'sig'
op|'='
name|'sig'
op|'['
op|':'
op|'-'
number|'1'
op|']'
op|'+'
string|"'1'"
newline|'\n'
dedent|''
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_changed_expires_invalid
dedent|''
name|'def'
name|'test_changed_expires_invalid'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|'+'
number|'1'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_different_key_invalid
dedent|''
name|'def'
name|'test_different_key_invalid'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|'+'
string|"'2'"
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_disallowed_header_object_manifest
dedent|''
name|'def'
name|'test_disallowed_header_object_manifest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'tempurl'
op|'='
name|'tempurl'
op|'.'
name|'filter_factory'
op|'('
op|'{'
op|'}'
op|')'
op|'('
name|'self'
op|'.'
name|'auth'
op|')'
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'for'
name|'method'
name|'in'
op|'('
string|"'PUT'"
op|','
string|"'POST'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'method'
op|'='
name|'method'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'x-object-manifest'"
op|':'
string|"'private/secret'"
op|'}'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
nl|'\n'
op|'%'
op|'('
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'400'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'header'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'not allowed'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'X-Object-Manifest'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_removed_incoming_header
dedent|''
dedent|''
name|'def'
name|'test_removed_incoming_header'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'tempurl'
op|'='
name|'tempurl'
op|'.'
name|'filter_factory'
op|'('
op|'{'
nl|'\n'
string|"'incoming_remove_headers'"
op|':'
string|"'x-remove-this'"
op|'}'
op|')'
op|'('
name|'self'
op|'.'
name|'auth'
op|')'
newline|'\n'
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'x-remove-this'"
op|':'
string|"'value'"
op|'}'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'x-remove-this'"
name|'not'
name|'in'
name|'self'
op|'.'
name|'app'
op|'.'
name|'request'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_removed_incoming_headers_match
dedent|''
name|'def'
name|'test_removed_incoming_headers_match'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'tempurl'
op|'='
name|'tempurl'
op|'.'
name|'filter_factory'
op|'('
op|'{'
nl|'\n'
string|"'incoming_remove_headers'"
op|':'
string|"'x-remove-this-*'"
op|','
nl|'\n'
string|"'incoming_allow_headers'"
op|':'
string|"'x-remove-this-except-this'"
op|'}'
op|')'
op|'('
name|'self'
op|'.'
name|'auth'
op|')'
newline|'\n'
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'x-remove-this-one'"
op|':'
string|"'value1'"
op|','
nl|'\n'
string|"'x-remove-this-except-this'"
op|':'
string|"'value2'"
op|'}'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'x-remove-this-one'"
name|'not'
name|'in'
name|'self'
op|'.'
name|'app'
op|'.'
name|'request'
op|'.'
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'app'
op|'.'
name|'request'
op|'.'
name|'headers'
op|'['
string|"'x-remove-this-except-this'"
op|']'
op|','
string|"'value2'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_allow_trumps_incoming_header_conflict
dedent|''
name|'def'
name|'test_allow_trumps_incoming_header_conflict'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'tempurl'
op|'='
name|'tempurl'
op|'.'
name|'filter_factory'
op|'('
op|'{'
nl|'\n'
string|"'incoming_remove_headers'"
op|':'
string|"'x-conflict-header'"
op|','
nl|'\n'
string|"'incoming_allow_headers'"
op|':'
string|"'x-conflict-header'"
op|'}'
op|')'
op|'('
name|'self'
op|'.'
name|'auth'
op|')'
newline|'\n'
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'x-conflict-header'"
op|':'
string|"'value'"
op|'}'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'x-conflict-header'"
name|'in'
name|'self'
op|'.'
name|'app'
op|'.'
name|'request'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_allow_trumps_incoming_header_startswith_conflict
dedent|''
name|'def'
name|'test_allow_trumps_incoming_header_startswith_conflict'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'tempurl'
op|'='
name|'tempurl'
op|'.'
name|'filter_factory'
op|'('
op|'{'
nl|'\n'
string|"'incoming_remove_headers'"
op|':'
string|"'x-conflict-header-*'"
op|','
nl|'\n'
string|"'incoming_allow_headers'"
op|':'
string|"'x-conflict-header-*'"
op|'}'
op|')'
op|'('
name|'self'
op|'.'
name|'auth'
op|')'
newline|'\n'
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
string|"'x-conflict-header-test'"
op|':'
string|"'value'"
op|'}'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'x-conflict-header-test'"
name|'in'
name|'self'
op|'.'
name|'app'
op|'.'
name|'request'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_removed_outgoing_header
dedent|''
name|'def'
name|'test_removed_outgoing_header'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'tempurl'
op|'='
name|'tempurl'
op|'.'
name|'filter_factory'
op|'('
op|'{'
nl|'\n'
string|"'outgoing_remove_headers'"
op|':'
string|"'x-test-header-one-a'"
op|'}'
op|')'
op|'('
name|'self'
op|'.'
name|'auth'
op|')'
newline|'\n'
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'x-test-header-one-a'"
name|'not'
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'headers'
op|'['
string|"'x-test-header-two-a'"
op|']'
op|','
string|"'value2'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_removed_outgoing_headers_match
dedent|''
name|'def'
name|'test_removed_outgoing_headers_match'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'tempurl'
op|'='
name|'tempurl'
op|'.'
name|'filter_factory'
op|'('
op|'{'
nl|'\n'
string|"'outgoing_remove_headers'"
op|':'
string|"'x-test-header-two-*'"
op|','
nl|'\n'
string|"'outgoing_allow_headers'"
op|':'
string|"'x-test-header-two-b'"
op|'}'
op|')'
op|'('
name|'self'
op|'.'
name|'auth'
op|')'
newline|'\n'
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'404'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'headers'
op|'['
string|"'x-test-header-one-a'"
op|']'
op|','
string|"'value1'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'x-test-header-two-a'"
name|'not'
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'headers'
op|'['
string|"'x-test-header-two-b'"
op|']'
op|','
string|"'value3'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_allow_trumps_outgoing_header_conflict
dedent|''
name|'def'
name|'test_allow_trumps_outgoing_header_conflict'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'tempurl'
op|'='
name|'tempurl'
op|'.'
name|'filter_factory'
op|'('
op|'{'
nl|'\n'
string|"'outgoing_remove_headers'"
op|':'
string|"'x-conflict-header'"
op|','
nl|'\n'
string|"'outgoing_allow_headers'"
op|':'
string|"'x-conflict-header'"
op|'}'
op|')'
op|'('
name|'self'
op|'.'
name|'auth'
op|')'
newline|'\n'
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
op|'}'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'app'
op|'='
name|'FakeApp'
op|'('
name|'iter'
op|'('
op|'['
op|'('
string|"'200 Ok'"
op|','
op|'{'
nl|'\n'
string|"'X-Conflict-Header'"
op|':'
string|"'value'"
op|'}'
op|','
string|"'123'"
op|')'
op|']'
op|')'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'200'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'x-conflict-header'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'headers'
op|'['
string|"'x-conflict-header'"
op|']'
op|','
string|"'value'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_allow_trumps_outgoing_header_startswith_conflict
dedent|''
name|'def'
name|'test_allow_trumps_outgoing_header_startswith_conflict'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'tempurl'
op|'='
name|'tempurl'
op|'.'
name|'filter_factory'
op|'('
op|'{'
nl|'\n'
string|"'outgoing_remove_headers'"
op|':'
string|"'x-conflict-header-*'"
op|','
nl|'\n'
string|"'outgoing_allow_headers'"
op|':'
string|"'x-conflict-header-*'"
op|'}'
op|')'
op|'('
name|'self'
op|'.'
name|'auth'
op|')'
newline|'\n'
name|'method'
op|'='
string|"'GET'"
newline|'\n'
name|'expires'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'path'
op|'='
string|"'/v1/a/c/o'"
newline|'\n'
name|'key'
op|'='
string|"'abc'"
newline|'\n'
name|'hmac_body'
op|'='
string|"'%s\\n%s\\n%s'"
op|'%'
op|'('
name|'method'
op|','
name|'expires'
op|','
name|'path'
op|')'
newline|'\n'
name|'sig'
op|'='
name|'hmac'
op|'.'
name|'new'
op|'('
name|'key'
op|','
name|'hmac_body'
op|','
name|'sha1'
op|')'
op|'.'
name|'hexdigest'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
nl|'\n'
name|'path'
op|','
name|'keys'
op|'='
op|'['
name|'key'
op|']'
op|','
nl|'\n'
name|'headers'
op|'='
op|'{'
op|'}'
op|','
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'sig'
op|','
name|'expires'
op|')'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'app'
op|'='
name|'FakeApp'
op|'('
name|'iter'
op|'('
op|'['
op|'('
string|"'200 Ok'"
op|','
op|'{'
nl|'\n'
string|"'X-Conflict-Header-Test'"
op|':'
string|"'value'"
op|'}'
op|','
string|"'123'"
op|')'
op|']'
op|')'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'200'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'x-conflict-header-test'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'headers'
op|'['
string|"'x-conflict-header-test'"
op|']'
op|','
string|"'value'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_account_and_container
dedent|''
name|'def'
name|'test_get_account_and_container'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_account_and_container'
op|'('
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'HEAD'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v1/a/c/o'"
op|'}'
op|')'
op|','
op|'('
string|"'a'"
op|','
string|"'c'"
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_account_and_container'
op|'('
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v1/a/c/o'"
op|'}'
op|')'
op|','
op|'('
string|"'a'"
op|','
string|"'c'"
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_account_and_container'
op|'('
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v1/a/c/o'"
op|'}'
op|')'
op|','
op|'('
string|"'a'"
op|','
string|"'c'"
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_account_and_container'
op|'('
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'POST'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v1/a/c/o'"
op|'}'
op|')'
op|','
op|'('
string|"'a'"
op|','
string|"'c'"
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_account_and_container'
op|'('
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'DELETE'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v1/a/c/o'"
op|'}'
op|')'
op|','
op|'('
string|"'a'"
op|','
string|"'c'"
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_account_and_container'
op|'('
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'UNKNOWN'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v1/a/c/o'"
op|'}'
op|')'
op|','
nl|'\n'
op|'('
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_account_and_container'
op|'('
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v1/a/c/'"
op|'}'
op|')'
op|','
op|'('
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_account_and_container'
op|'('
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v1/a/c//////'"
op|'}'
op|')'
op|','
nl|'\n'
op|'('
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_account_and_container'
op|'('
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v1/a/c///o///'"
op|'}'
op|')'
op|','
nl|'\n'
op|'('
string|"'a'"
op|','
string|"'c'"
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_account_and_container'
op|'('
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v1/a/c'"
op|'}'
op|')'
op|','
op|'('
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_account_and_container'
op|'('
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v1/a//o'"
op|'}'
op|')'
op|','
op|'('
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_account_and_container'
op|'('
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v1//c/o'"
op|'}'
op|')'
op|','
op|'('
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_account_and_container'
op|'('
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'//a/c/o'"
op|'}'
op|')'
op|','
op|'('
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_account_and_container'
op|'('
op|'{'
nl|'\n'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v2/a/c/o'"
op|'}'
op|')'
op|','
op|'('
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_temp_url_info
dedent|''
name|'def'
name|'test_get_temp_url_info'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'s'
op|'='
string|"'f5d5051bddf5df7e27c628818738334f'"
newline|'\n'
name|'e'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'+'
number|'86400'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_temp_url_info'
op|'('
nl|'\n'
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'s'
op|','
name|'e'
op|')'
op|'}'
op|')'
op|','
nl|'\n'
op|'('
name|'s'
op|','
name|'e'
op|','
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_temp_url_info'
op|'('
nl|'\n'
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s&'"
nl|'\n'
string|"'filename=bobisyouruncle'"
op|'%'
op|'('
name|'s'
op|','
name|'e'
op|')'
op|'}'
op|')'
op|','
nl|'\n'
op|'('
name|'s'
op|','
name|'e'
op|','
string|"'bobisyouruncle'"
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_temp_url_info'
op|'('
op|'{'
op|'}'
op|')'
op|','
nl|'\n'
op|'('
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_temp_url_info'
op|'('
nl|'\n'
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_expires=%s'"
op|'%'
name|'e'
op|'}'
op|')'
op|','
nl|'\n'
op|'('
name|'None'
op|','
name|'e'
op|','
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_temp_url_info'
op|'('
nl|'\n'
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s'"
op|'%'
name|'s'
op|'}'
op|')'
op|','
nl|'\n'
op|'('
name|'s'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_temp_url_info'
op|'('
nl|'\n'
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=bad'"
op|'%'
op|'('
nl|'\n'
name|'s'
op|')'
op|'}'
op|')'
op|','
nl|'\n'
op|'('
name|'s'
op|','
number|'0'
op|','
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_temp_url_info'
op|'('
nl|'\n'
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s&'"
nl|'\n'
string|"'inline='"
op|'%'
op|'('
name|'s'
op|','
name|'e'
op|')'
op|'}'
op|')'
op|','
nl|'\n'
op|'('
name|'s'
op|','
name|'e'
op|','
name|'None'
op|','
name|'True'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_temp_url_info'
op|'('
nl|'\n'
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s&'"
nl|'\n'
string|"'filename=bobisyouruncle&inline='"
op|'%'
op|'('
name|'s'
op|','
name|'e'
op|')'
op|'}'
op|')'
op|','
nl|'\n'
op|'('
name|'s'
op|','
name|'e'
op|','
string|"'bobisyouruncle'"
op|','
name|'True'
op|')'
op|')'
newline|'\n'
name|'e'
op|'='
name|'int'
op|'('
name|'time'
op|'('
op|')'
op|'-'
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_temp_url_info'
op|'('
nl|'\n'
op|'{'
string|"'QUERY_STRING'"
op|':'
string|"'temp_url_sig=%s&temp_url_expires=%s'"
op|'%'
op|'('
nl|'\n'
name|'s'
op|','
name|'e'
op|')'
op|'}'
op|')'
op|','
nl|'\n'
op|'('
name|'s'
op|','
number|'0'
op|','
name|'None'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_hmacs
dedent|''
name|'def'
name|'test_get_hmacs'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_hmacs'
op|'('
nl|'\n'
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v1/a/c/o'"
op|'}'
op|','
nl|'\n'
number|'1'
op|','
op|'['
op|'('
string|"'abc'"
op|','
string|"'account'"
op|')'
op|']'
op|')'
op|','
nl|'\n'
op|'['
op|'('
string|"'026d7f7cc25256450423c7ad03fc9f5ffc1dab6d'"
op|','
string|"'account'"
op|')'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_get_hmacs'
op|'('
nl|'\n'
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'HEAD'"
op|','
string|"'PATH_INFO'"
op|':'
string|"'/v1/a/c/o'"
op|'}'
op|','
nl|'\n'
number|'1'
op|','
op|'['
op|'('
string|"'abc'"
op|','
string|"'account'"
op|')'
op|']'
op|','
name|'request_method'
op|'='
string|"'GET'"
op|')'
op|','
nl|'\n'
op|'['
op|'('
string|"'026d7f7cc25256450423c7ad03fc9f5ffc1dab6d'"
op|','
string|"'account'"
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_invalid
dedent|''
name|'def'
name|'test_invalid'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|function|_start_response
indent|'        '
name|'def'
name|'_start_response'
op|'('
name|'status'
op|','
name|'headers'
op|','
name|'exc_info'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'status'
op|','
string|"'401 Unauthorized'"
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
string|"''"
op|'.'
name|'join'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_invalid'
op|'('
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'GET'"
op|'}'
op|','
nl|'\n'
name|'_start_response'
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"''"
op|','
string|"''"
op|'.'
name|'join'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'tempurl'
op|'.'
name|'_invalid'
op|'('
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'HEAD'"
op|'}'
op|','
nl|'\n'
name|'_start_response'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_auth_scheme_value
dedent|''
name|'def'
name|'test_auth_scheme_value'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# Passthrough'
nl|'\n'
indent|'        '
name|'environ'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'resp'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
string|"'/v1/a/c/o'"
op|','
name|'environ'
op|'='
name|'environ'
op|')'
op|'.'
name|'get_response'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'not'
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'swift.auth_scheme'"
name|'not'
name|'in'
name|'environ'
op|')'
newline|'\n'
nl|'\n'
comment|'# Rejected by TempURL'
nl|'\n'
name|'environ'
op|'='
op|'{'
string|"'REQUEST_METHOD'"
op|':'
string|"'PUT'"
op|','
nl|'\n'
string|"'QUERY_STRING'"
op|':'
nl|'\n'
string|"'temp_url_sig=dummy&temp_url_expires=1234'"
op|'}'
newline|'\n'
name|'req'
op|'='
name|'self'
op|'.'
name|'_make_request'
op|'('
string|"'/v1/a/c/o'"
op|','
name|'keys'
op|'='
op|'['
string|"'abc'"
op|']'
op|','
nl|'\n'
name|'environ'
op|'='
name|'environ'
op|')'
newline|'\n'
name|'resp'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'self'
op|'.'
name|'tempurl'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resp'
op|'.'
name|'status_int'
op|','
number|'401'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Temp URL invalid'"
name|'in'
name|'resp'
op|'.'
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'Www-Authenticate'"
name|'in'
name|'resp'
op|'.'
name|'headers'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_clean_incoming_headers
dedent|''
name|'def'
name|'test_clean_incoming_headers'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'irh'
op|'='
op|'['
op|']'
newline|'\n'
name|'iah'
op|'='
op|'['
op|']'
newline|'\n'
name|'env'
op|'='
op|'{'
string|"'HTTP_TEST_HEADER'"
op|':'
string|"'value'"
op|'}'
newline|'\n'
name|'tempurl'
op|'.'
name|'TempURL'
op|'('
nl|'\n'
name|'None'
op|','
op|'{'
string|"'incoming_remove_headers'"
op|':'
name|'irh'
op|','
nl|'\n'
string|"'incoming_allow_headers'"
op|':'
name|'iah'
op|'}'
nl|'\n'
op|')'
op|'.'
name|'_clean_incoming_headers'
op|'('
name|'env'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'HTTP_TEST_HEADER'"
name|'in'
name|'env'
op|')'
newline|'\n'
nl|'\n'
name|'irh'
op|'='
op|'['
string|"'test-header'"
op|']'
newline|'\n'
name|'iah'
op|'='
op|'['
op|']'
newline|'\n'
name|'env'
op|'='
op|'{'
string|"'HTTP_TEST_HEADER'"
op|':'
string|"'value'"
op|'}'
newline|'\n'
name|'tempurl'
op|'.'
name|'TempURL'
op|'('
nl|'\n'
name|'None'
op|','
op|'{'
string|"'incoming_remove_headers'"
op|':'
name|'irh'
op|','
nl|'\n'
string|"'incoming_allow_headers'"
op|':'
name|'iah'
op|'}'
nl|'\n'
op|')'
op|'.'
name|'_clean_incoming_headers'
op|'('
name|'env'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'HTTP_TEST_HEADER'"
name|'not'
name|'in'
name|'env'
op|')'
newline|'\n'
nl|'\n'
name|'irh'
op|'='
op|'['
string|"'test-header-*'"
op|']'
newline|'\n'
name|'iah'
op|'='
op|'['
op|']'
newline|'\n'
name|'env'
op|'='
op|'{'
string|"'HTTP_TEST_HEADER_ONE'"
op|':'
string|"'value'"
op|','
nl|'\n'
string|"'HTTP_TEST_HEADER_TWO'"
op|':'
string|"'value'"
op|'}'
newline|'\n'
name|'tempurl'
op|'.'
name|'TempURL'
op|'('
nl|'\n'
name|'None'
op|','
op|'{'
string|"'incoming_remove_headers'"
op|':'
name|'irh'
op|','
nl|'\n'
string|"'incoming_allow_headers'"
op|':'
name|'iah'
op|'}'
nl|'\n'
op|')'
op|'.'
name|'_clean_incoming_headers'
op|'('
name|'env'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'HTTP_TEST_HEADER_ONE'"
name|'not'
name|'in'
name|'env'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'HTTP_TEST_HEADER_TWO'"
name|'not'
name|'in'
name|'env'
op|')'
newline|'\n'
nl|'\n'
name|'irh'
op|'='
op|'['
string|"'test-header-*'"
op|']'
newline|'\n'
name|'iah'
op|'='
op|'['
string|"'test-header-two'"
op|']'
newline|'\n'
name|'env'
op|'='
op|'{'
string|"'HTTP_TEST_HEADER_ONE'"
op|':'
string|"'value'"
op|','
nl|'\n'
string|"'HTTP_TEST_HEADER_TWO'"
op|':'
string|"'value'"
op|'}'
newline|'\n'
name|'tempurl'
op|'.'
name|'TempURL'
op|'('
nl|'\n'
name|'None'
op|','
op|'{'
string|"'incoming_remove_headers'"
op|':'
name|'irh'
op|','
nl|'\n'
string|"'incoming_allow_headers'"
op|':'
name|'iah'
op|'}'
nl|'\n'
op|')'
op|'.'
name|'_clean_incoming_headers'
op|'('
name|'env'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'HTTP_TEST_HEADER_ONE'"
name|'not'
name|'in'
name|'env'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'HTTP_TEST_HEADER_TWO'"
name|'in'
name|'env'
op|')'
newline|'\n'
nl|'\n'
name|'irh'
op|'='
op|'['
string|"'test-header-*'"
op|','
string|"'test-other-header'"
op|']'
newline|'\n'
name|'iah'
op|'='
op|'['
string|"'test-header-two'"
op|','
string|"'test-header-yes-*'"
op|']'
newline|'\n'
name|'env'
op|'='
op|'{'
string|"'HTTP_TEST_HEADER_ONE'"
op|':'
string|"'value'"
op|','
nl|'\n'
string|"'HTTP_TEST_HEADER_TWO'"
op|':'
string|"'value'"
op|','
nl|'\n'
string|"'HTTP_TEST_OTHER_HEADER'"
op|':'
string|"'value'"
op|','
nl|'\n'
string|"'HTTP_TEST_HEADER_YES'"
op|':'
string|"'value'"
op|','
nl|'\n'
string|"'HTTP_TEST_HEADER_YES_THIS'"
op|':'
string|"'value'"
op|'}'
newline|'\n'
name|'tempurl'
op|'.'
name|'TempURL'
op|'('
nl|'\n'
name|'None'
op|','
op|'{'
string|"'incoming_remove_headers'"
op|':'
name|'irh'
op|','
nl|'\n'
string|"'incoming_allow_headers'"
op|':'
name|'iah'
op|'}'
nl|'\n'
op|')'
op|'.'
name|'_clean_incoming_headers'
op|'('
name|'env'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'HTTP_TEST_HEADER_ONE'"
name|'not'
name|'in'
name|'env'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'HTTP_TEST_HEADER_TWO'"
name|'in'
name|'env'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'HTTP_TEST_OTHER_HEADER'"
name|'not'
name|'in'
name|'env'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'HTTP_TEST_HEADER_YES'"
name|'not'
name|'in'
name|'env'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'HTTP_TEST_HEADER_YES_THIS'"
name|'in'
name|'env'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_clean_outgoing_headers
dedent|''
name|'def'
name|'test_clean_outgoing_headers'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'orh'
op|'='
op|'['
op|']'
newline|'\n'
name|'oah'
op|'='
op|'['
op|']'
newline|'\n'
name|'hdrs'
op|'='
op|'{'
string|"'test-header'"
op|':'
string|"'value'"
op|'}'
newline|'\n'
name|'hdrs'
op|'='
name|'HeaderKeyDict'
op|'('
name|'tempurl'
op|'.'
name|'TempURL'
op|'('
nl|'\n'
name|'None'
op|','
nl|'\n'
op|'{'
string|"'outgoing_remove_headers'"
op|':'
name|'orh'
op|','
string|"'outgoing_allow_headers'"
op|':'
name|'oah'
op|'}'
nl|'\n'
op|')'
op|'.'
name|'_clean_outgoing_headers'
op|'('
name|'hdrs'
op|'.'
name|'items'
op|'('
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'test-header'"
name|'in'
name|'hdrs'
op|')'
newline|'\n'
nl|'\n'
name|'orh'
op|'='
op|'['
string|"'test-header'"
op|']'
newline|'\n'
name|'oah'
op|'='
op|'['
op|']'
newline|'\n'
name|'hdrs'
op|'='
op|'{'
string|"'test-header'"
op|':'
string|"'value'"
op|'}'
newline|'\n'
name|'hdrs'
op|'='
name|'HeaderKeyDict'
op|'('
name|'tempurl'
op|'.'
name|'TempURL'
op|'('
nl|'\n'
name|'None'
op|','
nl|'\n'
op|'{'
string|"'outgoing_remove_headers'"
op|':'
name|'orh'
op|','
string|"'outgoing_allow_headers'"
op|':'
name|'oah'
op|'}'
nl|'\n'
op|')'
op|'.'
name|'_clean_outgoing_headers'
op|'('
name|'hdrs'
op|'.'
name|'items'
op|'('
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'test-header'"
name|'not'
name|'in'
name|'hdrs'
op|')'
newline|'\n'
nl|'\n'
name|'orh'
op|'='
op|'['
string|"'test-header-*'"
op|']'
newline|'\n'
name|'oah'
op|'='
op|'['
op|']'
newline|'\n'
name|'hdrs'
op|'='
op|'{'
string|"'test-header-one'"
op|':'
string|"'value'"
op|','
nl|'\n'
string|"'test-header-two'"
op|':'
string|"'value'"
op|'}'
newline|'\n'
name|'hdrs'
op|'='
name|'HeaderKeyDict'
op|'('
name|'tempurl'
op|'.'
name|'TempURL'
op|'('
nl|'\n'
name|'None'
op|','
nl|'\n'
op|'{'
string|"'outgoing_remove_headers'"
op|':'
name|'orh'
op|','
string|"'outgoing_allow_headers'"
op|':'
name|'oah'
op|'}'
nl|'\n'
op|')'
op|'.'
name|'_clean_outgoing_headers'
op|'('
name|'hdrs'
op|'.'
name|'items'
op|'('
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'test-header-one'"
name|'not'
name|'in'
name|'hdrs'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'test-header-two'"
name|'not'
name|'in'
name|'hdrs'
op|')'
newline|'\n'
nl|'\n'
name|'orh'
op|'='
op|'['
string|"'test-header-*'"
op|']'
newline|'\n'
name|'oah'
op|'='
op|'['
string|"'test-header-two'"
op|']'
newline|'\n'
name|'hdrs'
op|'='
op|'{'
string|"'test-header-one'"
op|':'
string|"'value'"
op|','
nl|'\n'
string|"'test-header-two'"
op|':'
string|"'value'"
op|'}'
newline|'\n'
name|'hdrs'
op|'='
name|'HeaderKeyDict'
op|'('
name|'tempurl'
op|'.'
name|'TempURL'
op|'('
nl|'\n'
name|'None'
op|','
nl|'\n'
op|'{'
string|"'outgoing_remove_headers'"
op|':'
name|'orh'
op|','
string|"'outgoing_allow_headers'"
op|':'
name|'oah'
op|'}'
nl|'\n'
op|')'
op|'.'
name|'_clean_outgoing_headers'
op|'('
name|'hdrs'
op|'.'
name|'items'
op|'('
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'test-header-one'"
name|'not'
name|'in'
name|'hdrs'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'test-header-two'"
name|'in'
name|'hdrs'
op|')'
newline|'\n'
nl|'\n'
name|'orh'
op|'='
op|'['
string|"'test-header-*'"
op|','
string|"'test-other-header'"
op|']'
newline|'\n'
name|'oah'
op|'='
op|'['
string|"'test-header-two'"
op|','
string|"'test-header-yes-*'"
op|']'
newline|'\n'
name|'hdrs'
op|'='
op|'{'
string|"'test-header-one'"
op|':'
string|"'value'"
op|','
nl|'\n'
string|"'test-header-two'"
op|':'
string|"'value'"
op|','
nl|'\n'
string|"'test-other-header'"
op|':'
string|"'value'"
op|','
nl|'\n'
string|"'test-header-yes'"
op|':'
string|"'value'"
op|','
nl|'\n'
string|"'test-header-yes-this'"
op|':'
string|"'value'"
op|'}'
newline|'\n'
name|'hdrs'
op|'='
name|'HeaderKeyDict'
op|'('
name|'tempurl'
op|'.'
name|'TempURL'
op|'('
nl|'\n'
name|'None'
op|','
nl|'\n'
op|'{'
string|"'outgoing_remove_headers'"
op|':'
name|'orh'
op|','
string|"'outgoing_allow_headers'"
op|':'
name|'oah'
op|'}'
nl|'\n'
op|')'
op|'.'
name|'_clean_outgoing_headers'
op|'('
name|'hdrs'
op|'.'
name|'items'
op|'('
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'test-header-one'"
name|'not'
name|'in'
name|'hdrs'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'test-header-two'"
name|'in'
name|'hdrs'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'test-other-header'"
name|'not'
name|'in'
name|'hdrs'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'test-header-yes'"
name|'not'
name|'in'
name|'hdrs'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'test-header-yes-this'"
name|'in'
name|'hdrs'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_unicode_metadata_value
dedent|''
name|'def'
name|'test_unicode_metadata_value'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'meta'
op|'='
op|'{'
string|'"temp-url-key"'
op|':'
string|'"test"'
op|','
string|'"temp-url-key-2"'
op|':'
string|'u"test2"'
op|'}'
newline|'\n'
name|'results'
op|'='
name|'tempurl'
op|'.'
name|'get_tempurl_keys_from_metadata'
op|'('
name|'meta'
op|')'
newline|'\n'
name|'for'
name|'str_value'
name|'in'
name|'results'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'isinstance'
op|'('
name|'str_value'
op|','
name|'str'
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestSwiftInfo
dedent|''
dedent|''
dedent|''
name|'class'
name|'TestSwiftInfo'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'utils'
op|'.'
name|'_swift_info'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'utils'
op|'.'
name|'_swift_admin_info'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
DECL|member|test_registered_defaults
dedent|''
name|'def'
name|'test_registered_defaults'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'tempurl'
op|'.'
name|'filter_factory'
op|'('
op|'{'
op|'}'
op|')'
newline|'\n'
name|'swift_info'
op|'='
name|'utils'
op|'.'
name|'get_swift_info'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'tempurl'"
name|'in'
name|'swift_info'
op|')'
newline|'\n'
name|'info'
op|'='
name|'swift_info'
op|'['
string|"'tempurl'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
name|'info'
op|'['
string|"'methods'"
op|']'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'('
string|"'GET'"
op|','
string|"'HEAD'"
op|','
string|"'PUT'"
op|','
string|"'POST'"
op|','
string|"'DELETE'"
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
name|'info'
op|'['
string|"'incoming_remove_headers'"
op|']'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'('
string|"'x-timestamp'"
op|','
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
name|'info'
op|'['
string|"'incoming_allow_headers'"
op|']'
op|')'
op|','
name|'set'
op|'('
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
name|'info'
op|'['
string|"'outgoing_remove_headers'"
op|']'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'('
string|"'x-object-meta-*'"
op|','
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
name|'info'
op|'['
string|"'outgoing_allow_headers'"
op|']'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'('
string|"'x-object-meta-public-*'"
op|','
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_non_default_methods
dedent|''
name|'def'
name|'test_non_default_methods'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'tempurl'
op|'.'
name|'filter_factory'
op|'('
op|'{'
nl|'\n'
string|"'methods'"
op|':'
string|"'GET HEAD PUT DELETE BREW'"
op|','
nl|'\n'
string|"'incoming_remove_headers'"
op|':'
string|"''"
op|','
nl|'\n'
string|"'incoming_allow_headers'"
op|':'
string|"'x-timestamp x-versions-location'"
op|','
nl|'\n'
string|"'outgoing_remove_headers'"
op|':'
string|"'x-*'"
op|','
nl|'\n'
string|"'outgoing_allow_headers'"
op|':'
string|"'x-object-meta-* content-type'"
op|','
nl|'\n'
op|'}'
op|')'
newline|'\n'
name|'swift_info'
op|'='
name|'utils'
op|'.'
name|'get_swift_info'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'tempurl'"
name|'in'
name|'swift_info'
op|')'
newline|'\n'
name|'info'
op|'='
name|'swift_info'
op|'['
string|"'tempurl'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
name|'info'
op|'['
string|"'methods'"
op|']'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'('
string|"'GET'"
op|','
string|"'HEAD'"
op|','
string|"'PUT'"
op|','
string|"'DELETE'"
op|','
string|"'BREW'"
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
name|'info'
op|'['
string|"'incoming_remove_headers'"
op|']'
op|')'
op|','
name|'set'
op|'('
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
name|'info'
op|'['
string|"'incoming_allow_headers'"
op|']'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'('
string|"'x-timestamp'"
op|','
string|"'x-versions-location'"
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
name|'info'
op|'['
string|"'outgoing_remove_headers'"
op|']'
op|')'
op|','
name|'set'
op|'('
op|'('
string|"'x-*'"
op|','
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
name|'info'
op|'['
string|"'outgoing_allow_headers'"
op|']'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'('
string|"'x-object-meta-*'"
op|','
string|"'content-type'"
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
name|'__name__'
op|'=='
string|"'__main__'"
op|':'
newline|'\n'
indent|'    '
name|'unittest'
op|'.'
name|'main'
op|'('
op|')'
newline|'\n'
dedent|''
endmarker|''
end_unit
